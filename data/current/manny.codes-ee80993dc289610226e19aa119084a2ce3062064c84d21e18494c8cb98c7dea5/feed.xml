<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
  <generator uri="http://jekyllrb.com" version="4.2.2">Jekyll</generator>
  
  
  <link href="https://manny.codes/feed.xml" rel="self" type="application/atom+xml">
  <link href="https://manny.codes/" rel="alternate" type="text/html" hreflang="en">
  <updated>2022-11-16T23:52:51+00:00</updated>
  <id>https://manny.codes//</id>

  
    <title type="html">Emmanuel Hayford</title>
  

  
    <subtitle>Blogs on programming Ruby, JavaScript and web technologies.</subtitle>
  

  
    <author>
        <name>Yous</name>
      
      
    </author>
  

  
  
    <entry>
      
      <title type="html">RSpec Tutorial: A Quick Introduction To Testing With RSpec.</title>
      
      
      <link href="https://manny.codes/rspec-tutorial-a-quick-introduction-to-testing-with-rspec/" rel="alternate" type="text/html" title="RSpec Tutorial: A Quick Introduction To Testing With RSpec.">
      
      <published>2022-10-10T22:32:00+00:00</published>
      <updated>2022-10-11T22:20:32+00:00</updated>
      <id>https://manny.codes/rspec-tutorial-a-quick-introduction-to-testing-with-rspec</id>
      <content type="html" xml:base="https://manny.codes/rspec-tutorial-a-quick-introduction-to-testing-with-rspec/">&lt;!-- create og image --&gt;

&lt;h2 id=&quot;what-is-rspec&quot;&gt;What is RSpec?&lt;/h2&gt;
&lt;p&gt;RSpec is a domain-specific language testing tool written in Ruby to test Ruby code. It is a behavior-driven development framework, used for the most part in Rails applications, although you can use it outside of Ruby on Rails and without any framework as we’ll see in this post.&lt;/p&gt;

&lt;h2 id=&quot;how-to-install-rspec&quot;&gt;How to install RSpec&lt;/h2&gt;
&lt;p&gt;You can install RSpec in a couple of ways, one way is to install it directly into your gem path by running &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gem install rspec&lt;/code&gt;. When you install RSpec you’ll get 5 other supporting gems installed for you. Your output might look something like this:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Fetching rspec-core-3.11.0.gem
Fetching rspec-3.11.0.gem
Fetching rspec-support-3.11.1.gem
Fetching diff-lcs-1.5.0.gem
Fetching rspec-expectations-3.11.1.gem
Fetching rspec-mocks-3.11.1.gem
Successfully installed rspec-support-3.11.1
Successfully installed rspec-core-3.11.0
Successfully installed diff-lcs-1.5.0
Successfully installed rspec-expectations-3.11.1
Successfully installed rspec-mocks-3.11.1
Successfully installed rspec-3.11.0
6 gems installed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another way to install RSpec is to run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundle init&lt;/code&gt; in the terminal from your working directory. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundle init&lt;/code&gt; generates a Gemfile in the current working directory. If you take this route to install RSpec, you can add gems manually to the Gemfile or do &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundle add rspec&lt;/code&gt; which will add RSpec to your Gemfile and install it for you. At this point, you have RSpec installed and you’re ready to take it for a spin.&lt;/p&gt;

&lt;h2 id=&quot;test-driven-development-tdd-with-rspec&quot;&gt;Test-Driven Development (TDD) with RSpec&lt;/h2&gt;
&lt;p&gt;In the spirit of TDD, we’ll write a failing test first describing what we want our Ruby program to do, then run the tests, see it fail and then proceed to fix it. To start, you can run this command from your working directory in your terminal:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;rspec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This command gives you an initialization point from which to build your tests. Running this command give us a a directory and a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.rspec&lt;/code&gt; file. Inside of the directory is another file, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec_helper.rb&lt;/code&gt;. Our working directory should look like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tree -a
.
├── .rspec
└── spec
    └── spec_helper.rb

1 directory, 2 files
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you look inside &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec_helper.rb&lt;/code&gt;, everything you need to know about these generated files is stated:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# This file was generated by the `rspec --init` command. Conventionally, all
# specs live under a `spec` directory, which RSpec adds to the `$LOAD_PATH`.
# The generated `.rspec` file contains `--require spec_helper` which will cause
# this file to always be loaded, without a need to explicitly require it in any
# files.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With that, let’s write our first spec:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;#greet&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;should greet successfully&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;human&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;greet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello, world!&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The content of the spec above is in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;human_spec.rb&lt;/code&gt;. The conversion is to prefix &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_spec.rb&lt;/code&gt; with whatever class or object you want to test. In our case we want to test a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Human&lt;/code&gt; class whose instances can &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;greet&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The first line is a class method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;describe&lt;/code&gt;, that describes the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Human&lt;/code&gt; class we want to test, and the method in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Human&lt;/code&gt; class that we want to describe, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#greet&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Our directory now looks something like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tree -a
.
├── .rspec
└── spec
    ├── human_spec.rb
    └── spec_helper.rb

1 directory, 3 files
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At this point, when we run our tests, things should fail:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rspec

An error occurred while loading ./spec/human_spec.rb.
Failure/Error:
  RSpec.describe Human, &quot;#greet&quot; do
    it &quot;should greet successfully&quot; do
      human = Human.new

      expect(human.greet).to eq &quot;Hello, world!&quot;
    end
  end

NameError:
  uninitialized constant Human
# ./spec/human_spec.rb:2:in `&amp;lt;top (required)&amp;gt;'
No examples found.


Finished in 0.00003 seconds (files took 0.30025 seconds to load)
0 examples, 0 failures, 1 error occurred outside of examples
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The spec is failing. We’ve got an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;uninitialized constant Human&lt;/code&gt;. We haven’t created that class yet. Let’s create that class and require it.&lt;/p&gt;

&lt;p&gt;We require the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Human&lt;/code&gt; class and so our file looks like this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'./human'&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;#greet&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;should greet successfully&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;human&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;human&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;greet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hello, world!&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Directory structure is now:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tree -a
.
├── .rspec
├── human.rb
└── spec
    ├── human_spec.rb
    └── spec_helper.rb

1 directory, 4 files
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After adding a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Human&lt;/code&gt; class and running the specs again, we have:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rspec
F

Failures:

  1) Human#greet should greet successfully
     Failure/Error: expect(human.greet).to eq &quot;Hello, world!&quot;

     NoMethodError:
       undefined method `greet' for #&amp;lt;Human:0x00007f9414902c70&amp;gt;
     # ./spec/human_spec.rb:7:in `block (2 levels) in &amp;lt;top (required)&amp;gt;'

Finished in 0.00185 seconds (files took 0.10377 seconds to load)
1 example, 1 failure

Failed examples:

rspec ./spec/human_spec.rb:4 # Human#greet should greet successfully
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This time we have an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;undefined method 'greet' for #&amp;lt;Human:0x00007f9414902c70&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;From this point, defining the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;greet&lt;/code&gt; class is all we need to get our specs passing:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Human&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;greet&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;Hello, world!&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rspec
.

Finished in 0.00206 seconds (files took 0.10401 seconds to load)
1 example, 0 failures
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This completes our quick introduction to setting put and running RSpec. Running RSpec alone is a lot more involved. I have a post on &lt;a href=&quot;https://manny.codes/7-ways-to-selectively-run-rspec-tests/&quot;&gt;how to run RSpec tests&lt;/a&gt;. In a big codebase, you might want to pick out specific tests to run to save resources.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="rspec"/>
      

      
        <summary type="html"/>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">What Happens In Ruby On Class Instantiation.</title>
      
      
      <link href="https://manny.codes/what-happens-on-ruby-class-instantiation/" rel="alternate" type="text/html" title="What Happens In Ruby On Class Instantiation.">
      
      <published>2022-08-23T20:37:00+00:00</published>
      <updated>2022-08-25T18:06:50+00:00</updated>
      <id>https://manny.codes/what-happens-on-ruby-class-instantiation</id>
      <content type="html" xml:base="https://manny.codes/what-happens-on-ruby-class-instantiation/">&lt;p&gt;Essentially three things happen when you instantiate a class in Ruby:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Space is allocated for the new object of the class to be created.&lt;/li&gt;
  &lt;li&gt;An initializer is called to set up intsance variables, for example.&lt;/li&gt;
  &lt;li&gt;An instance of the created object of the class is returned.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;A good way to demonstrate this would be through an example. So let’s say we have a class &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Country&lt;/code&gt; that we want to instantiate, but instead of going the usual route and doing something like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Country.new&lt;/code&gt;, we’ll implement our own version of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;new&lt;/code&gt; to mimic what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;new&lt;/code&gt; does under the hood. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fresh&lt;/code&gt; is what we’ll call our version of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;new&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Our implementation would then look something like this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Country&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;fresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capital&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allocate&lt;/span&gt;                         &lt;span class=&quot;c1&quot;&gt;# 1. Allocate space for a new object &lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;custom_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capital&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# 2. Call initializer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;                                    &lt;span class=&quot;c1&quot;&gt;# 3. Return instance of Country&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;custom_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capital&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@capital&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capital&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;fresh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Ghana&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Accra&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; #&amp;lt;Country:0x000000010c5e23f8 @name=&quot;Ghana&quot;, @capital=&quot;Accra&quot;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The documentation for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;allocate&lt;/code&gt;reads:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Allocates space for a new object of class’s class and does not call initialize on the new instance. The returned object must be an instance of class.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This appears to be the most important step in the instantiation process. Knowing that you can hack object instantiation presents a whole set of possibilities that amplify the dynamism of the Ruby programming language.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="tips &amp; tricks"/>
      

      
        <summary type="html">Essentially three things happen when you instantiate a class in Ruby:</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">4 Books For Intermediate Ruby And Rails Developers.</title>
      
      
      <link href="https://manny.codes/4-books-for-intermediate-ruby-and-rails-developers/" rel="alternate" type="text/html" title="4 Books For Intermediate Ruby And Rails Developers.">
      
      <published>2022-06-30T11:26:00+00:00</published>
      <updated>2022-09-24T22:19:54+00:00</updated>
      <id>https://manny.codes/4-books-for-intermediate-ruby-and-rails-developers</id>
      <content type="html" xml:base="https://manny.codes/4-books-for-intermediate-ruby-and-rails-developers/">&lt;p&gt;Through my Ruby and Rails journey, I’ve discovered a few &lt;a href=&quot;https://manny.codes/radruby&quot;&gt;excellent Ruby books&lt;/a&gt; that I’d like to share with fellow Rubyists. The authors of these books are experts in their fields. These books are my recommendation and I think they deserve some space on your desk.&lt;/p&gt;

&lt;p&gt;By the way, having “intermediate” in the title means nothing, anyone can benefit in some form from these books. I try to pick a single audience to write for hence the title. In the coming days, I’ll create a booklist targeting entry-level and more experienced Ruby and Rails developers. Feel free to &lt;a href=&quot;https://twitter.com/siaw23&quot;&gt;follow me on Twitter&lt;/a&gt; to stay in the loop.&lt;/p&gt;

&lt;p&gt;In no particular order, here are four books I think are worth your time and money.&lt;/p&gt;

&lt;h1 id=&quot;metaprogramming-ruby-2&quot;&gt;Metaprogramming Ruby 2&lt;/h1&gt;
&lt;p&gt;I’m not sure how much of an exaggeration it’d be if I say DSL or framework code will make little to no sense to you if you haven’t read this book, at least this is how I felt unless you’re Matz or Aaron Patterson. I got this book recommendation from &lt;a href=&quot;https://twitter.com/schneems&quot;&gt;Richard Schneeman&lt;/a&gt; and finished it in a week, it’s that good.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://pragprog.com/titles/ppmetr2/metaprogramming-ruby-2/&quot;&gt;This book&lt;/a&gt; reveals how all the &lt;a href=&quot;https://manny.codes/3-practical-uses-of-ruby-method-missing&quot;&gt;magic in DSLs&lt;/a&gt; is performed. Don’t be fooled by the publication date, this book is as relevant as a parachute is to skydiving. &lt;a href=&quot;https://twitter.com/nusco&quot;&gt;Paolo Perrotta&lt;/a&gt; is a talented writer and knows how to hold attention.&lt;/p&gt;

&lt;p&gt;It will teach you how to be a magician, you’ll learn metaprogramming skills that’ll help you understand any DSL. It shows you how to write and understand practical metaprogramming code with countless examples.&lt;/p&gt;

&lt;h1 id=&quot;sustainable-web-development-with-rails&quot;&gt;Sustainable Web Development with Rails&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://www.amazon.com/Sustainable-Web-Development-Ruby-Rails/dp/0990702847&quot;&gt;Sustainable Web Development with Ruby on Rails&lt;/a&gt; is a book I found by chance, took the risk and purchased when it wasn’t even completed. I watched how &lt;a href=&quot;https://twitter.com/davetron5000&quot;&gt;David Copeland&lt;/a&gt; iterated until completion, no regrets to this day. The book gets updates when needed if you have the digital version. David is the co-author of Agile Web Development with Rails 6 and has extensive experience in engineering software.&lt;/p&gt;

&lt;p&gt;It covers the entire MVC architectural pattern in Rails with extras. You’ll learn stuff like what happens when a job fails, to productive workflows and processes during development. It’ll teach you how to build or start a Rails project that’s maintainable and how to rid your application of chaff. If you’re a professional Rails developer, you’ll learn even more skills to add to your arsenal.&lt;/p&gt;

&lt;h1 id=&quot;rebuilding-rails&quot;&gt;Rebuilding Rails&lt;/h1&gt;
&lt;p&gt;Rails is nothing more than a fancy &lt;a href=&quot;https://github.com/rack/rack&quot;&gt;Rack&lt;/a&gt; application, to understand Rails, you need to know how Rack works and that’s when &lt;a href=&quot;https://twitter.com/codefolio&quot;&gt;Noah Gibbs&lt;/a&gt; comes in with &lt;a href=&quot;https://rebuilding-rails.com/&quot;&gt;Rebuilding Rails&lt;/a&gt;. Noah will enlighten you not only on how Rails is built but also teach you even more metaprogramming if you didn’t get enough from &lt;a href=&quot;https://pragprog.com/titles/ppmetr2/metaprogramming-ruby-2/&quot;&gt;Paolo Perrotta&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Noah is an expert Ruby Performance guy, if you fancy &lt;a href=&quot;http://codefol.io/topics/&quot;&gt;advanced Ruby and Rails&lt;/a&gt; stuff, I recommend checking out his blog. Thank me later.&lt;/p&gt;

&lt;p&gt;By reading this book and coding along, you’ll understand the source code of Rails as well as that of other Rack-based frameworks, this includes among others, Sinatra and Hanami. The source code of any Rack-based web framework will be intelligible, that’s an unofficial guarantee.&lt;/p&gt;

&lt;h1 id=&quot;polished-ruby-programming&quot;&gt;Polished Ruby Programming&lt;/h1&gt;
&lt;p&gt;You know that feeling when after reading too many beginner books, you go like “isn’t there something more advanced on Ruby? A book that won’t overwhelm me, but also a Ruby book that’s not too advanced?”. Several years ago, for a long time, I got bored of reading beginner Ruby books, I wanted something more, something that’d let me understand Ruby’s philosophy just enough to design better code. Well, &lt;a href=&quot;https://twitter.com/jeremyevans0&quot;&gt;Jeremy Evans&lt;/a&gt; has your back.&lt;/p&gt;

&lt;p&gt;Jeremy contributes a lot to open source, Ruby and Rack included. He’s the author of &lt;a href=&quot;https://github.com/jeremyevans/roda&quot;&gt;Roda&lt;/a&gt; and &lt;a href=&quot;https://github.com/jeremyevans/sequel&quot;&gt;Sequel&lt;/a&gt; and several other open-source software. His style of writing Ruby is very different – In my books, he’s the epitome of defensive programming. There’s an opportunity to learn directly from Jeremy through &lt;a href=&quot;https://www.amazon.com/Polished-Ruby-Programming-maintainable-high-performance/dp/1801072728&quot;&gt;Polished Ruby Programming&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Polished Ruby Programming, as well as all the other books, have clear descriptions of what exactly you’ll learn. I won’t repeat them but will encourage you to check the books’ contents, and for some, download sample chapters.&lt;/p&gt;

&lt;p&gt;Mind you though, that depending on how much exposure you have already with Ruby, this book might be a bit advanced.&lt;/p&gt;

&lt;h1 id=&quot;practical-object-oriented-design&quot;&gt;Practical Object-Oriented Design&lt;/h1&gt;

&lt;p&gt;I know… the title reads “4 books” but here’s another book because this blog post is &lt;a href=&quot;https://en.wikipedia.org/wiki/Off-by-one_error&quot;&gt;OBO&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Now, I’m sure you know this title, and probably read it already. &lt;a href=&quot;https://www.poodr.com/&quot;&gt;It’s a classic&lt;/a&gt;. Most Rubyists I know have read it. You’ll learn the fundamental tenets of OOP with topics like building objects via composition and how to be a professional duck typer.&lt;/p&gt;

&lt;p&gt;In the Ruby community, Sandi Metz is one of the authorities on object-oriented programming. I like this book and want it to be on my list of recommendations. So let’s keep it here.&lt;/p&gt;

&lt;p&gt;I may have missed some good titles that didn’t make it onto my list. What Ruby or Rails books would you recommend?&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="rails"/>
      

      
        <summary type="html">Through my Ruby and Rails journey, I’ve discovered a few excellent Ruby books that I’d like to share with fellow Rubyists. The authors of these books are experts in their fields. These books are my recommendation and I think they deserve some space on your desk.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Dislodging mimemagic And Understanding MIT &amp;amp; GNU GPL.</title>
      
      
      <link href="https://manny.codes/dislodging-mimemagic-and-understanding-mit-gnu-gpl/" rel="alternate" type="text/html" title="Dislodging mimemagic And Understanding MIT &amp; GNU GPL.">
      
      <published>2021-03-30T20:28:00+00:00</published>
      <updated>2022-09-27T16:21:18+00:00</updated>
      <id>https://manny.codes/dislodging-mimemagic-and-understanding-mit-gnu-gpl</id>
      <content type="html" xml:base="https://manny.codes/dislodging-mimemagic-and-understanding-mit-gnu-gpl/">&lt;p&gt;&lt;strong&gt;TLDR&lt;/strong&gt;: A vessel called Mimemagic run aground, blocking a vital trade route and halting traffic for all others and forcing a reroute for some for six days.&lt;/p&gt;

&lt;center&gt;
&lt;img src=&quot;/images/mimemagic.jpeg&quot; /&gt;
&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Jokes aside, what happened in Rails last week is unprecedented, at least since I started working with Rails 4. Unless it did happen and I missed it.&lt;/p&gt;

&lt;p&gt;As far as I understand, it was an issue with licensing. For some, licensing is not an issue of concern; a few people grab any open-source code available and use it anyhow they want. &lt;a href=&quot;https://github.com/siaw23/kovid/pull/41&quot;&gt;I was one&lt;/a&gt; of these people, but I’ve come to learn to pay more attention to the kind of dependencies I use and the licenses attached to them.&lt;/p&gt;

&lt;p&gt;This blog post is a summary of what I think is happening. This post is a compendium of the timeline of events, solutions people have found to circumvent the yanking of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; and how open-source licenses work.&lt;/p&gt;

&lt;h2 id=&quot;so-what-happened&quot;&gt;So, What Happened?&lt;/h2&gt;

&lt;p&gt;While entirely unrelated, six days ago, &lt;a href=&quot;https://edition.cnn.com/2021/03/24/middleeast/suez-canal-container-ship-intl-hnk/index.html&quot;&gt;a massive cargo ship got stuck in the Suez Canal&lt;/a&gt;. The memes with ships is based on this vessel, Ever Given. The reason people couldn’t ship has nothing to do with this ship though.&lt;/p&gt;

&lt;p&gt;The maintainer of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shared-mime-info&lt;/code&gt;, Bastien Nocera, &lt;a href=&quot;https://github.com/mimemagicrb/mimemagic/issues/97&quot;&gt;filed an issue&lt;/a&gt; on mimemagic to resolve some licensing inconsistency. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shared-mime-info&lt;/code&gt; is a package that contains the core database of common MIME types that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; uses.&lt;/p&gt;

&lt;p&gt;Now, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shared-mime-info&lt;/code&gt; is under a &lt;strong&gt;GNU General Public License&lt;/strong&gt; (GPL) and mimemagic, prior to version 0.3.7, was incorrectly licensed under MIT.&lt;/p&gt;

&lt;p&gt;When Bastien reported the violation, Daniel Mendler, the creator of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt;, briefly changed the license on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; to GPL-2.0, forcing him to yank all early versions of the gem, which were under MIT.&lt;/p&gt;

&lt;p&gt;Bastien reported a violation. Daniel followed through with fixing the problem, bringing all CI builds of Rails applications that had ActivaStorage (which depended on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;marcel&lt;/code&gt;, which depended on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt;) to a grinding halt.&lt;/p&gt;

&lt;blockquote cite=&quot;Bundler&quot;&gt;
Your bundle is locked to mimemagic (0.3.5), but that version could not be found
in any of the sources listed in your Gemfile. If you haven't changed sources,
that means the author of mimemagic (0.3.5) has removed it. You'll need to update
your bundle to a version other than mimemagic (0.3.5) that hasn't been removed
in order to install.
&lt;span class=&quot;author&quot;&gt;&lt;i&gt;Bundler&lt;/i&gt;&lt;/span&gt;
&lt;/blockquote&gt;

&lt;p&gt;The dependency hierarchy looked something like this for some:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    rails (~&amp;gt; 6.0.3, &amp;gt;= 6.0.3.4) was resolved to 6.0.3.4, which depends on
      activestorage (= 6.0.3.4) was resolved to 6.0.3.4, which depends on
        marcel (~&amp;gt; 0.3.1) was resolved to 0.3.3, which depends on
          mimemagic (~&amp;gt; 0.3.2)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For a brief moment, there was chaos. Some folks started demanding and commanding as if someone owed them something. Others tried to help.&lt;/p&gt;

&lt;!-- ![](/images/nate-berkopec-oss.png) --&gt;

&lt;p&gt;An important thing to note here is an MIT-licensed code is GPL-compatible, but a GPL-licensed code is not MIT-compatible. This means you can include an MIT-licensed code in a GPL-licensed application, but you cannot include a GPL-licensed code in an MIT-licensed application. More on this later.&lt;/p&gt;

&lt;h2 id=&quot;how-developers-worked-around-the-issue&quot;&gt;How Developers Worked Around The Issue&lt;/h2&gt;

&lt;p&gt;I heard people suggesting getting rid of ActiveStorage if your app didn’t use it.&lt;/p&gt;

&lt;p&gt;Some got the MIME type database on their systems through Homebrew and updated &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt;, which looked in some paths, including where Homebrew may have installed the database.&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;brew install shared-mime-info
bundle update nokogiri marcel mimemagic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Linux users did the equivalent for their distros.&lt;/p&gt;

&lt;p&gt;Others suggested grabbing a copy of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; and putting it into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/vendor/gem&lt;/code&gt; and then updating the Gemfile to something like:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gem &quot;mimemagic&quot;, path: &quot;vendor/gems/mimemagic-0.3.6&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another workaround was referencing the yanked gem. Yanking a gem only removes the code from the host, Rubygems. Github keeps another copy.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gem 'mimemagic', github: 'mimemagicrb/mimemagic', ref: '01f92d86d'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;rails-core-team-yanked-mimemagic&quot;&gt;Rails Core Team Yanked Mimemagic&lt;/h2&gt;

&lt;p&gt;With all these slick interim fixes floating around, the Rails core team was working to figure out a more lasting solution. What they ended up doing is providing a bugfix release in Rails version 6.1.3.1 that removed the dependency on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;marcel&lt;/code&gt;, an &lt;a href=&quot;https://manny.codes/linking-a-webcam-directly-to-rails-activestorage/&quot;&gt;Active Storage&lt;/a&gt; dependency.&lt;/p&gt;

&lt;p&gt;The Rails core team went with &lt;a href=&quot;https://github.com/apache/tika/blob/main/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&quot;&gt;Apache Tika&lt;/a&gt;. Apache Tika provides capabilities for the identification of more than 1400 file types from the Internet Assigned Numbers Authority taxonomy of MIME types, similar to what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;share-mime-info&lt;/code&gt; provides but with a permissive license – Apache License-2.0.&lt;/p&gt;

&lt;h2 id=&quot;open-source-licensing-101&quot;&gt;Open-Source Licensing 101&lt;/h2&gt;

&lt;p&gt;Before you start this section, here’s a disclaimer: I’ve never been to law school, and I’m no open-source licensing expert. Almost everything from this point forward is referenced from other resources that I link to at the end of the post.&lt;/p&gt;

&lt;p&gt;With that out of the way, a software license is a grant of permission by the owner of a legal right (usually the creator of the code) to software (the licensor) for another person or entity (the licensee) to do something with the software.&lt;/p&gt;

&lt;blockquote cite=&quot;Andrew M St. Laurent&quot;&gt;
The fundamental purpose of open source licensing is to deny anybody the right to
exclusively exploit a work.
&lt;span class=&quot;author&quot;&gt;&lt;i&gt;Andrew M St. Laurent&lt;/i&gt;&lt;/span&gt;
&lt;/blockquote&gt;

&lt;p&gt;When a user buys a packaged product, most often than not, they are bound by what’s known as a “shrinkwrap contract” or a shrinkwrap license. A shrinkwrap license asserts that, by opening the plastic wrap of the product, the consumer is bound by a contract under which they cannot:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Copy the work.&lt;/li&gt;
  &lt;li&gt;Create derivate works based on the packaged content.&lt;/li&gt;
  &lt;li&gt;Authorise anyone to do either of the points stated above.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The foundation of open-source licensing is to abolish these restrictions. The freedom to copy work and create derivatives from other people’s works means different things to different groups of people. This has given rise to a wide variety of licenses in the open-source field.&lt;/p&gt;

&lt;p&gt;Among the numerous licenses are MIT and GPL, which fall under different licensing categories: Permissive and copyleft.&lt;/p&gt;

&lt;h2 id=&quot;permissive-vs-copyleft-licenses&quot;&gt;Permissive vs Copyleft Licenses&lt;/h2&gt;

&lt;p&gt;A permissive software license has minimal restrictions on how the software can be used, modified, and redistributed; like MIT. In other words, this type of license lets you do anything you want with the software as long as you provide attribution and don’t hold the creator of the software liable in case something goes wrong.&lt;/p&gt;

&lt;p&gt;On the other hand, there’s a copyleft license. An example of such a license is the GPL. A copyleft license is a bit more restrictive. These type of licenses allow you to modify and freely distribute software, but with this freedom, you’re required to preserve these same rights in derivatives, i.e. code that based your work on.&lt;/p&gt;

&lt;p&gt;In short, a permissive license allows “proprietization”. A copyleft license forbids it. With a permissive licence, you have exclusive rights to commercially exploit someone’s work.&lt;/p&gt;

&lt;center&gt;
&lt;img src=&quot;/images/mit-gnu-gpl.jpg&quot; /&gt;
&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;You can tell from the image above that the difference between a permissive and a copyleft licence is the right to sublicense. What this means is, licensee or a second party can’t relicense a GPL-licensed code. i.e. you can’t grab and use a GPL codebase into your MIT codebase.&lt;/p&gt;

&lt;h3 id=&quot;a-brief-history-of-gnu-gpl&quot;&gt;A Brief History Of GNU GPL&lt;/h3&gt;

&lt;p&gt;Richard Stallman, the original writer of the GPL license, worked on a Lisp interpreter that Symbolics Inc. (a now-defunct computer manufacturer) asked to use. Stallman gave up his version of his work on Lisp to Symbolics, granting them &lt;strong&gt;all rights&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;When Stallman wanted to see how Symbolics had improved the Lisp interpreter, they refused. Stallman was like, “WTF!?! You inherited free software from me. Now you deny me access to see what you did with my software? This shit needs to stop!”&lt;/p&gt;

&lt;blockquote cite=&quot;Richard Stallman&quot;&gt;
That is to say, proprietary modifications will not be allowed. I want to make sure that all versions of GNU remain free.
&lt;span class=&quot;author&quot;&gt;&lt;i&gt;Richard Stallman&lt;/i&gt;&lt;/span&gt;
&lt;/blockquote&gt;

&lt;p&gt;Stallman’s actions made the concept of “copyleft” mainstream, hence the reason we now have protective licenses like GNU GPL against permissive ones like Apache and MIT. The principle of demanding licenses of derivative works to be based on the original is called &lt;strong&gt;generational limitation&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;rails-is-guilty-of-no-license-violation&quot;&gt;Rails Is Guilty Of No License Violation&lt;/h2&gt;

&lt;p&gt;You can’t blame Rails for what happened with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; for two reasons:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Rails included a gem that was licensed (incorrectly) under MIT.&lt;/li&gt;
  &lt;li&gt;Rails is not a derivative work of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The United States Copyright Act of 1976, 17 USC. Section 101 states: A “derivative work” is a work based upon one or more preexisting work. I believe this definition is true in other jurisdictions, and to my understanding, Rails didn’t violate GPL because it imported a library that was a GPL derivative. Rails itself isn’t a derivative, they can cut out the “tainted” libraries anytime.&lt;/p&gt;

&lt;p&gt;Until recently, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; had directly imported the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shared-mime-info&lt;/code&gt; database directly into the gem, making it a derivative of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shared-mime-info&lt;/code&gt;. Daniel Mendler was right in yanking earlier versions of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimemagic&lt;/code&gt; to protect himself, even if he did so without notice.&lt;/p&gt;

&lt;h2 id=&quot;gratitude-to-those-sustaining-open-source&quot;&gt;Gratitude To Those Sustaining Open-Source&lt;/h2&gt;

&lt;p&gt;Amidst the short-lived brouhaha to the yanking emerged Jon Wood, who single-handedly carried many developers on his back to a solution. The Rails community is happy to have such folks around. For his efforts, we’re thankful.&lt;/p&gt;

&lt;p&gt;Of course, the Rails Core Team, as always, promptly found a database with a permissive license to avert the problem. Kudos to the Rails team!&lt;/p&gt;

&lt;p&gt;References:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Permissive_software_license&quot;&gt;en.wikipedia.org/wiki/Permissive_software_license&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Copyleft&quot;&gt;en.wikipedia.org/wiki/Copyleft&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Software_license&quot;&gt;en.wikipedia.org/wiki/Software_license&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.oreilly.com/library/view/understanding-open-source/0596005814/&quot;&gt;Understanding Open Source and Free Software Licensing&lt;/a&gt;, Andrew M St. Laurent&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.amazon.com/Software-Licensing-Agreements-About-Licenses/dp/1942226020&quot;&gt;Software Licensing Agreements: What You Need To Know About Software Licenses&lt;/a&gt;, Mike Young&lt;/p&gt;

&lt;p&gt;Ever Given meme: h/t @mahemoff&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="rails"/>
      
        <category term="open-source"/>
      

      
        <summary type="html">TLDR: A vessel called Mimemagic run aground, blocking a vital trade route and halting traffic for all others and forcing a reroute for some for six days.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">TIL #2: tmux, Docker’s Architecture, CSS Feature Queries And Lodash.</title>
      
      
      <link href="https://manny.codes/til-2-tmux-docker-s-architecture-css-feature-queries-and-lodash/" rel="alternate" type="text/html" title="TIL #2: tmux, Docker's Architecture, CSS Feature Queries And Lodash.">
      
      <published>2021-03-23T19:11:00+00:00</published>
      <updated>2022-09-27T16:21:18+00:00</updated>
      <id>https://manny.codes/til-2-tmux-docker-s-architecture-css-feature-queries-and-lodash</id>
      <content type="html" xml:base="https://manny.codes/til-2-tmux-docker-s-architecture-css-feature-queries-and-lodash/">&lt;h2 id=&quot;tmux&quot;&gt;tmux&lt;/h2&gt;

&lt;p&gt;In February 2021, I learned about tmux and added it to my workflow. It’s been great so far, with a gentle learning curve. My main problem with it now is that I haven’t been able to find a way to implement scrolling.&lt;/p&gt;

&lt;p&gt;When I get a very long stack trace, I have to use a standard terminal window to read through. I lose sessions and windows when I restart my machine; it would be nice if the sessions persisted. I’m yet to learn if that is possible. Other than that, it’s nice to work with tmux.&lt;/p&gt;

&lt;p&gt;EDIT:
I’ve since learned to persist sessions in tmux. Yay! It turns out there’s a &lt;a href=&quot;https://github.com/tmux-plugins/tmux-continuum&quot;&gt;tmux plugin&lt;/a&gt; for that. The scrolling issue was an easy fix. In my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.tmux.conf&lt;/code&gt;, I had to pop in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;set -g mouse on&lt;/code&gt;.&lt;/p&gt;

&lt;!-- EDIT: I know how to do it now. Show link to plugin, talk about plug system --&gt;

&lt;h2 id=&quot;css-feature-queries&quot;&gt;CSS Feature Queries&lt;/h2&gt;
&lt;p&gt;I was pretty stoked when I learned about CSS Media Queries. I thought it was fantastic, and it truly is. For a WebRTC app that I’m working on recently, the building process forced me to learn a bit about CSS Grid and Flexbox. Reading documentation led me to discover CSS Feature Queries. It’s a neat feature that’s &lt;a href=&quot;https://caniuse.com/css-featurequeries&quot;&gt;available in almost all browsers&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Much like Media Queries, Feature Queries let you run CSS conditionally. In the case of Feature Queries, you can check if a browser supports Flexbox. If it does, you run the Flexbox CSS. Otherwise, you load CSS that tries to mimic some Flexbox effects.&lt;/p&gt;

&lt;p&gt;Here’s a how you’d use it:&lt;/p&gt;

&lt;div class=&quot;language-css highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;@supports&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;CSS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;older&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;browsers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;@supports&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;CSS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;newer&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;browsers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Some refer to it as the “@supports rule”. I like the “Feature Queries” name more.&lt;/p&gt;

&lt;blockquote cite=&quot;W3C&quot;&gt;
The @supports rule is a conditional group rule whose condition tests whether the user agent supports CSS property:value pairs.
&lt;span class=&quot;author&quot;&gt;&lt;i&gt;W3C&lt;/i&gt;&lt;/span&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;the-architecture-of-docker&quot;&gt;The Architecture of Docker&lt;/h2&gt;
&lt;p&gt;Docker used the resource features of the Linux kernel to allow containers to run in a Linux instance. It’s more of a Linux product than anything else. I saw some benchmarks running around Twitter about how Rails with Docker development on Macs is slow. Everything makes sense now.&lt;/p&gt;

&lt;p&gt;The docker daemon’s native home is a Linux host. If you’re running Docker on any other OS, you’ll pay for the overhead. Docker has to start a Linux virtual machine on a non-Linux host to get things working. For instance, on a Mac, the Docker CLI has to do extra work to forward CLI input to the Docker Daemon.&lt;/p&gt;

&lt;!-- Here's how the setup looks like on a Linux machine:
Here's how it looks on a non-Linux device: --&gt;

&lt;h2 id=&quot;lodash&quot;&gt;Lodash&lt;/h2&gt;
&lt;p&gt;If you write a lot of JavaScript and don’t use Lodash, you’re missing out on a collection of libraries written to keep code modular. I checked out the full suite of Lodash. It has frequently used functions written more concisely, much like how &lt;a href=&quot;https://manny.codes/use-activesupport-s-present-sparingly/&quot;&gt;Active Support&lt;/a&gt; and Ruby provide ready-made methods to ease programmers’ lives.&lt;/p&gt;

&lt;p&gt;For example the raw JavaScript implementation of a function that finds the intersection of two array cannot be prettier than doing it with Lodash:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;intersection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// =&amp;gt; [2]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There’s a whole lot &lt;a href=&quot;https://lodash.com/docs/4.17.15&quot;&gt;more utility functions in the documentation&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I like Lodash more when I discovered that it has a &lt;a href=&quot;https://lodash.com/docs/4.17.15#debounce&quot;&gt;debounce function&lt;/a&gt;. I can see how this could come in handy when you’re modifying a page when the viewport is resized. This function only invokes the functions after a given amount of time to save the browser from unnecessary work that could hinder performance.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="personal"/>
      
        <category term="TIL"/>
      

      
        <summary type="html">tmux</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Implementing Order With ActionCable Signalling &amp;amp; WebRTC.</title>
      
      
      <link href="https://manny.codes/implementing-order-with-actioncable-signalling-webrtc/" rel="alternate" type="text/html" title="Implementing Order With ActionCable Signalling &amp; WebRTC.">
      
      <published>2021-03-21T17:43:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/implementing-order-with-actioncable-signalling-webrtc</id>
      <content type="html" xml:base="https://manny.codes/implementing-order-with-actioncable-signalling-webrtc/">&lt;p&gt;Rails’ ActionCable is excellent for building realtime features in applications. However, in some realtime communication applications, ActionCable is just not good enough. Especially in a stack where order matters.&lt;/p&gt;

&lt;p&gt;In building realtime communication apps, other paradigms reign supreme. I’m talking about an event-driven paradigm like what Node.js and the JavaScript ecosystem give us.&lt;/p&gt;

&lt;p&gt;With WebRTC, orderliness guarantees reliable communication.&lt;/p&gt;

&lt;p&gt;Here’s an example. In the SDP exchanges created before establishing a peer-to-peer connection, the offer always goes first, then an answer. Without an offer, there won’t be an answer. Everything is event-driven: events trigger subsequent events needed to establish the connection.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/sdp-exchange-rails.png&quot; alt=&quot;&amp;quot;Offer/answer SDP exchange between peers&amp;quot;&quot; title=&quot;Offer/answer SDP exchange between peers&quot; /&gt;&lt;em&gt;High Performance Browser Networking - Ilya Grigorik&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;In between sending an offer and receiving an answer, some other events occur. The most important is the generation of candidate pairs. On the frontend, with the help of &lt;a href=&quot;https://stimulus.hotwire.dev/&quot;&gt;Stimulus&lt;/a&gt;, one could have something like this:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nx&quot;&gt;subscription&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;received&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JOIN_ROOM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;joinRoom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;EXCHANGE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentUser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exchange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;actioncable-delivers-messages-out-of-order&quot;&gt;ActionCable Delivers Messages Out Of Order&lt;/h2&gt;
&lt;p&gt;There’d be nothing wrong with this approach if only ActionCable delivered messages in order. The Rails team didn’t build ActionCable with ordered message delivery in mind, and this is where the problem starts. Your video conferencing app will be flaky if you don’t take care of how you deliver messages.&lt;/p&gt;

&lt;p&gt;I’ve been through this before. To confirm ActionCable didn’t deliver messages in order, I wrote some code in the controller:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;ActionCable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;broadcast&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;room_channel_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The messages, as shown in the browser console, were delivered out of order:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/action-cable-out-of-order-delivery.png&quot; alt=&quot;ActionCable out of order message delivery&quot; title=&quot;ActionCable out of order message delivery&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The random delivery of messages ensured that the few repositories I found on GitHub with similar implementation for signalling behaved unpredictably by delivering media tracks sometimes. You want media tracks to be &lt;i&gt;delivered at all times&lt;/i&gt; for your software to be deemed usable.&lt;/p&gt;

&lt;p&gt;With this, you’d get SDP and candidate pairs mixed up as shown below:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/out-of-order-exchange.png&quot; alt=&quot;Out of order exhcanges&quot; title=&quot;Out of order exchanges&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What we can see here is exchanges spread haphazardly. We can see that first, an offer comes in, followed by a plethora of candidate pairs, then an answer at the bottom. An order like this is not good because the ICE agents on both ends need to know each other’s intentions and agree to talk to each other &lt;i&gt;before&lt;/i&gt; exchanging candidate pairs.&lt;/p&gt;

&lt;p&gt;With the way things stand now, by the time an ICE agent gets an answer, the good candidate pairs would have passed already, and the agent would miss them; this will result in a failed peer-to-peer connection, meaning the agents won’t exchange any media tracks.&lt;/p&gt;

&lt;h2 id=&quot;separating-messages-with-a-background-job&quot;&gt;Separating Messages With A Background Job&lt;/h2&gt;

&lt;p&gt;To add some reliability to the flow of exchanges, you should separate SDP from candidates with a background job. The solution to this problem plays out as follows:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Isolate SDP blobs from candidates.&lt;/li&gt;
  &lt;li&gt;Deliver SDP immediately.&lt;/li&gt;
  &lt;li&gt;Send candidate pairs through a background job with some delay.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;receive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;key?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'sdp'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;value?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'JOIN_ROOM'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;ActionCable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;broadcast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;room_channel_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:room_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;CandidateWorker&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;perform_async&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;room_channel_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:room_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The background job, with some delay, broadcasts the messages passed to it as usual.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CandidateWorker&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Sidekiq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Worker&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sidekiq_options&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;retry: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;perform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;channel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;
    &lt;span class=&quot;no&quot;&gt;ActionCable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;broadcast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;channel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I implemented the delay here to enable the SDP answer and offer to go first before the candidates. Even though Sidekiq has a feature to delay jobs, its timing isn’t precise enough for this purpose, and that’s why I used the good ol’ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sleep&lt;/code&gt; to implement the delay.&lt;/p&gt;

&lt;p&gt;The above guarantees that answers and offers are exchanged between ICE agents first, allowing for a stable connection every time.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/in-order-exchange.png&quot; alt=&quot;In order exchange&quot; title=&quot;In order exchange&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In a Node.js environment where things are event-driven, this problem is inexistent. Events get to the event loop and are picked from there, so you’re guaranteed order, and things work out as expected.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="rails"/>
      
        <category term="webrtc"/>
      

      
        <summary type="html">Rails’ ActionCable is excellent for building realtime features in applications. However, in some realtime communication applications, ActionCable is just not good enough. Especially in a stack where order matters.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">TIL #1: XML Bombs, HTTP Strict Transport Security &amp;amp; More.</title>
      
      
      <link href="https://manny.codes/til-1-xml-bombs-http-strict-transport-security-more/" rel="alternate" type="text/html" title="TIL #1: XML Bombs, HTTP Strict Transport Security &amp; More.">
      
      <published>2021-02-07T19:40:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/til-1-xml-bombs-http-strict-transport-security-more</id>
      <content type="html" xml:base="https://manny.codes/til-1-xml-bombs-http-strict-transport-security-more/">&lt;p&gt;This year I decided to &lt;a href=&quot;https://emmanuelhayford.com/dedicating-2021-to-writing-more-reading-less/&quot;&gt;write more&lt;/a&gt;. As part of keeping a writing habit, I thought it’d be beneficial to document things I learn and write monthly blog posts about them.&lt;/p&gt;

&lt;p&gt;I came up with this idea of mindfully noting down new knowledge to keep track of my path or remember things I learn better.&lt;/p&gt;

&lt;p&gt;The post you’re reading now is the very first of more to come. I call this kind of posts “MOTILs” – Month of TILs. MOTILs is the best name I came up with; it doesn’t matter what I call it. What matters is, writing consistently until the end of the year.&lt;/p&gt;

&lt;p&gt;Without further ado, here’s some stuff I learned in January 2021.&lt;/p&gt;

&lt;h2 id=&quot;subresource-integrity-checks&quot;&gt;Subresource Integrity Checks&lt;/h2&gt;
&lt;p&gt;Very often, we depend on third-party code. If an attacker breaches the source of the third-party code we import, they can cause harm.&lt;/p&gt;

&lt;p&gt;Assuming we import some JavaScript from a Content Delivery Network (CDN) and that CDN is hacked, the attacker and affix the JavaScript we import from the CDN with malicious code. Innocent users become vulnerable. &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity&quot;&gt;Subresource Integrity (SRI)&lt;/a&gt; is one way to mitigate attacks through third-party code.&lt;/p&gt;

&lt;p&gt;Taking advantage of this security feature involves just a handful of steps:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Get a cryptographic hash (digest) of the resource you’re importing.&lt;/li&gt;
  &lt;li&gt;Embed the resource with an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;integrity&lt;/code&gt; attribute containing the hash of the resource.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For the first step, you can leverage &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;openssl&lt;/code&gt; to generate the hash of the imported resource like so:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cat FILENAME.js | openssl dgst -sha384 -binary | openssl base64 -A&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;In the second step, you embed it. Your code could then look like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &amp;lt;script src=&quot;https://example.com/example-framework.js&quot;
        integrity=&quot;sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC&quot;
        crossorigin=&quot;anonymous&quot;&amp;gt;
  &amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There’s a &lt;a href=&quot;https://www.srihash.org/&quot;&gt;handy site&lt;/a&gt; that generates SRI hashes.&lt;/p&gt;

&lt;h2 id=&quot;http-strict-transport-security&quot;&gt;HTTP Strict Transport Security&lt;/h2&gt;

&lt;p&gt;A lot of sites redirect an HTTP connection to HTTPS. When a web browser visits a site it has seen before and gets a cookie from a server through HTTP, the browser attaches cookies on subsequent requests to the server through HTTP. Man-in-the-middle attacks can occur in the initial HTTP connection.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security&quot;&gt;HTTP Strict Transport Security&lt;/a&gt; policy instructs browsers to send cookies only over HTTPS. We can do this by setting the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Strict-Transport-Security&lt;/code&gt; header in responses from the server on Nginx for example, by setting.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
      add_header Strict-Transport-Security &quot;max-age=3153600&quot; always;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;the-doorway-effect&quot;&gt;The Doorway Effect&lt;/h2&gt;

&lt;p&gt;You know the feeling when you enter a room, and you forget why you got in? It’s happened to me countless times. When this happens, there’s one thing I do to remember what I went to that room for, and that is to get back out of the room, wait a few seconds then I remember what I was after. Well, it turns out there’s a name for it. It’s called the &lt;a href=&quot;https://www.bbc.com/future/article/20160307-why-does-walking-through-doorways-make-us-forget&quot;&gt;Doorway Effect&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Psychologists believe that passing through a doorway and entering a different room creates a ‘mental block’ in the brain, which means that walking through open doors resets the memory to make room for the creation of a new episode. This is generally referred to as the doorway effect.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;You’re welcome.&lt;/p&gt;

&lt;h2 id=&quot;check-in-last-minute-on-flights&quot;&gt;Check-In Last Minute On Flights&lt;/h2&gt;

&lt;p&gt;I can’t count how many times I’ve paid extra to secure the seat I want on a flight. &lt;a href=&quot;https://www.notion.so/30-Life-Enhancing-Learnings-e679359c28cb4fd38c6833d8a394eeba&quot;&gt;I learned that&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;When checking-in online many airlines ‘randomly’ allocate passenger seats, with the middle seats often assigned first so that passengers are tempted to pay extra to change their seat! - Peter Duffy&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This makes sense to me. I will try this after the pandemic is over. Ha!&lt;/p&gt;

&lt;h2 id=&quot;code-animation-in-keynote&quot;&gt;Code Animation in Keynote&lt;/h2&gt;

&lt;p&gt;Apple’s Keynote app is compelling. It seems less so if you don’t know how to use it or what to do with it. I learned how to animate code in Keynote. I spent about thirty minutes Googling and two hours of practice to get the hang of animating in Keynote.&lt;/p&gt;

&lt;p&gt;Here’s one of the animations I produced using Keynote.&lt;/p&gt;

&lt;center&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Writing yet another article on method_missing, got caught in animating instead of actually writing but here&amp;#39;s why you should make it a habit of defining respond_to_missing? anytime you overwrite method_missing. I&amp;#39;ll share the article after the battle with procrastination is won. &lt;a href=&quot;https://t.co/28tR74AACe&quot;&gt;pic.twitter.com/28tR74AACe&lt;/a&gt;&lt;/p&gt;&amp;mdash; Emmanuel Hayford (@siaw23) &lt;a href=&quot;https://twitter.com/siaw23/status/1348452885714128897?ref_src=twsrc%5Etfw&quot;&gt;January 11, 2021&lt;/a&gt;&lt;/blockquote&gt; &lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/center&gt;

&lt;p&gt;Fancy slide animations like this can be an effective way of teaching. I’m content I learned this.&lt;/p&gt;

&lt;h2 id=&quot;xml-bombs-or-billion-laughs-attack&quot;&gt;XML Bombs Or Billion Laughs Attack&lt;/h2&gt;

&lt;p&gt;These days JSON and YAML have taken over what XML was the go-to for decades ago. Only a few machines use XML to encode data now. The decline in XML’s popularity for data encoding or configuration doesn’t mean web servers stopped parsing it.&lt;/p&gt;

&lt;p&gt;All web servers parse XML, which means there’s an attack vector to mitigate.&lt;/p&gt;

&lt;p&gt;There are two main ways of describing XML structure:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Document Type Definition (DTD)&lt;/li&gt;
  &lt;li&gt;XML Schema Definition (XSD)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;XSD is more modern and expressive and describes a broader set of XML documents. I checked which of these two &lt;a href=&quot;https://nokogiri.org/&quot;&gt;Nokogiri&lt;/a&gt; uses and didn’t see any DTD trace; this is good because DTD-based parsers may be vulnerable to XML bombs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Billion_laughs_attack&quot;&gt;XML Bombs&lt;/a&gt; use inline DTDs to blow the memory usage of an XML parser up to crash servers.&lt;/p&gt;

&lt;h2 id=&quot;facebook-grasping-at-straws&quot;&gt;Facebook Grasping At Straws&lt;/h2&gt;

&lt;p&gt;I learned about &lt;a href=&quot;https://developers.facebook.com/docs/internet-org/&quot;&gt;Facebook’s efforts&lt;/a&gt; to stay relevant by providing “free internet” in &lt;a href=&quot;https://www.theguardian.com/technology/2017/jul/27/facebook-free-basics-developing-markets&quot;&gt;developing countries&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Perhaps they don’t want to die out like MySpace or Hi5. Facebook has already saturated getting new members in developed countries, and now they want to keep afloat by gaining new users, which equates to more data to target for ads.&lt;/p&gt;

&lt;p&gt;They still have some juice in the tank for some time. No one knows for how long though.&lt;/p&gt;

&lt;p&gt;One of the best things I did for myself in 2020 was to quit Facebook. Privacy issues aside, I honestly don’t find any value in Facebook.&lt;/p&gt;

&lt;p&gt;That’s it for January 2021.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="personal"/>
      
        <category term="TIL"/>
      

      
        <summary type="html">This year I decided to write more. As part of keeping a writing habit, I thought it’d be beneficial to document things I learn and write monthly blog posts about them.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Understanding The bcrypt Hashing Function And Its Role in Rails.</title>
      
      
      <link href="https://manny.codes/understanding-the-bcrypt-hashing-function-and-its-role-in-rails/" rel="alternate" type="text/html" title="Understanding The bcrypt Hashing Function And Its Role in Rails.">
      
      <published>2021-02-02T00:00:00+00:00</published>
      <updated>2022-10-12T17:42:54+00:00</updated>
      <id>https://manny.codes/understanding-the-bcrypt-hashing-function-and-its-role-in-rails</id>
      <content type="html" xml:base="https://manny.codes/understanding-the-bcrypt-hashing-function-and-its-role-in-rails/">&lt;p&gt;You may have implemented authentication in one of your apps, either directly with Rails’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;has_secure_password&lt;/code&gt; or indirectly through a gem like Devise. Whichever way, you persisted user passwords in some way.&lt;/p&gt;

&lt;p&gt;How are passwords securely stored in a database then? Let’s examine the underlining technology that safely keeps user passwords in a framework like Ruby on Rails.&lt;/p&gt;

&lt;p&gt;In a Ruby on Rails console, if you’re using say Devise and you query a user with a password, you’ll see something the looks like gibberish.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/password-hash.png&quot; alt=&quot;&amp;quot;password-hash&amp;quot;&quot; title=&quot;Password Hash&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The above is the password hash of a user’s plaintext password in the database. This value results from a password-hashing function; it’s how some frameworks securely store users’ passwords in the databases.&lt;/p&gt;

&lt;p&gt;The value you see in the preceding screenshot is &lt;i&gt;not&lt;/i&gt; an encrypted password. It’s a hash value of a plaintext a user chose as a password.&lt;/p&gt;

&lt;h2 id=&quot;the-difference-between-encryption-and-hashing&quot;&gt;The Difference Between Encryption And Hashing&lt;/h2&gt;

&lt;p&gt;With passwords being the sole means of authentication within apps, applications need some means to store passwords to allow users into their accounts. Encryption is a way to store passwords but not secure enough. Hashing is a safer way.&lt;/p&gt;

&lt;p&gt;The difference between encryption and hashing is:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Encryption is a two-way mathematical function.&lt;/li&gt;
  &lt;li&gt;Hashing is a one-way mathematical function.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;With encryption, if one gets a key, they can decrypt the encrypted content. With hashing the value that comes out of a hash function cannot be reversed to reveal the plain text, it’s like converting a cow to steak.&lt;/p&gt;

&lt;h2 id=&quot;how-password-hashing-helps-with-authentication&quot;&gt;How Password-Hashing Helps With Authentication&lt;/h2&gt;
&lt;p&gt;The idea of hashing passwords instead of encrypting them makes more sense when you think of it this way: anything man can encrypt… man can decrypt, with the right key. The key has to be stored somewhere on the server-side.&lt;/p&gt;

&lt;p&gt;If an attacker gets your database with encrypted passwords, they will try to get hold of the key. If you can somehow get rid of the extra attack vector of storing a key in the first place, you give the attacker a more challenging time figuring out what your users’ passwords are.&lt;/p&gt;

&lt;p&gt;The preceding statement is not to say password-hashing is flawless. Discussing the ways attackers can mitigate hash functions is beyond our scope today.&lt;/p&gt;

&lt;p&gt;Here’s how hash-functions make authentication possible:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;A user (let’s call her Alice), creates an account on your site.&lt;/li&gt;
  &lt;li&gt;Alice chooses a username and a password.&lt;/li&gt;
  &lt;li&gt;The server hashes Alice’s password, keeps a plaintext of the ID and stores this in the database.&lt;/li&gt;
  &lt;li&gt;Alice comes to the site at a later time; she enters her ID and password.&lt;/li&gt;
  &lt;li&gt;Her login details are securely (over HTTPS hopefully) transferred to your site’s backend.&lt;/li&gt;
  &lt;li&gt;On receiving the login details, the backend server looks up Alice in the database and passes her password through the same hash function that hashed her password when she signed up.&lt;/li&gt;
  &lt;li&gt;If the password hash of the password Alice entered matches the one stored in the database, Alice is granted access. Otherwise, the site denies Alice access.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Let’s see how this plays out in code.&lt;/p&gt;

&lt;h2 id=&quot;bcrypt-in-rails&quot;&gt;bcrypt In Rails&lt;/h2&gt;
&lt;p&gt;When you spin up a new application with Rails, you might notice that it comes with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; commented out. It’s there for you to create password digests with when you roll out your authentication logic.&lt;/p&gt;

&lt;p&gt;To leverage bcrypt, you comment out &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; and re-run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundler&lt;/code&gt; and add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;has_secure_password&lt;/code&gt; to the ActiveRecord model for which you want to enable authentication.&lt;/p&gt;

&lt;p&gt;When you add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;has_secure_password&lt;/code&gt; to your model, you get a method like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authenticate&lt;/code&gt; which is an alias to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authenticate_password&lt;/code&gt; that matches up plaintext you send to it to a hash value.&lt;/p&gt;

&lt;p&gt;Let the following be the User model:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_secure_password&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can add a migration that adds &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password_digest&lt;/code&gt; string to our database schema.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;version: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2021_01_30_173626&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;create_table&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;users&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;force: :cascade&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;password_digest&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;datetime&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;created_at&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;precision: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;null: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;datetime&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;updated_at&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;precision: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;null: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With the above in place, we can leverage &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; to store users’ passwords. All we need to do now is to create a user with a password like so:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;name: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Alice&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;password: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sekreet&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This returns:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/bcrypt-user-hash.png&quot; alt=&quot;bcrypt user hash&quot; title=&quot;bcrypt user hash&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Notice how we created the user with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password&lt;/code&gt; arguments, but we got back &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password_digest&lt;/code&gt;: this is the magic of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;has_secure_password&lt;/code&gt; storing a plaintext &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password&lt;/code&gt; as a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password_digest&lt;/code&gt;. We are not storing a password; we’re holding a digest of a password, so it makes sense that we created a string column called a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password_digest&lt;/code&gt; to keep the hash value in our migration.&lt;/p&gt;

&lt;p&gt;A “digest”, “hash value”, “hash code” or just “hash” are all different names to the same thing. I’ll use it interchangeably.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/password-digest.png&quot; alt=&quot;bcrypt user hash&quot; title=&quot;bcrypt user hash&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At this point, we can see how the plaintext value of “sekreet” is hashed by running &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;User.last.password_digest&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The value &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$2a$12$Uu744tDT28y8Zc5.bTxgUetv4oqAKzoihNjnMvendmt5xbNBuarcK&lt;/code&gt; here is the result of passing “sekreet” through the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; hashing function. This digest is not reversible. There’s no key to “decrypt” this hash.&lt;/p&gt;

&lt;p&gt;In our backend we can check if a user is who they claim to be by asking for their password, hashing them with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; to see if the digest matches the one stored. In other words, we’re checking if the passwords they registered with matches. If it matches we return the user (or whatever model invokes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;has_secure_password&lt;/code&gt;), otherwise Rails returns &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;false&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/password-authentication.png&quot; alt=&quot;password authentication&quot; title=&quot;password authentication&quot; /&gt;&lt;/p&gt;

&lt;!-- The algorithm identifier and cost is what we haven't discussed yet. You can find more information on [Wikipedia](https://en.wikipedia.org/wiki/Bcrypt) about this.--&gt;

&lt;p&gt;Now that we know what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; does in Rails let’s zoom in a bit and take a closer look at what it is and how it works.&lt;/p&gt;

&lt;h2 id=&quot;what-is-bcrypt&quot;&gt;What is bcrypt?&lt;/h2&gt;
&lt;p&gt;If you read up to this point, you may know that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; is a password-hashing function. Niels Provos and David Mazières designed this function. It incorporates a salt for protection against rainbow tables.&lt;/p&gt;

&lt;p&gt;New terms. Let’s define them.&lt;/p&gt;

&lt;h3 id=&quot;what-are-rainbow-tables&quot;&gt;What Are Rainbow Tables?&lt;/h3&gt;
&lt;p&gt;If hash functions like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; take a cleartext input and produces a hash code, an attacker knows that for a cleartext password like “sekreet” will always return the &lt;i&gt;same&lt;/i&gt; hash code. An attacker that knows your backend authentication system uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; stands to gain a lot if they get hold of the database.&lt;/p&gt;

&lt;p&gt;A rainbow table is a list of commonly used passwords and their hash codes that a known hashing algorithm has produced.&lt;/p&gt;

&lt;p&gt;If the hash code from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; of “password13” is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$2a$12$Uu744tDT28y8Zc5.bTxgUetv4oqAKzoihNjnMvendmt5xbNBuarcK&lt;/code&gt;, all an attacker needs to do is to iterate your database and find &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$2a$12$Uu744tDT28y8Zc5.bTxgUetv4oqAKzoihNjnMvendmt5xbNBuarcK&lt;/code&gt;, then the password of the user on that row is “password13”.&lt;/p&gt;

&lt;h3 id=&quot;what-is-a-salt&quot;&gt;What Is A Salt?&lt;/h3&gt;
&lt;p&gt;To combat rainbow table attacks, hash functions like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; incorporate a salt. A salt is a random data we add to input data to a hash function. A salt reinforces security by making every hash code different even for the same data input.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Users&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Salt&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Input to be hashed&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Hash code&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Alice&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;skIfs&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;b&gt;skIfs&lt;/b&gt;password&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$2a$12$yWbud6Fl/x…bMW&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Bob&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;sahsF&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;b&gt;sahsF&lt;/b&gt;password&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$2a$12$1hgi9kgehS…v5y&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Emmanuel&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;psoFs&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;b&gt;psoFs&lt;/b&gt;password&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;$2a$12$Uu744tDT28…rcK&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;The table above illustrates how &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; produces a different hash for all three users, even though their plaintext passwords are the same. An attacker who ran “password” through &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; will get a different hash value, so there’s no way for him to know the passwords of Alice, Bob and Emmanuel are “password”.&lt;/p&gt;

&lt;p&gt;We know what a salt is, now is an excellent time to examine the structure of a password hash from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;One property worth noting is the length of the hash codes, they are fixed-length; whatever the length of your password (capped at 72 bytes). A typical password hash looks like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/bcrypt-structure.png&quot; alt=&quot;bcrypt structure&quot; title=&quot;bcrypt structure&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The algorithm identifier shows what crypt (a UNIX utility program used for encryption) generated the hash. The cost factor specifies a key expansion iteration count as a power of two, which is an input to the crypt algorithm.&lt;/p&gt;

&lt;h2 id=&quot;an-overview-of-how-the-bcrypt-algorithm-works&quot;&gt;An Overview Of How The bcrypt Algorithm Works&lt;/h2&gt;

&lt;p&gt;There are several password-hashing functions. The one Rails and Devise use is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; via the &lt;a href=&quot;https://github.com/codahale/bcrypt-ruby&quot;&gt;bcrypt-ruby&lt;/a&gt; gem. It is based on the &lt;a href=&quot;https://en.wikipedia.org/wiki/Blowfish_(cipher)&quot;&gt;Blowfish cipher&lt;/a&gt;, giving us the “b” in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt;. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;crypt&lt;/code&gt; comes from the hashing function used by the UNIX password system.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://www.usenix.org/legacy/events/usenix99/provos/provos_html/node6.html&quot;&gt;implementation details&lt;/a&gt; of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; is beyond the scope of this post. Here’s a bird’s eye view of how the function works:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/bcrypt-algo.png&quot; alt=&quot;bcrypt algorithm&quot; title=&quot;bcrypt algorithm&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The function accepts three parameters.&lt;/li&gt;
  &lt;li&gt;A function called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EksBlowfishSetup&lt;/code&gt; takes the cost, salt and key and sets up a state. It uses the password as a key.&lt;/li&gt;
  &lt;li&gt;A 192-bit magic value “OrpheanBeholderScryDoubt” is encrypted sixty-four times in &lt;a href=&quot;https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_(ECB)&quot;&gt;ECB mode&lt;/a&gt; with the state from the earlier step.&lt;/li&gt;
  &lt;li&gt;The cost, salt and encrypted value are then concatenated and prefixed with the crypt and its version.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The result of this complex process is what is stored in a password digest, then used for authentication and other purposes. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt-ruby&lt;/code&gt; does all of this, so we don’t have to.&lt;/p&gt;

&lt;h2 id=&quot;how-rails-employs-bcrypt&quot;&gt;How Rails Employs bcrypt&lt;/h2&gt;

&lt;p&gt;We stated earlier that Ruby on Rails uses the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; hashing function via the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt-ruby&lt;/code&gt; gem. Rails requires &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ActiveModelSecurePassword&lt;/code&gt;. We saw how adding &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;has_secure_password&lt;/code&gt; gives you all the magic. &lt;a href=&quot;https://github.com/rails/rails/blob/main/activemodel/lib/active_model/secure_password.rb&quot;&gt;This is where&lt;/a&gt; the magic happens in Rails:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ActiveModel&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;SecurePassword&lt;/span&gt;
    &lt;span class=&quot;kp&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Concern&lt;/span&gt;

    &lt;span class=&quot;no&quot;&gt;MAX_PASSWORD_LENGTH_ALLOWED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;72&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:min_cost&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# :nodoc:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;min_cost&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ClassMethods&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;has_secure_password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attribute&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;validations: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
          &lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bcrypt&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;rescue&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;LoadError&lt;/span&gt;
          &lt;span class=&quot;vg&quot;&gt;$stderr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;You don't have bcrypt installed in your application. Please add it to your Gemfile and run bundle install&quot;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We’ve come to the end of learning about &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; and what it gives us in our Ruby applications. There’s a whole lot we could have discussed; we could have talked about security, Argon2 comparison, how &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bcrypt&lt;/code&gt; adapts with increasing hardware power against brute-force attacks, key expansion et cetera; but then we’d be writing a mini-book.&lt;/p&gt;

&lt;p&gt;Encryption and hashing are complex subjects. Thankfully, we don’t have to be experts in these computer security areas to leverage cryptography.&lt;/p&gt;

&lt;p&gt;It does help in some cases though to understand a bit of what goes on under the hood. I hope this article gave you a little understanding of the subject of hashing for authentication.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="rails"/>
      
        <category term="authentication"/>
      

      
        <summary type="html">You may have implemented authentication in one of your apps, either directly with Rails’s has_secure_password or indirectly through a gem like Devise. Whichever way, you persisted user passwords in some way.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">3 Practical Uses of Ruby’s `method_missing` Worth Knowing.</title>
      
      
      <link href="https://manny.codes/3-practical-uses-of-ruby-method-missing/" rel="alternate" type="text/html" title="3 Practical Uses of Ruby's `method_missing` Worth Knowing.">
      
      <published>2021-01-22T07:10:00+00:00</published>
      <updated>2022-09-27T16:21:18+00:00</updated>
      <id>https://manny.codes/3-practical-uses-of-ruby-method-missing</id>
      <content type="html" xml:base="https://manny.codes/3-practical-uses-of-ruby-method-missing/">&lt;p&gt;Ruby’s dynamism is awe-inspiring. One of the methods that contribute to this is &lt;strong&gt;method_missing&lt;/strong&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; is defined in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BasicObject&lt;/code&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; allows us to:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#method_missing-for-error-handling&quot;&gt;handle errors&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#method-delegation-with-method_missing&quot;&gt;delegate methods&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#building-dsls-and-libraries-with-method_missing&quot;&gt;build DSLs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Let’s discuss the practical uses of this method.&lt;/p&gt;

&lt;h2 id=&quot;what-is-rubys-method_missing&quot;&gt;What is Ruby’s method_missing?&lt;/h2&gt;
&lt;p&gt;We define methods inside classes. Ruby traverses a method lookup path when an object calls a method, starting from the object’s class and up the object’s class’s ancestor chain to reach the method. If the method the object calls is available in the lookup path, Ruby calls it. On some occasions, the method isn’t present in the ancestor chain.&lt;/p&gt;

&lt;p&gt;All method lookups that fail end up reaching a method called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; lives inside the BasicObject class, the root of all classes.&lt;/p&gt;

&lt;p&gt;For a class, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Aircraft&lt;/code&gt;, that mixes in no other modules or prepends other module or inherit other classes, this is how the traversal would look like (I’ve omitted the lookup through eigenclasses for simplicity):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/ruby-method-missing-lookup.png&quot; alt=&quot;Ruby method_missing lookup path.&quot; title=&quot;ruby method_missing lookup path&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;method_missing-for-error-handling&quot;&gt;method_missing For Error Handling&lt;/h2&gt;

&lt;p&gt;Perhaps the most common use of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; is its support for gracefully handling errors. When an object invokes a method, Ruby navigates the method lookup chain looking for the method to execute. On reaching &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BasicObject&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; is called. The interpreter raises an error at this point.&lt;/p&gt;

&lt;p&gt;Here’s an example:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Aircraft&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:passengers&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@passengers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;taxi&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;park&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;fly&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s what happens when you call an inexistent method on an object: When the search for a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#fly&lt;/code&gt; method in the inheritance tree ends in vain, then the method call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aircraft.fly&lt;/code&gt; will output &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;main&amp;gt;: undefined method 'fly' for #&amp;lt;Aircraft:0x00007fe66c1591e0 @passengers=0&amp;gt; (NoMethodError)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;It would be nice to be able to handle this error in a friendlier way. Ruby permits this by making programmers override &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; takes three parameters; a method name, its list of arguments and a block. The last two are optional.&lt;/p&gt;

&lt;p&gt;To handle these errors, you intercept the call to BasicObject’s &lt;a href=&quot;https://apidock.com/ruby/BasicObject/method_missing&quot;&gt;method_missing&lt;/a&gt; with your own. Here’s a rewrite of our &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Aircraft&lt;/code&gt; code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Aircraft&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:passengers&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@passengers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_missing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;You called &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; with &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;. This method doesn't exist.&quot;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;NoMethodError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;add_passengers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;275&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;With this change, we now have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'method_missing': You called add_passengers with [275]. This method doesn't exist. (NoMethodError)&lt;/code&gt; as output, this looks more welcoming than the error we saw before. This example shows the extent to which Ruby allows programmers to own their code.  A slightly more sophisticated example may involve the use of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;super&lt;/code&gt; where if someone calls an inexistent method, you’d want first to perform some operation  on the method and then only pass control to the original &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; method as shown in this example from Ruby’s &lt;a href=&quot;https://ruby-doc.org/core-2.7.1/BasicObject.html#method-i-method_missing&quot;&gt;documentation&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Roman&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;roman_to_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_missing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;id2name&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;roman_to_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;rescue&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Roman&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;iv&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;xxiii&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 23&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 2000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; NoMethodError&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With more complicated usages of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;, come more significant responsibilities. When you override &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;, you have to make sure that whatever method you call inside it is available. Otherwise, you’ll end up going in circles and eventually get a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SystemStackError&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Expanding on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Aircraft&lt;/code&gt; class, here’s something more meaningful. If a method call on an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Aircraft&lt;/code&gt; instance starts with “add_”, we call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;public_send&lt;/code&gt; on the instance passing it a setter method that sets the variable of whatever comes after “add_”.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Aircraft&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:passengers&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@passengers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_missing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/add_(.*)/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;public_send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;add_passengers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;275&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;passengers&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 275&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;respond_to?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:add_passengers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; method, if the method called on any instance of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Aircraft&lt;/code&gt; matches “add_”, we call a setter method and pass it the arguments that came with the method call.&lt;/p&gt;

&lt;p&gt;However, it would help if you took note that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;respond_to&lt;/code&gt; “add_passengers” returns false, this is not true, and that’s why it’s good practice always to override &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;respond_to_missing?&lt;/code&gt; method anytime you override &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;In our case, we add:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;respond_to_missing?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;include_private&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/add_(.*)/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Aircraft&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:passengers&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@passengers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_missing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/add_(.*)/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;public_send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;respond_to_missing?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;include_private&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/add_(.*)/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;add_passengers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;275&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;passengers&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 275&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;respond_to?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:add_passengers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;method-delegation-with-method_missing&quot;&gt;Method Delegation With method_missing&lt;/h2&gt;

&lt;p&gt;According to Wikipedia, delegation refers to evaluating a member (property or method) of one object (the receiver) in the context of another original object (the sender), this means, an object is asking another object to perform the actions in the method the receiver is calling.&lt;/p&gt;

&lt;p&gt;You can use Ruby’s method_missing to delegate methods to another class.&lt;/p&gt;

&lt;p&gt;Here’s a contrived example:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Referee&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;red_card?&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;true&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Linesman&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@referee&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referee&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_missing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@referee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;linesman&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Linesman&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Referee&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;linesman&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;red_card?&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the code above we call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;red_card?&lt;/code&gt; on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;linesman&lt;/code&gt;, an instance of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Linesman&lt;/code&gt;, but it’s an instance of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Referee&lt;/code&gt; that does the job, this is an example of some form of delegation.&lt;/p&gt;

&lt;p&gt;Ruby provides a library called &lt;a href=&quot;https://ruby-doc.org/stdlib-3.0.0/libdoc/delegate/rdoc/Delegator.html&quot;&gt;delegate&lt;/a&gt; in its Standard Library that you might want to check out first if you need to do serious method delegation,&lt;/p&gt;

&lt;h2 id=&quot;building-dsls-and-libraries-with-method_missing&quot;&gt;Building DSLs And Libraries With method_missing&lt;/h2&gt;
&lt;p&gt;A &lt;a href=&quot;https://en.wikipedia.org/wiki/Domain-specific_language&quot;&gt;domain-specific language (DSL)&lt;/a&gt; is a language with which you can do specific tasks. Unlike Ruby, a DSL like &lt;a href=&quot;https://manny.codes/7-ways-to-selectively-run-rspec-tests/&quot;&gt;RSpec&lt;/a&gt; only useful for testing.&lt;/p&gt;

&lt;p&gt;DSLs are relatively easier to write. DSLs are everywhere. A few examples are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Capistrano&lt;/li&gt;
  &lt;li&gt;Rake&lt;/li&gt;
  &lt;li&gt;Sinatra&lt;/li&gt;
  &lt;li&gt;Rails Routing&lt;/li&gt;
  &lt;li&gt;factory_bot&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ruby’s &lt;strong&gt;method_missing&lt;/strong&gt; makes it very easy to build DSLs. Let’s try our shot with the simplest XML generator. Here’s a modified snippet I grabbed from The Ruby Programming Language book.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;XML&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;XML&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_missing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{})&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;block_given?&lt;/span&gt;
      &lt;span class=&quot;vi&quot;&gt;@output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&amp;gt;'&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt;

      &lt;span class=&quot;vi&quot;&gt;@output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;

      &lt;span class=&quot;vi&quot;&gt;@output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;vi&quot;&gt;@output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/&amp;gt;'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;no&quot;&gt;XML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;instance_eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This code allows us to write something like:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;no&quot;&gt;XML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;STDOUT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Page Title&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;strong&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&quot;Strong Text&quot;&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running this produces:&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title/&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;strong&amp;gt;&lt;/span&gt;Strong Text&lt;span class=&quot;nt&quot;&gt;&amp;lt;/strong&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And just like that, we’ve harnessed the power of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; to create a DSL that generates XML.&lt;/p&gt;

&lt;p&gt;An excellent example of a DSL that relies on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; is The Late Jim Weirich’s &lt;a href=&quot;https://github.com/jimweirich/builder&quot;&gt;Builder&lt;/a&gt; gem. The Builder gem generates XML markup from blocks, &lt;a href=&quot;https://github.com/jimweirich/builder/blob/master/lib/builder/xmlbase.rb#L91&quot;&gt;much like&lt;/a&gt; what we just wrote but more sophisticated.&lt;/p&gt;

&lt;p&gt;Another example that might seem familiar is &lt;a href=&quot;https://github.com/rails/rails/blob/main/activerecord/lib/active_record/dynamic_matchers.rb#L15&quot;&gt;Ruby on Rails’s dependence&lt;/a&gt; on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; to create dynamic finders like the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find_by_*&lt;/code&gt; group of methods in ActiveRecord.&lt;/p&gt;

&lt;h2 id=&quot;question-on-the-traversal-for-method_missing&quot;&gt;Question On The Traversal For method_missing&lt;/h2&gt;
&lt;p&gt;I learned yesterday from a group that Ruby does the traversal for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; twice. The first one is to reach the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BasicObject&lt;/code&gt;, and the second traversal is to check if you overrode &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;: this makes sense, otherwise, how would Ruby pick up the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; you’ve overwritten.&lt;/p&gt;

&lt;p&gt;I haven’t found any reference on this. Please share if you have some documentation somewhere about this fact.&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;We’ve seen how to use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; to handle errors and to do method delegation. With the help of another metaprogramming construct, we saw how to use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;instance_eval&lt;/code&gt; to write a DSL that generates XML. We looked at how Ruby traverses the ancestor chain to find methods and calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt; if it finds nothing. We learned that it’s a good idea to overwrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;respond_to_missing?&lt;/code&gt; any time we overwrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing?&lt;/code&gt;; this covers the list of things you can do with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method_missing&lt;/code&gt;. If you can think of any other use cases, please share them in the comments below.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="metaprogramming"/>
      

      
        <summary type="html">Ruby’s dynamism is awe-inspiring. One of the methods that contribute to this is method_missing. method_missing is defined in BasicObject. method_missing allows us to:</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Dedicating 2021 To Writing More And Reading Less.</title>
      
      
      <link href="https://manny.codes/dedicating-2021-to-writing-more-reading-less/" rel="alternate" type="text/html" title="Dedicating 2021 To Writing More And Reading Less.">
      
      <published>2021-01-20T12:26:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/dedicating-2021-to-writing-more-reading-less</id>
      <content type="html" xml:base="https://manny.codes/dedicating-2021-to-writing-more-reading-less/">&lt;p&gt;I don’t do New Year’s Resolutions”. I don’t set any resolutions on the 1st of January partly because I like to treat all days equally. The reason behind this is, I feel restrained when I have to celebrate something on a day set by God knows who.&lt;/p&gt;

&lt;p&gt;It’s January 2021 now, and I choose to write more this year. I’ve noticed I consume a lot of information but do very little with it. If reading books were like alcohol consumption, I’d be in rehab.&lt;/p&gt;

&lt;p&gt;I’ve thought carefully about how much information I gobble up, and I think I’ve had enough of reading. I don’t want to be a &lt;a href=&quot;https://en.wikipedia.org/wiki/Tsundoku&quot;&gt;Tsundoku&lt;/a&gt; master. I want to write.&lt;/p&gt;

&lt;p&gt;I am self-diagnosed with infobesity. I read about tech stacks all over the place. At one point I’m learning about gRPC; at another, I’m learning web performance or fitness or astrophysics. It’s a mess in my head.&lt;/p&gt;

&lt;p&gt;This year, I want to make an active effort to write more. Writing is a skill I want to get good at, and there’s no other place to get my thoughts on “paper” other than my blog. I admire &lt;a href=&quot;https://seths.blog/&quot;&gt;Seth Godin&lt;/a&gt;. He writes every single day! It’s inspiring, but I won’t be writing &lt;a href=&quot;https://sive.rs/nod&quot;&gt;every single day&lt;/a&gt; though.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/emmanuel-tweet.png&quot; alt=&quot;Emmanuel's tweets about blogging 52 posts.&quot; title=&quot;Emmanuel's tweets about blogging 52 posts.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;While I won’t be writing like Seth, I’ve set a “realistic” goal of writing a blog post every week; this should get me to 52 blog posts at the end of the year. I am setting a bar to reach. My posts won’t be systematic. In some months I may write zero posts, in other months, I’ll write eight posts. But, I’d like to reach the 52 blogs posts at the end of the year.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/colleen-tweet.png&quot; alt=&quot;Colleen's tweets about reading less and doing more.&quot; title=&quot;Colleen's tweets about reading less and doing more.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I don’t see any sense in consuming a lot of content and not using the new knowledge. I’ve decided that if at least I won’t be building anything, I’ll be offloading the information in the form of writing, sharing what I’ve learned. Or polish my writing. This way, at least someone may find it useful.&lt;/p&gt;

&lt;h2 id=&quot;a-remedy-for-information-overload&quot;&gt;A Remedy for Information Overload&lt;/h2&gt;

&lt;p&gt;At the start of this month (not a New Year’s Resolution, just a happenstance), I started a new habit of tracking things I learn. It’s interesting how some of us learn new things every day and never follow them (speaking for myself).&lt;/p&gt;

&lt;p&gt;I think one way to keep track of the what we learn is to write them down in some form.&lt;/p&gt;

&lt;p&gt;To combat information anxiety, I’ve made yet another decision to blog every new thing I learn at the end of each month. I’ll mindfully note down new items I pick up that I find interesting. If I had a way to reflect and put into writing novel information, I’d remember more of what I learn. Readers will learn from what I share too.&lt;/p&gt;

&lt;p&gt;I don’t know what to call this type of blog posts yet. It’ll be a collection of &lt;a href=&quot;https://www.reddit.com/r/todayilearned/&quot;&gt;TILs&lt;/a&gt; at the end of each month, so maybe I can call them “MonTILs”? MonTIL #1 or something like that or even TMILs which I just made up. It stands for “This Month I Learned”.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Fifty-two blog posts for the whole year don’t seem like a lot, but you realise it’s harder than it looks when you set up to write. First, you have to think up good topics to write about, research your facts, plan the writing, edit grammar etc. It takes time, but it’s a goal I want to accomplish – I want to get better at technical writing then write a book some day.&lt;/p&gt;

&lt;p&gt;I’ve set a lot of “private” goals that amounted to nothing. This time, I’m experimenting with going public with my small plans. Maybe if I have eyeballs watching, I can get things done. You’ll hold me accountable by observing.&lt;/p&gt;

&lt;p&gt;I’ll collect things I learn each day and write about them at the end of the month and share with you.&lt;/p&gt;

&lt;p&gt;I consider this a journey. If you have tips, ideas or advice, please shoot them my way via the comments.&lt;/p&gt;

&lt;p&gt;So, here’s to a no-excuses, no-bullshitting start to 52 blog posts in 2021!&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="personal"/>
      
        <category term="weblog"/>
      

      
        <summary type="html">I don’t do New Year’s Resolutions”. I don’t set any resolutions on the 1st of January partly because I like to treat all days equally. The reason behind this is, I feel restrained when I have to celebrate something on a day set by God knows who.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">An SMS Reminder Service With Ruby &amp;amp; A Raspberry Pi.</title>
      
      
      <link href="https://manny.codes/building-an-sms-reminder-with-ruby-raspberry-pi/" rel="alternate" type="text/html" title="An SMS Reminder Service With Ruby &amp; A Raspberry Pi.">
      
      <published>2020-09-10T06:58:00+00:00</published>
      <updated>2022-10-11T22:29:32+00:00</updated>
      <id>https://manny.codes/building-an-sms-reminder-with-ruby-raspberry-pi</id>
      <content type="html" xml:base="https://manny.codes/building-an-sms-reminder-with-ruby-raspberry-pi/">&lt;p&gt;Just about a fortnight ago, I became a father. I acquired new responsibilities, one of which is to make sure our newborn gets his supplements. In our case, I must give a drop of vitamin D to our son every day for a year. My partner asked me to remind her about this. I could use a reminder on my phone, but I miss reminders – I have all notifications turned off.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://www.raspberrypi.org/&quot;&gt;Raspberry Pi&lt;/a&gt; is a functional computer with modest specs for portability. The official OS on the Raspberry Pi is &lt;a href=&quot;https://www.raspberrypi.org/software/operating-systems/&quot;&gt;Raspberry Pi OS&lt;/a&gt; which is based on &lt;a href=&quot;https://www.debian.org/&quot;&gt;Debian&lt;/a&gt;, a Linux distribution. It comes loaded with free and open-source software. Two of which I used for our project: Ruby and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;systemd&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I just got a &lt;strong&gt;Raspberry Pi (RPi)&lt;/strong&gt; and I thought a fun way to make use of it would be to delegate the reminding to it so that it sends daily SMS messages to my partner to give our little one his Vitamin D drop.&lt;/p&gt;

&lt;h2 id=&quot;sending-messages-with-ruby-and-twilio&quot;&gt;Sending Messages with Ruby and Twilio&lt;/h2&gt;

&lt;p&gt;The Ruby code to manage messages is nothing special. &lt;a href=&quot;https://www.twilio.com/&quot;&gt;Twilio&lt;/a&gt; has good support for Ruby so it was enough to create a Twilio client that loops through an array of messages. I used the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dotenv&lt;/code&gt; gem to hide sensitive information then I created a separate thread within which I wrote a periodic loop to pick a random message from our array of messages.&lt;/p&gt;

&lt;p&gt;With the way I wrote the loop, there’ll be some time slippage but it’s not something we care about. A good way to fix this would have been to write the loop in a way that takes into account how much time dispatching a message takes so the looping period doesn’t slip ahead. Before you ask about &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cron&lt;/code&gt;, I didn’t want to use it. I’ll pick &lt;a href=&quot;https://www.freedesktop.org/software/systemd/man/systemd.timer.html&quot;&gt;systemd.timer&lt;/a&gt; in the future over &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cron&lt;/code&gt; for a more fine-grained control.  There’s also a seemingly good &lt;a href=&quot;https://github.com/socketry/timers&quot;&gt;timers&lt;/a&gt; gem that could have been useful. I like to keep my dependencies to a minimum – This is what I quickly came up with:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# /home/pi/vitamind.rb&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'bundler/inline'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gemfile&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;gem&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'twilio-ruby'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;gem&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'dotenv'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Dotenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'.env'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Messenger&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Twilio&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;REST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ACCOUNT_SID'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'AUTH_TOKEN'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dispatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;from: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'FROM'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;to: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'TO'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;body: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;thread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;MESSAGES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;1 drop of Vit D for the little one!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;Another reminder message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;More reminder SMS&quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;freeze&lt;/span&gt;

  &lt;span class=&quot;vi&quot;&gt;@messenger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;no&quot;&gt;Messenger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;

  &lt;span class=&quot;kp&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@messenger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dispatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MESSAGES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Don't care about slippage&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;82_800&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;93_600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;rescue&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Log e&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;thread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This does it for the Ruby side.&lt;/p&gt;

&lt;p&gt;Running on ARM means it doesn’t need to consume much to function, at &lt;i&gt;3.4W&lt;/i&gt;, the Raspberry Pi 4 doesn’t consume much compared to the average &lt;i&gt;100W&lt;/i&gt; consumption of a laptop. This is where delegating small tasks to a dedicated Raspberry Pi makes sense.&lt;/p&gt;

&lt;h2 id=&quot;running-an-sms-service-on-the-raspberry-pi&quot;&gt;Running an SMS Service on the Raspberry Pi&lt;/h2&gt;
&lt;p&gt;To realise the SMS service, I “daemonised” the Ruby script using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;systemd&lt;/code&gt;. A script as a daemon means it can run quietly in the background while I used the RPi for other tasks. In fact, following the same strategy, I manage a business Twitter account that set me back $15 each month through an external service.&lt;/p&gt;

&lt;p&gt;The first thing after the script was to write a unit file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vitamind.service&lt;/code&gt; for the service to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/lib/systemd/system&lt;/code&gt; with the following content:&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Unit]
Description=Vitamin D reminder service for H.

[Service]
User=pi
Group=pi
WorkingDirectory=/home/pi
Restart=always
ExecStart=/usr/bin/ruby vitamind.rb

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The full path for this file is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/lib/systemd/system/vitamind.service&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[...]&lt;/code&gt; denote sections. Here I have Unit, Service and Install sections. The Unit section is for metadata and configuring the relationship of the unit with other units. The Service section provides configuration for services and lastly, the Install section, which is optional but in my case is critical for our purpose. The Install section has a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;WantedBy=&lt;/code&gt; directive that dictates how a unit should be enabled.&lt;/p&gt;

&lt;p&gt;When a unit is enabled, the Install section as I have it marks it to start automatically at boot. It meant I could restart the RPi at any time and not worry about whether the service is working or not: It’ll start working automatically. The only thing I need to worry about in my ruby script is to ensure an SMS message is sent only once per day irrespective of how many times I restart the RPi.&lt;/p&gt;

&lt;p&gt;From here I enabled the service with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;systemctl enable vitamind.service&lt;/code&gt; and then brought the unit to start working with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;systemctl start vitamind.service&lt;/code&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;systemctl status vitamind.service&lt;/code&gt; tells us the status of the service as show below:&lt;/p&gt;

&lt;div style=&quot;text-align:center&quot;&gt;
  &lt;img align=&quot;center&quot; src=&quot;/images/systemctl_status.png&quot; alt=&quot;Mounted RPI&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;From this point on I’ve done everything necessary to keep our little SMS reminder running until we decide to stop it or our balance on Twilio runs dry.&lt;/p&gt;

&lt;p&gt;I found a permanent base of power supply for our RPi in some corner at home. I only SSH into this from my desk when I need to.&lt;/p&gt;

&lt;div style=&quot;text-align:center&quot;&gt;
  &lt;img align=&quot;center&quot; src=&quot;/images/mounted_rpi.jpg&quot; alt=&quot;Mounted RPI&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;I have a lot more tasks to delegate to this little computer, mostly just to tinker with apps, servers and services. At this point, we get daily reminders. On several occasions, we forgot to give our newborn his Vitamin D drop – The service saved those days.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="raspberry pi"/>
      

      
        <summary type="html">Just about a fortnight ago, I became a father. I acquired new responsibilities, one of which is to make sure our newborn gets his supplements. In our case, I must give a drop of vitamin D to our son every day for a year. My partner asked me to remind her about this. I could use a reminder on my phone, but I miss reminders – I have all notifications turned off.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">`obj.method_name` vs `class « obj`: The Real Difference.</title>
      
      
      <link href="https://manny.codes/the-difference-between-self-method-name-and-class-self-in-ruby/" rel="alternate" type="text/html" title="`obj.method_name` vs `class &lt;&lt; obj`: The Real Difference.">
      
      <published>2020-04-04T03:22:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/the-difference-between-self-method-name-and-class-self-in-ruby</id>
      <content type="html" xml:base="https://manny.codes/the-difference-between-self-method-name-and-class-self-in-ruby/">&lt;p&gt;&lt;img src=&quot;/images/different_between_self_method_class_self.jpg&quot; alt=&quot;The Real Difference: obj.method_name vs class &amp;lt;&amp;lt; obj.&quot; title=&quot;The Real Difference: self.method_name vs class &amp;lt;&amp;lt; self.&quot; /&gt;&lt;em&gt;Photo by Will Francis&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;I was looking at &lt;a href=&quot;https://stackoverflow.com/questions/2025569/difference-between-self-method-name-and-class-self-in-ruby&quot;&gt;some answers&lt;/a&gt; on StackOverflow for the difference between Ruby’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;self.method_name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; self&lt;/code&gt;. I wasn’t satisfied with &lt;a href=&quot;https://stackoverflow.com/questions/10964081/class-self-vs-self-method-with-ruby-whats-better&quot;&gt;the answers&lt;/a&gt;. While all the answers did very well at explaining &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;object.method_name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; object&lt;/code&gt;, I feel none stated the difference sought after. This is to complement these answers on how they &lt;i&gt;differ&lt;/i&gt;.&lt;/p&gt;

&lt;h1 id=&quot;the-noteworthy-detail&quot;&gt;The noteworthy detail.&lt;/h1&gt;

&lt;p&gt;To me, the difference between&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;object.method_name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; object&lt;/code&gt; that’s worth propagating would be how both notations resolve constants. Let’s go through an example.&lt;/p&gt;

&lt;p&gt;Let’s assume we have a program like this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;FLIGHT_NUMBER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;QTR1&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;FLIGHT_NUMBER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;QTR5&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In our short program, we have two constants, both named &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FLIGHT_NUMBER&lt;/code&gt;, but with different values. Note how we’re setting the last constant inside of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aircraft&lt;/code&gt;’s anonymous (singleton) class.&lt;/p&gt;

&lt;p&gt;With the above let’s use both notations to define singleton methods and call these methods:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;print_flight_no&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;FLIGHT_NUMBER&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;show_flight_no&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;FLIGHT_NUMBER&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;print_flight_no&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;aircraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;show_flight_no&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This returns:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QTR1
QTR5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As stated concisely by a Redditor:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;When you write &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;def object.method_name&lt;/code&gt;, you are defining a method in the specified object’s eigenclass, but not changing the default ‘definee’ or the ‘cref’ within the body of that method.&lt;/p&gt;

  &lt;p&gt;When you write &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; object&lt;/code&gt;, you are updating both the default ‘definee’ and the ‘cref’ with the object’s eigenclass, until the end of the class definition.&lt;/p&gt;

  &lt;p&gt;– Flimsy_Pomelo&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There are some &lt;a href=&quot;https://blog.yugui.jp/entry/846&quot;&gt;rare elaborations&lt;/a&gt; in the depths of the internet on this subject.&lt;/p&gt;

&lt;p&gt;The visibility of our constants is affected by the notation we pick. In general, the apparent implications of both notations are similar. You choose one over the other if scoping and grouping of class methods are what matter to you.&lt;/p&gt;

&lt;h1 id=&quot;different-notations-different-reactions&quot;&gt;Different notations. Different reactions.&lt;/h1&gt;
&lt;p&gt;Like you already know, everything (almost) in Ruby is an object. These objects can have singleton methods attached to them except for the subclasses of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Numeric&lt;/code&gt; class: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Complex&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Rational&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Float&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Integer&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;These class react differently to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;obj.method_name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; obj&lt;/code&gt;. Here’s an example:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hi&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;hey!&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above will output something like:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;can't modify frozen object: 1+0i (FrozenError)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Doing this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hi&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;hey!&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# OR&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;hi&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;hey!&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;can't define singleton (TypeError)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Subclasses of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Numeric&lt;/code&gt; class behave differently to both ways of defining singleton methods on them. You shouldn’t consider this a &lt;i&gt;real&lt;/i&gt; difference, but it doesn’t hurt knowing that descendants of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Numeric&lt;/code&gt; can’t have singleton methods on their instances.&lt;/p&gt;

&lt;p&gt;#StayHome. Stay safe.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="eigenclass"/>
      

      
        <summary type="html">Photo by Will Francis</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Maintaining Sanity With Ruby Under A Lockdown.</title>
      
      
      <link href="https://manny.codes/maintaining-sanity-with-ruby-under-a-lockdown/" rel="alternate" type="text/html" title="Maintaining Sanity With Ruby Under A Lockdown.">
      
      <published>2020-03-29T23:01:00+00:00</published>
      <updated>2022-11-01T08:30:30+00:00</updated>
      <id>https://manny.codes/maintaining-sanity-with-ruby-under-a-lockdown</id>
      <content type="html" xml:base="https://manny.codes/maintaining-sanity-with-ruby-under-a-lockdown/">&lt;p&gt;&lt;img src=&quot;/images/maintaining_sanity_with_ruby_under_a_lockdown.png&quot; alt=&quot;Maintaining Sanity with Ruby Under A Lockdown.&quot; title=&quot;Maintaining Sanity with Ruby Under A Lockdown.&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-virus&quot;&gt;The Virus&lt;/h2&gt;

&lt;p&gt;I had read a lot about plagues and pandemics years back wondering how and why these viruses spring up, wreak havoc and then just vanish into thin air! I realised these outbreaks were periodic, spanning several months if not years. Little did I know that my generation would be living through one.&lt;/p&gt;

&lt;p&gt;Another question I pondered was if these pandemics are cyclic, why haven’t we in the 21st century, with all the advancements in technology and medicine, learned anything about how to prevent these epidemics and pandemics, most of which are endemic? Perhaps we aren’t the most intelligent species in the universe after all.&lt;/p&gt;

&lt;p&gt;I’m deeply saddened and brokenhearted by how lives are being lost, and how society has been repressed to react to combat the virus with all the social distancing measures and lockdowns, a looming deep recession and all the detrimental side effects this virus has triggered. Besides people losing loved ones, jobs are being lost, making it even tougher for some of us to find new projects to work on.&lt;/p&gt;

&lt;p&gt;Back in 2015, Bill Gates gave a &lt;a href=&quot;https://www.youtube.com/watch?v=6Af6b_wyiwI&quot;&gt;TED talk&lt;/a&gt; that I’m sure nobody knew about until now. Had our politicians and leaders paid heed and played germ games instead of war games, prepared and braced for the worse with viral outbreaks adequately, and had some governments not suppressed public health information, this probably wouldn’t have happened… not at this scale.&lt;/p&gt;

&lt;p&gt;It’s not all bitter for some of us. In these hard times, we need something to distract us from the reality of what’s happening. For most, it’s our families, pets, games, watching all the Harry Potter series or anything you can hold on to indoors. For me, it’s Ruby.&lt;/p&gt;

&lt;p&gt;I’ll be leaving the virus issue to the virologists. We’re Rubyists, let’s talk about Ruby, shall we?&lt;/p&gt;

&lt;p&gt;The last fifteen days have passed very swiftly for me. Any day now, I hope to wake up and read a news headline: “Virus conquered, Everyone Go Out and Play!” (That’d be a horrible headline if I were a journalist). I’ve spent 99.8% of all this time indoors reading and learning, mostly about Ruby and astrophysics. To keep me from going insane, I decided to build something.&lt;/p&gt;

&lt;h2 id=&quot;what-i-built&quot;&gt;What I Built&lt;/h2&gt;

&lt;p&gt;I built a &lt;strong&gt;command-line interface (CLI)&lt;/strong&gt;. To me, this sort of stuff takes more time than if I were to build a web app. If anything can occupy my time, I’d beg for it at this time. Of course, I’d want to use my time meaningfully.&lt;/p&gt;

&lt;p&gt;It was supposed to be a straightforward CLI app, 500 lines of code maximum, and it was during this process that I learned first hand that the complexity of building software increases exponentially with time and added features. If you create two conditions and they have branches, and those branches happen to have more branches, you’re in a for a treat.&lt;/p&gt;

&lt;p&gt;Currently, the CLI that was meant to be a simple one has about 2500 lines of code, and it’s not even halfway through what I envisioned. That’s good because it means I get to learn even more about Ruby while:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Building something “useful”.&lt;/li&gt;
  &lt;li&gt;Not getting bored and going crazy.&lt;/li&gt;
  &lt;li&gt;Keeping my mind off the current situation.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I named the CLI &lt;a href=&quot;https://github.com/siaw23/kovid&quot;&gt;kovid&lt;/a&gt;. So much for creativity. You should bear with me on this one if you know the hard problems of computer science.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;center&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;There are 2 hard problems in computer science: cache invalidation, naming things, and off-by-1 errors.&lt;/p&gt;&amp;mdash; Leon Bambrick (@secretGeek) &lt;a href=&quot;https://twitter.com/secretGeek/status/7269997868?ref_src=twsrc%5Etfw&quot;&gt;January 1, 2010&lt;/a&gt;&lt;/blockquote&gt; &lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; just does one thing: it lets you filter and compare the data we have on the coronavirus. I intend to add another feature so it returns data as JSON that others can use in their apps, bringing the tally of things &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; can do to two. For now, you can fetch and compare statistics on any given country or state, or get aggregated data on entire continents. It’s an easy way to access information: it saves you the clicks, scrolls and swipes of navigating a traditional web app.&lt;/p&gt;

&lt;p&gt;With &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt;, comparing data on countries is as easy as typing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid compare poland ghana usa&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/kovid_compare.png&quot; alt=&quot;kovid comparing coronavirus statistics&quot; title=&quot;kovid comparing coronavirus statistics.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can also query individual countries with a command like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid check croatia&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/kovid_check.png&quot; alt=&quot;kovid check coronavirus statistics&quot; title=&quot;kovid check coronavirus statistics.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Because I spend a lot of time in the terminal, I think this is easier than having to leave the terminal, launching a browser and clicking around. The data comes from the &lt;a href=&quot;https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6&quot;&gt;Center for Systems Science and Engineering&lt;/a&gt; at Johns Hopkins University and &lt;a href=&quot;https://www.worldometers.info/coronavirus/&quot;&gt;worldometers.info&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;how-i-built-it&quot;&gt;How I Built It&lt;/h2&gt;

&lt;p&gt;When the thought of building a CLI sprang to mind, I started looking for free APIs that’d provide the data I needed. To my dismay, I discovered many people are making money off this crisis, potentially at the cost of human lives.  I started thinking of ways to build a free API myself. The first idea was to scrape Wikipedia, but I ruled that out when I noticed Wikipedia is rather slow at publishing data, so I got back to searching until I came across &lt;a href=&quot;https://github.com/disease-sh/API&quot;&gt;disease.sh&lt;/a&gt;. A group of awesome developers had already noticed the problem and built a scraper for data from &lt;a href=&quot;https://www.worldometers.info/coronavirus/&quot;&gt;worldometers.info&lt;/a&gt; and Johns Hopkins University.&lt;/p&gt;

&lt;p&gt;Let’s get building!&lt;/p&gt;

&lt;p&gt;I grabbed a few gems that I’m already used to, like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terminal-table&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;thor&lt;/code&gt;, to start with. I wanted then to cache requests and started looking for caching solutions for a CLI. &lt;a href=&quot;https://github.com/havenwood&quot;&gt;Shannon Skipper&lt;/a&gt;, my Ruby Jedi,  from whom I’ve learned a lot over the years, then recommended &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;typhoeus&lt;/code&gt;. I looked it up and decided it’s a good pick, so I went for it.&lt;/p&gt;

&lt;p&gt;Primarily, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; is built by connecting these tools and navigating NovelCOVID/API to mould the data I need out of it. There isn’t much to it. The process of building the CLI, the little hurdles and the joy of working with Ruby and passing the time, is what mattered to me the most. I’m still building on top of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; and enjoying the ride with new knowledge and tricks. This process keeps me sane as much as it is rewarding and relaxing at the same time.&lt;/p&gt;

&lt;p&gt;The code is available &lt;a href=&quot;https://github.com/siaw23/kovid&quot;&gt;on GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;what-i-learned&quot;&gt;What I Learned&lt;/h2&gt;

&lt;p&gt;The plot twist of building a seemingly useless CLI is not the product itself. It’s learning, passing time meaningfully. For such a tiny CLI. I’ve learned a lot through Shannon and another Ruby Jedi, &lt;a href=&quot;https://github.com/gr33n7007h&quot;&gt;Lee&lt;/a&gt;. The funny thing about learning, not just about Ruby but any subject, is: the more you learn, the more you realise how much you don’t know.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;As our island of knowledge grows, so does the shore of our ignorance.&lt;/p&gt;

  &lt;p&gt;– John Archibald Wheeler&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;For this reason, I try to stay very humble to the point that sometimes, people perceive this as stupidity. Playing with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; has taught me countless things. I’ll list a few.&lt;/p&gt;

&lt;h3 id=&quot;hashmerge-only-accepts-multiple-args-in-ruby-260&quot;&gt;Hash#merge only accepts multiple args in Ruby &amp;gt;=2.6.0.&lt;/h3&gt;

&lt;p&gt;If you’re merging a hash you’d expect something like this to work:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;country_array&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;sx&quot;&gt;%w[country countryInfo]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;include?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;compact&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It does indeed work, but only if you’re using a &lt;a href=&quot;https://rubylatestversion.com/&quot;&gt;Ruby version&lt;/a&gt;  &amp;gt;=2.6.0. Any Ruby version below 2.6.0 would result in &lt;a href=&quot;https://github.com/siaw23/kovid/issues/77&quot;&gt;complaints&lt;/a&gt; because it wasn’t until Ruby 2.6.0 that Hash#merge got support for multiple arguments.&lt;/p&gt;

&lt;p&gt;There were multiple fixes for this. One was to use the &lt;a href=&quot;https://github.com/marcandre/backports&quot;&gt;backports&lt;/a&gt; gem, but grabbing a whole gem for this would be silly. In the end, we reached for a more sensible solution to rewrite the above as:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;country_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;inject&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;sx&quot;&gt;%w[country countryInfo]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;include?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;compact&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hacking-codepoints-to-create-flag-emoji&quot;&gt;Hacking codepoints to create flag emoji.&lt;/h3&gt;

&lt;p&gt;If you look at the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; screenshots above, you’ll notice they have flags attached to the countries. My initial idea on adding emoji to a terminal table was to build a gem that, given an &lt;a href=&quot;https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2&quot;&gt;ISO 3166-1 alpha-2&lt;/a&gt; code, would spit out a flag emoji – This is somewhat naive but naive only if you &lt;i&gt;know&lt;/i&gt; of a better solution.&lt;/p&gt;

&lt;p&gt;Back in the day, I discovered that flag emoji used “two-letter” ISO alpha-2 codes of the country they represented. I never thought about how these grapheme clusters could be programmatically manipulated to produce the flags that I wanted, though.&lt;/p&gt;

&lt;p&gt;To see the individual graphemes you could do&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;'🇭🇹'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;codepoints&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;codepoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;codepoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;chr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'utf-8'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which returns&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;🇭&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;🇹&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and to get the codepoints of this same flag &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'🇭🇹'.codepoints&lt;/code&gt; would be enough to return &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[127469, 127481]&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;With this new-found knowledge, let’s see how we can easily exploit Unicode, so we don’t have to create a gem that just spits out flag emoji.&lt;/p&gt;

&lt;p&gt;Here’s a method that does that:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;COUNTRY_LETTERS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'A'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;upto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Z'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;with_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127_462&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;freeze&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;country_emoji&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;COUNTRY_LETTERS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;values_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'U*'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Step-by-step, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;COUNTRY_LETTERS&lt;/code&gt; constants maps values of ASCII &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; starting with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;127_462&lt;/code&gt; through to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Z&lt;/code&gt;. The returned hash looks like this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127462&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127463&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127464&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;D&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127465&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;E&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127466&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;F&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127467&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;G&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127468&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;H&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127469&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;I&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127470&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;J&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127471&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;K&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127472&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;L&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127473&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;M&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127474&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127475&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;O&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127476&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;P&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127477&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Q&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127478&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;R&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127479&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;S&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127480&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;T&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127481&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;U&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127482&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;V&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127483&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;W&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127484&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;X&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127485&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Y&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127486&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Z&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;127487&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The values are the codepoints of the graphemes that we’ll combine (pack) to get our emoji flag. So for this method, given a string of say &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;GH&quot;&lt;/code&gt;, it’d split the string into an array and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#pack&lt;/code&gt; them into a binary sequence with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U*&lt;/code&gt; directive. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U*&lt;/code&gt; directive means “UTF-8 character”.&lt;/p&gt;

&lt;p&gt;With this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p country_emoji(&quot;PL&quot;)&lt;/code&gt; would return &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;🇵🇱&lt;/code&gt;. Nifty right?&lt;/p&gt;

&lt;h3 id=&quot;zero-width-space-zwsp&quot;&gt;Zero-width space (ZWSP).&lt;/h3&gt;

&lt;p&gt;Take a peek at the screenshot of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; above and compare that to this screenshot:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/kovid_check_zero_width.png&quot; alt=&quot;kovid zero-width space&quot; title=&quot;kovid zero-width space.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You might notice that the flag emoji huddles against the text and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;|&lt;/code&gt; character at the end on that row draws in. It appears the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terminal-table&lt;/code&gt; gem only cares about ASCII characters. There was no easy way to fix this unless the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;country_emoji(iso)&lt;/code&gt; method is rewritten as:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;country_emoji&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;COUNTRY_LETTERS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;values_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'U*'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;8203&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;UTF_8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;8203.chr(Encoding::UTF_8)&lt;/code&gt; adds a zero-width space.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The zero-width space is a code point (a number) in a character set, that does not represent a written symbol used in computerised typesetting to indicate word boundaries to text processing systems when using scripts that do not use explicit spacing.&lt;/p&gt;

  &lt;p&gt;They are used as in-band signalling to cause effects other than the addition of a symbol to the text.&lt;/p&gt;

  &lt;p&gt;– Wikipedia&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There are a few of them: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[8203, 8204, 8205, 8288, 65279]&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;hashreject-returns-nil-when-it-rejects-nothing&quot;&gt;Hash#reject! returns &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; when it rejects nothing.&lt;/h3&gt;

&lt;p&gt;In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt; the command to check historical data looks like this: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid history usa&lt;/code&gt;. The corresponding code is:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;stats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;dates&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'timeline'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'cases'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'timeline'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'cases'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;keys&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;stats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;reject!&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zero?&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zero?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;dates&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I would run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid history usa&lt;/code&gt; and get &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;undefined method 'count' for nil:NilClass (NoMethodError)&lt;/code&gt; without immediately knowing why because &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;binding.irb&lt;/code&gt; told me &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stats&lt;/code&gt; defined earlier is not &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt;. How is it &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;unless&lt;/code&gt; block then? I  pushed this aside to work on other features, until &lt;a href=&quot;https://github.com/siaw23/kovid/commit/3a8f84411e885de91a8a2134961ef766ed64a91b&quot;&gt;a PR came in from a contributor&lt;/a&gt;. When I saw that, I went to the documentation only to find:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;reject!() public&lt;/p&gt;

  &lt;p&gt;Equivalent to #delete_if, but returns nil if no changes were made.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Why did I think a banged method on an Enumerable worked like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Array#map!&lt;/code&gt;? This made me more attentive when it comes to Ruby methods with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;!&lt;/code&gt;. It’s unsafe to assume that a method you’re used to behaves similarly to another method that works on an Enumerable.&lt;/p&gt;

&lt;h3 id=&quot;adiós-bindingpry-hola-bindingirb&quot;&gt;Adiós &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;binding.pry&lt;/code&gt;. Hola &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;binding.irb&lt;/code&gt;.&lt;/h3&gt;

&lt;p&gt;Ruby 2.4.0 introduced &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;binding.irb&lt;/code&gt; – This is an excellent addition. While I’m very appreciative of Pry, I must say, the added hassle of having to install something extra and require it sometimes gets in the way. With Ruby versions higher than 2.4.0, you can add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;binding.irb&lt;/code&gt; anywhere without additional steps to debug your code. This, though seemingly small, is a boost to productivity. While building &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kovid&lt;/code&gt;, I added &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;binding.irb&lt;/code&gt; to my toolchain, and that’s what I’ll be using henceforth.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;We don’t know how long this pandemic will last, or when a vaccine will come out to help us fight it, there isn’t much we can do other than follow procedures and be extra vigilant about hygiene. I only hope this doesn’t last as long as previous pandemics, and that we can succeed in flattening the curve.&lt;/p&gt;

&lt;p&gt;I don’t know about you, but for me, this situation is more than depressing. I’m happy I have Ruby. I find solace in Ruby. Building toy applications takes my mind off the devastation we’re experiencing in these times. Whatever you find relief in, stick to it as long as it’s a safe routine. I’m sure, like with all other adversities that humanity has suffered, this too shall pass.&lt;/p&gt;

&lt;p&gt;#StayHome. Stay safe.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="personal"/>
      
        <category term="ruby"/>
      

      
        <summary type="html"/>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">How I Learned To Code Elixir &amp;amp; Phoenix In 24 Hours.</title>
      
      
      <link href="https://manny.codes/how-to-program-elixir-phoenix-in-a-day/" rel="alternate" type="text/html" title="How I Learned To Code Elixir &amp; Phoenix In 24 Hours.">
      
      <published>2020-03-11T14:45:00+00:00</published>
      <updated>2022-08-24T20:07:52+00:00</updated>
      <id>https://manny.codes/how-to-program-elixir-phoenix-in-a-day</id>
      <content type="html" xml:base="https://manny.codes/how-to-program-elixir-phoenix-in-a-day/">&lt;p&gt;&lt;i&gt;Caveat: I already had years of programming experience and took functional programming (OCaml and Scala) courses at the university. Conceptually, I knew a lot already about server-client communications.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;“Wait, what?!”. “Aaah! I get it!”. “WTF?!?”. “I don’t get this.”&lt;/p&gt;

&lt;p&gt;These were my thoughts when I was reading Elixir’s &lt;a href=&quot;https://elixir-lang.org/getting-started/introduction.html&quot;&gt;Getting Started Guide&lt;/a&gt; some years back. Seeing the last chapter of those guides has been nothing but a dream to this day. I did though, get a glimpse of what Elixir is about.&lt;/p&gt;

&lt;p&gt;Elixir is this functional and concurrent programming language that runs on the Erlang virtual machine (BEAM). It was released in 2011 as an R&amp;amp;D project of Plataformatec (for years, I read this as Platformatec!) by José Valim.&lt;/p&gt;

&lt;p&gt;From an object-oriented programming(OOP) point of view, it’s fancy, yet powerful! While everything in Ruby is an object, in Elixir, everything is an expression, how about that.&lt;/p&gt;

&lt;p&gt;Somewhere deep inside me, I knew I wanted to dive deep into this new thing and never resurface.&lt;/p&gt;

&lt;p&gt;Procrastination got the best of me.&lt;/p&gt;

&lt;p&gt;Here’s the story of how I learned to code to code Elixir and Phoenix:&lt;/p&gt;

&lt;h2 id=&quot;induced-motivation-to-learn-to-code&quot;&gt;Induced Motivation To Learn To Code&lt;/h2&gt;

&lt;p&gt;For some time now I’ve been looking for my next Ruby on Rails project to work on, Twitter was the last place I posted to announce I’m looking for a Rails job.&lt;/p&gt;

&lt;p&gt;I’ve had a few interviews but not the right match yet, which means I had all the time in the world to myself.&lt;/p&gt;

&lt;p&gt;I have a good Ruby friend, &lt;a href=&quot;https://www.wintermeyer-consulting.de/&quot;&gt;Stefan Wintermeyer&lt;/a&gt;, who since last year, has been trying to proselytize me into the Elixir ecosystem. Stefan is a Ruby, Elixir, Rails, Phoenix Framework, Asterisk, web performance expert. He’s like a swiss-army knife of web apps with lots of experience so when he first proposed this, I had even more reasons to consider learning Elixir.&lt;/p&gt;

&lt;p&gt;When Stefan retweeted my Twitter job post, I wrote back to thank him and he replied:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;You are more than welcome. Please think about learning Elixir and Phoenix while waiting for a Rails job.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The premise was that Stefan would allow me to work on one of his Elixir/Phoenix projects.&lt;/p&gt;

&lt;p&gt;“OK! This is it. The time has come!”, I said to myself.&lt;/p&gt;

&lt;p&gt;So I replied:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;OK please give me up to 3 weeks and I’ll get back to you with what I know about Phoenix!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;a-safe-paradigm-shift-with-mindfulness&quot;&gt;A Safe Paradigm Shift with Mindfulness&lt;/h2&gt;

&lt;p&gt;I knowingly jumped into uncharted waters when I told Stefan to give me 3 weeks to get back to him. Learning a new programming language and a new framework for that matter in three weeks seemed like a herculean task.&lt;/p&gt;

&lt;p&gt;Elixir is a functional programming language, not close to anything I’m used to.&lt;/p&gt;

&lt;p&gt;As the vagabond mindfulness practitioner that I am, I resorted once again to meditation expecting an arduous cerebral escapade with Elixir and Phoenix.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Mindfulness is the psychological process of purposely bringing one’s attention to experiences occurring in the present moment without judgment.&lt;/p&gt;

  &lt;p&gt;– &lt;cite&gt;Wikipedia&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;With a paradigm shift this huge, it’ll be hard to maintain focus. While reading some Elixir documentation, my mind would always keep analysing and comparing what I was reading with an OOP programmer’s mindset. This was detrimental and not what I wanted.&lt;/p&gt;

&lt;p&gt;Mindfulness is what would spearhead me into a &lt;a href=&quot;https://en.wikipedia.org/wiki/Flow_(psychology)&quot;&gt;flow state&lt;/a&gt;. Practising mindfulness has countless benefits to our mental well-being.  It empowers you to dump past and future thoughts and focus on the &lt;i&gt;present&lt;/i&gt;.&lt;/p&gt;

&lt;p&gt;Every so often, I practice it depending on what I’m dealing with at that given moment.&lt;/p&gt;

&lt;p&gt;Having previously gone through some of Elixir’s documentation, there was still a bunch of things I remembered even if I didn’t know how they worked then. I then jumped onto &lt;a href=&quot;https://elixirschool.com/en/&quot;&gt;Elixir School&lt;/a&gt;, which I recommend as a first access point to Elixir. Going through Elixir School gave me enough knowledge of the language to pick a book on Phoenix.&lt;/p&gt;

&lt;p&gt;So I got a Phoenix book.&lt;/p&gt;

&lt;p&gt;I was very mindful in every step with the Phoenix book I was reading, unperturbed by OOP, classes, messages, inheritance, everything I had learned in the past, how I’ll adapt to “functional” thinking in the future and things happening in my environment.&lt;/p&gt;

&lt;p&gt;I’d read my book and anytime my mind wandered, I was quick to notice that I had derailed and gently got myself back on track to what mattered at &lt;i&gt;that&lt;/i&gt; given moment; learning Elixir and Phoenix.&lt;/p&gt;

&lt;p&gt;By the way, the book in question to which I coded along is &lt;a href=&quot;https://www.manning.com/books/phoenix-in-action&quot;&gt;Phoenix in Action&lt;/a&gt; by Geoffrey Lessel. I was lucky enough to get this book for free from Geoffrey himself. And to be honest, it’s the best introduction to a framework I’ve ever read. Think Michael Hartl’s Rails Tutorial, but on steroids. It teaches the very best of practices with Phoenix and shows you all the stuff you need to understand in the most vivid and fun way possible.&lt;/p&gt;

&lt;p&gt;While coding along I made sure to keep &lt;a href=&quot;https://github.com/siaw23/dbay/commits/master&quot;&gt;frequent commits&lt;/a&gt;, perhaps it may help you follow along in case you buy the book. You could also just go through my commits. Since they’re chronological, you’ll get a feel of how the process of building apps with Phoenix is like.&lt;/p&gt;

&lt;p&gt;Chapter after chapter, I was able to grasp the wirings of not only Elixir apps but how Phoenix works. And tell you what, I can’t get enough of it!&lt;/p&gt;

&lt;h2 id=&quot;falling-in-love-again&quot;&gt;Falling In Love Again&lt;/h2&gt;

&lt;p&gt;The pros of Elixir are a cliché now. I’ll not mention them here. Coming from Ruby on Rails, I noticed Phoenix has some nifty goodies.&lt;/p&gt;

&lt;p&gt;A few caught my attention. One of them is the idea of &lt;a href=&quot;https://hexdocs.pm/phoenix/plug.html&quot;&gt;Plugs&lt;/a&gt;. Plugs are behaviours that accept a connection request. Phoenix is full of plugs in layers, requests go through them and get transformed along the way. This is a very smart idea if you think about it. With an &lt;a href=&quot;https://hexdocs.pm/phoenix/Phoenix.Endpoint.html&quot;&gt;Endpoint&lt;/a&gt; being where all requests start, you can insert plugs anywhere along the chain of other plugs to modify or access data. In plugs, you can set cookies, implement authentication and run functions before controller actions among other things as the request runs through the chain of endpoints. You have full control of where, how and what to do along which part of the request cycle you want. Ingenious!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/phoenix_plugs.png&quot; alt=&quot;Phoenix Plugs&quot; title=&quot;Phoenix Plugs&quot; /&gt;&lt;em&gt;Phoenix in Action, Geoffrey Lessel&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Phoenix’s architecture is very clean and explicit. The pattern is comparable to Hanami’s, except that &lt;a href=&quot;https://hanamirb.org/&quot;&gt;Hanami&lt;/a&gt; is built with an OOP language. It sets very clear and strict boundaries between domains, your entities are loosely-coupled.&lt;/p&gt;

&lt;p&gt;Phoenix stays out of the way of your application. You can imagine Phoenix as being an extension or plugin to your application. It’s &lt;strong&gt;not&lt;/strong&gt; your application, it’s a &lt;i&gt;part&lt;/i&gt; of your application.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/phoenix_as_a_pluggable_component_to_app.png&quot; alt=&quot;Phoenix is not your application!&quot; title=&quot;Phoenix is not your application!&quot; /&gt;&lt;em&gt;Phoenix in Action, Geoffrey Lessel&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The framework is fast! I’ve dabbled with lots of frameworks and in the context of building applications, I’ve never seen a request take microseconds(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;μs&lt;/code&gt;) to complete! When I saw this in my console, I was like: “Wait a minute. What the heck is that?!”. It’s speed guys. Most people will probably never need this much swiftness but it’s nice to know it’s there if/when you’ll need it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/elixir_speed.png&quot; alt=&quot;How I learned to program Elixir &amp;amp; Phoenix&quot; title=&quot;How I learned to program Elixir &amp;amp; Phoenix.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Changesets! Oh my! The changeset concept, if you have a background like me, at first, sounds weird and complicated. With changesets, it’s very simple to manipulate data you send to the database. Changesets allow filtering, casting, validation and definition of constraints when manipulating structs. Here let’s assume structs are our data models. Here’s an example of a changeset from Ecto’s (Ecto is the database wrapper and query generator for Elixir, it’s what Phoenix uses by default) documentation:&lt;/p&gt;

&lt;div class=&quot;language-elixir highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;defmodule&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;kn&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Ecto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Schema&lt;/span&gt;
  &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Ecto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Changeset&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;users&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;field&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:integer&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# Info above left for context.&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changeset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;\\&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;%{})&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validate_required&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validate_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;~r/@/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validate_inclusion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unique_constraint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cast&lt;/code&gt; here is a filter of what data should come through with a request. Any other thing not listed will be rejected. The cool thing with changesets is when you pass something to it that’s not in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cast&lt;/code&gt;, it won’t error on you, it’ll just take what’s listed and work with it and ignore the rest. How’s this not something to fall in love with. The other functions are pretty self-explanatory. Changesets spring to action when you’re inserting or manipulating data.&lt;/p&gt;

&lt;p&gt;Phoenix also comes with code reloading and a nice UI, you don’t need to configure anything! You can get very productive with Elixir and Pheonix right off the bat!&lt;/p&gt;

&lt;p&gt;I could go on and write more cool details about Phoenix but I’d rather you give Elixir and Phoenix a try yourself.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A productive web framework that does not compromise speed or maintainability.&lt;/p&gt;

  &lt;p&gt;– &lt;cite&gt;Phoenix Framework&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Take that tag line literally.&lt;/p&gt;

&lt;p&gt;The one thing I haven’t gotten used to yet though, is the fact that I have to constantly type &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iex -S mix&lt;/code&gt; to preload an app into IEx and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mix phx.server&lt;/code&gt; to start a server. These commands, among others, are so unrelated visually that I find it slightly hard to remember at will. I did, however, figure out a way to turn them into “siblings” and short enough to commit to memory to keep my productivity unhindered so I wrote about how to create an &lt;a href=&quot;https://emmanuelhayford.com/multi-worded-aliases/&quot;&gt;alias with arguments&lt;/a&gt;. The pattern I wrote about could be used for other “hard-to-remember” commands and is applicable to other activities in terminals as well.&lt;/p&gt;

&lt;h2 id=&quot;time-report&quot;&gt;Time Report&lt;/h2&gt;

&lt;p&gt;You’re probably wondering… “Did he do this in one sitting?”. There answer is “No.”. I’m human. I did this over six days with about thirty minutes into the next day. And I have a &lt;a href=&quot;/docs/elixir_phoenix_time_report.pdf&quot;&gt;detailed time report&lt;/a&gt; if you’d like to know what exactly I learned in how much time.&lt;/p&gt;

&lt;p&gt;Here’s a summarised time report:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/time_report.png&quot; alt=&quot;How I learned to program Elixir &amp;amp; Phoenix&quot; title=&quot;How I learned to program Elixir &amp;amp; Phoenix.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I spent a little over 5 hours on covering the basics at Elixir School, and even caught some tiny typos and &lt;a href=&quot;https://github.com/elixirschool/elixirschool/commits?author=siaw23&quot;&gt;submitted PRs&lt;/a&gt; to fix them. Something that’d be hard if you’re not mindful.&lt;/p&gt;

&lt;p&gt;Elixir is such a delight to work with and Phoenix’s architecture has been designed with such ingenuity that it’s easy to reason about everything and be productive. Both tools are filled with so much common sense, you’d think… “Where have I been all this while?”&lt;/p&gt;

&lt;p&gt;The teams behind both Elixir and Phoenix have done a great job!&lt;/p&gt;

&lt;h2 id=&quot;the-road-ahead&quot;&gt;The Road Ahead&lt;/h2&gt;

&lt;p&gt;Am I an Elixir/Phoenix expert? Not even close. I’ve got a long way to go. I can see myself becoming a well-versed Elixir/Phoenix developer quicker than I did with Ruby on Rails. That’s guaranteed! I can affirm that you’ll like Elixir/Phoenix if you take a small effort to study it, and you should, even if it’ll just be for fun.&lt;/p&gt;

&lt;p&gt;Apropos the future, I don’t plan on halting my relationship with my Elixir any time soon. I’m looking to build on what I already know. These are the books on my list that I want to get to next:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://pragprog.com/titles/elixir16/programming-elixir-1-6/&quot;&gt;Programming Elixir&lt;/a&gt;, Dave Thomas&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.manning.com/books/elixir-in-action-second-edition&quot;&gt;Elixir in Action&lt;/a&gt;, Saša Jurić&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pragprog.com/titles/cdc-elixir/learn-functional-programming-with-elixir/&quot;&gt;Learn Functional Programming With Elixir&lt;/a&gt;, Ulisses Almeida&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pragprog.com/titles/phoenix14/programming-phoenix-1-4/&quot;&gt;Programming Phoenix&lt;/a&gt;, Chris McCord, Bruce Tate and José Valim&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Tip&lt;/strong&gt;: Some of these books have discounts on &lt;a href=&quot;https://elixirforum.com/&quot;&gt;Elixir Forum&lt;/a&gt; and the total cost after discounts won’t break the bank.&lt;/p&gt;

&lt;p&gt;At the time of this writing, there are a few things about Phoenix I don’t know yet, namely &lt;a href=&quot;https://hexdocs.pm/phoenix/channels.html&quot;&gt;channels&lt;/a&gt;, testing and how to write APIs. Phoenix in Action already covers this.&lt;/p&gt;

&lt;p&gt;I believe I’ve pretty much covered the fundamentals of the framework. My goal is to have this covered by the end of the week and get practical with it. I want to peruse multiple print resources and get a diverse opinion from the experts.&lt;/p&gt;

&lt;p&gt;To practise, I intend going through the &lt;a href=&quot;https://exercism.io/tracks/elixir&quot;&gt;Elixir track&lt;/a&gt; on &lt;a href=&quot;https://exercism.io/&quot;&gt;Excercism&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;After going through these resources I think one will be well-equipped to venture out into the wild.&lt;/p&gt;

&lt;p&gt;Happy coding and kudos if you noticed the recursion in my lead photo!&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Emmanuel Hayford</name>
          
          
        </author>
      

      

      
        <category term="elixir"/>
      
        <category term="phoenix"/>
      
        <category term="programming"/>
      

      
        <summary type="html">Caveat: I already had years of programming experience and took functional programming (OCaml and Scala) courses at the university. Conceptually, I knew a lot already about server-client communications.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Bash &amp;amp; ZSH Alias With Arguments.</title>
      
      
      <link href="https://manny.codes/multi-worded-aliases/" rel="alternate" type="text/html" title="Bash &amp; ZSH Alias With Arguments.">
      
      <published>2020-03-08T13:57:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/multi-worded-aliases</id>
      <content type="html" xml:base="https://manny.codes/multi-worded-aliases/">&lt;p&gt;If you’re like me, your aliases have no spaces in them. They are all single-worded like these:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;gs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;git status&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;gd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;git diff &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A few days ago I started learning &lt;a href=&quot;https://emmanuelhayford.com/how-to-program-elixir-phoenix-in-a-day/&quot;&gt;Elixir and Phoenix&lt;/a&gt; and realised &lt;a href=&quot;https://www.phoenixframework.org/&quot;&gt;Phoenix&lt;/a&gt; has commands like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iex -S mix&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mix phx.server&lt;/code&gt;. Coming from Ruby on Rails, I guess I’m too used to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rails c&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rails s&lt;/code&gt; so I sought to figure out how to get multi-worded aliases.&lt;/p&gt;

&lt;h2 id=&quot;shell-functions-as-aliases&quot;&gt;Shell Functions as Aliases&lt;/h2&gt;

&lt;p&gt;If you think about it, your &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.bashrc&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.zshrc&lt;/code&gt; files are just Bash scripts. I never thought of it this way, and until today I didn’t know that &lt;a href=&quot;https://www.gnu.org/software/bash/manual/bash.html#Aliases&quot;&gt;you can define functions&lt;/a&gt; in them to &lt;i&gt;use as aliases&lt;/i&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;For almost every purpose, shell functions are preferred over aliases.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;With the new-found knowledge, this is how I set up alias equivalents of the more verbose &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iex -S mix&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mix phx.server&lt;/code&gt; commands.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;phx&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;c&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;console&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;iex &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; mix
  &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;server&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;mix phx.server
  &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;r&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;routes&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;mix phx.routes
  &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;bash-alias-with-spaces&quot;&gt;Bash Alias With Spaces&lt;/h2&gt;

&lt;p&gt;With this, you can just run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phx c&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phx console&lt;/code&gt; to load &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IEx&lt;/code&gt; preloaded with your Phoenix app. Or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phx s&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phx server&lt;/code&gt; to start your Phoenix server; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server&lt;/code&gt; being parameters to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phx()&lt;/code&gt; function.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PS:&lt;/strong&gt; You can run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source /path/to/.*rc&lt;/code&gt; to immediately use your commands without restarting your shell, where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*rc&lt;/code&gt; would be your “run commands” file (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.bashrc&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.zshrc&lt;/code&gt; or whatever).&lt;/p&gt;

&lt;p&gt;This is shorter and faster to type and remember.&lt;/p&gt;

&lt;p&gt;Happy coding!&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="productivity"/>
      
        <category term="bash"/>
      
        <category term="zsh"/>
      

      
        <summary type="html">If you’re like me, your aliases have no spaces in them. They are all single-worded like these:</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">The Point Of Pointers.</title>
      
      
      <link href="https://manny.codes/the-point-of-pointers/" rel="alternate" type="text/html" title="The Point Of Pointers.">
      
      <published>2020-02-23T09:58:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/the-point-of-pointers</id>
      <content type="html" xml:base="https://manny.codes/the-point-of-pointers/">&lt;p&gt;&lt;img src=&quot;/images/golang_pointers.jpg&quot; alt=&quot;What is a pointer in Golang?&quot; title=&quot;What is a pointer in Golang?&quot; /&gt;&lt;em&gt;Photo by Valentine Tanasovich&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;For some of us who didn’t start programming with a low high-level language (like C), the idea of “pointers” is alien. It took me a while to fully grasp what “pointers” were when I started learning Go. I understood the concept with Golang first then went back to C and C++ and realised it’s the same stuff!&lt;/p&gt;

&lt;p&gt;Here’s my attempt to demystify “pointers”. But before that, let’s talk about addresses.&lt;/p&gt;

&lt;h2 id=&quot;addresses-living-spaces-for-code-and-data&quot;&gt;Addresses: Living Spaces for Code and Data&lt;/h2&gt;
&lt;p&gt;An address is a reference to a specific memory location. Code and variables are loaded in memory for a processor to work with. For a simple computation like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a + b&lt;/code&gt; (assuming &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b&lt;/code&gt; are integers or whatever operand &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;+&lt;/code&gt; can operate on in a given language) to be possible. The processor has to know where precisely in memory they are stored so it can pick them and then ADD them; the processor has to know the &lt;strong&gt;addresses&lt;/strong&gt; of these variables.&lt;/p&gt;

&lt;h2 id=&quot;pointer-the-neighbourhood-savant&quot;&gt;Pointer: The Neighbourhood Savant&lt;/h2&gt;

&lt;p&gt;So what is a pointer? Figuratively, a pointer is like the neighbourhood greybeard. He’s the guy that knows everyone in the neighbourhood, where they live, what they do, etc. He’s the guy to go to if you want to know the address of variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;In Golang, a pointer holds the memory address of a value. That’s all it does.&lt;/p&gt;

&lt;p&gt;Here’s an example:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;fmt&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;33&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addressOfNumber&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Pointer to the `number` variable&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addressOfNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;// Prints: 0xc0000b4008&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In Go, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;&lt;/code&gt; operator generates a pointer to its operand so that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;number&lt;/code&gt; becomes a pointer to the variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;number&lt;/code&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;number&lt;/code&gt; knows that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;number&lt;/code&gt; lives at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xc0000b4008&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;var addressOfNumber *int = &amp;amp;number&lt;/code&gt; is how to declare a pointer variable. An implicit declaration would look like this: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addressOfNumber := &amp;amp;number&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;OK. So now we know that pointers hold the addresses of values in memory.&lt;/p&gt;

&lt;p&gt;Awesome!&lt;/p&gt;

&lt;h2 id=&quot;so-whats-the-point-no-pun-intended&quot;&gt;So What’s The Point? (No Pun Intended)&lt;/h2&gt;

&lt;p&gt;To illustrate the point of pointers, let’s assume you are working somewhere with a wage of $1,500. A new boss comes and asks your junior developer to write a program to double everyone’s payment! It’s all excitement for everyone; you’re elated!&lt;/p&gt;

&lt;p&gt;But your developer comes in with this and asks for a code review:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;fmt&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doubleWage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1500&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Salary in USD&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;doubleWage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking at this, what do you think your new wage will be? $1,500 or $3,000? At a glance, this looks like it’s going to double your wage to $3,000, but it doesn’t! And that’s where pointers come in.&lt;/p&gt;

&lt;h2 id=&quot;why-we-didnt-get-our-pay-raise&quot;&gt;Why We Didn’t Get Our Pay Raise&lt;/h2&gt;

&lt;p&gt;Our wage from the previous program stayed that same, $1,500. This is because Golang is a pass-by-value language. Pass-by-value is an evaluation strategy, and according to Wikipedia:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;In pass by value, the argument expression is evaluated, and the resulting value is bound to the corresponding variable in the function (frequently by copying the value into a new memory region). If the function or procedure can assign values to its parameters, only its local variable is assigned. That is, anything passed into a function call is unchanged in the caller’s scope when the function returns.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So this is what’s happening in our program above:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1500&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Original value of `wage`&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;doubleWage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;// COPY `wage`&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;// Print original value of `wage`&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doubleWage(wage)&lt;/code&gt; does its job of double the wage but we do nothing with that doubled value!&lt;/p&gt;

&lt;h2 id=&quot;the-fight-for-a-raise&quot;&gt;The Fight for A Raise&lt;/h2&gt;

&lt;p&gt;There’s a particular operator we haven’t mentioned… &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*&lt;/code&gt;. When we use it with a pointer, instead of getting an address of some value, we get a value itself.&lt;/p&gt;

&lt;p&gt;From this:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;33&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addressOfNumber&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Pointer to the `number` variable&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We know that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addressOfNumber&lt;/code&gt; is a pointer (returns the address of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;number&lt;/code&gt;), if we did &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*addressOfNumber&lt;/code&gt; we’d get &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;33&lt;/code&gt;, the value itself. We can go ahead and do something like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*addressOfNumber = 55&lt;/code&gt;, and this will set the value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;number&lt;/code&gt; to 55; we call this “dereferencing”.&lt;/p&gt;

&lt;p&gt;With the newfound knowledge here’s how we can fix our original program to get the pay raise we deserve:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;fmt&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doubleWage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1500&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;// Salary in USD&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;doubleWage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Println&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;// Prints 3000!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We’ve made our &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doubleWage&lt;/code&gt; accept a pointer as a parameter and modified whatever the pointer points to with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*wage *= 2&lt;/code&gt;. Now to use it, since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doubleWage&lt;/code&gt; points to an address we have to pass an address to it with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;wage&lt;/code&gt;, and that’s all it takes.&lt;/p&gt;

&lt;p&gt;Pointers allow us to jump scope, and this, ladies and gentlemen, is the point of pointers.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="golang"/>
      
        <category term="programming"/>
      

      
        <summary type="html">Photo by Valentine Tanasovich</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Linking A Webcam Directly To Rails’ ActiveStorage.</title>
      
      
      <link href="https://manny.codes/linking-a-webcam-directly-to-rails-activestorage/" rel="alternate" type="text/html" title="Linking A Webcam Directly To Rails' ActiveStorage.">
      
      <published>2020-02-15T18:26:00+00:00</published>
      <updated>2022-02-24T06:44:14+00:00</updated>
      <id>https://manny.codes/linking-a-webcam-directly-to-rails-activestorage</id>
      <content type="html" xml:base="https://manny.codes/linking-a-webcam-directly-to-rails-activestorage/">&lt;p&gt;&lt;img src=&quot;/images/rails_active_storage_webcam.jpg&quot; alt=&quot;Linking a Webcam Directly to Rails' ActiveStorage&quot; title=&quot;How to directly upload images to Rails' ActiveStorage from a webcam.&quot; /&gt;&lt;em&gt;Photo by Laura Boccola&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;ActiveStorage is awesome. For all the times I’ve seen it being used, it was for direct file uploads where the user clicks a file field, a window pops up, and a file is selected–nothing new.&lt;/p&gt;

&lt;p&gt;Not long ago, my team tasked with developing a feature to allow users to upload pictures, not from the traditional sense that we already know but from the webcam – this was novel.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; I have built a &lt;a href=&quot;https://camera2active-storage.herokuapp.com/&quot;&gt;working version of this here&lt;/a&gt; and also &lt;a href=&quot;https://github.com/siaw23/camera2active_storage&quot;&gt;posted the code&lt;/a&gt; on GitHub for your perusal.&lt;/p&gt;

&lt;h2 id=&quot;getting-the-frontend-sorted-out&quot;&gt;Getting the Frontend Sorted Out&lt;/h2&gt;

&lt;p&gt;First, we need access to the user’s webcam. We can achieve this with JavaScript through the  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;navigator.mediaDevices&lt;/code&gt; API. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;navigator.mediaDevices&lt;/code&gt; read-only property returns a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MediaDevices&lt;/code&gt; object, which provides access to connected media input devices like cameras and microphones.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;video&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;navigator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mediaDevices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getUserMedia&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;constraints&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;video&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;srcObject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;stream&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This streams a live feed from the webcam. But we want pictures, to do this we set a canvas up and draw the content of the stream on it, this could be at any time, to capture just a frame. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HTMLCanvasElement&lt;/code&gt; provides a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toDataURL()&lt;/code&gt; method which returns a data URL containing a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base64&lt;/code&gt; encoded representation of the image which we’ll get to in a bit.&lt;/p&gt;

&lt;p&gt;The data URL that we get from the stream is a very long string. Initially, when I was thinking of how to implement this, I thought it’d be OK to submit strings through params but quickly retracted this idea! Reason being that different web servers may have a maximum allowed size of the client request body set by default. In such cases, if we sent a data URL that happens to be too big, we might get a response status code of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;413 Payload Too Large&lt;/code&gt; which browsers may not be able to display correctly.&lt;/p&gt;

&lt;p&gt;A hidden field, on the other hand, allows sending of data that cannot be seen or modified by users when a form is submitted, plus an added advantage of having no technical limit (the perfect option for a very long data URL) in browsers. For these reasons, it’s safe to send the data URL through a hidden field on the form to the controller like this:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;%= form.hidden_field :player_picture, value: @player.player_picture %&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If for some reason, you’re paranoid about security and what can come through the hidden field, on the backend you can always filter what gets pushed through, after all, it’s the internet where all sorts of weirdos cohabitate with us.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;player_picture&lt;/code&gt; would be a virtual attribute on the model since we’re not interested in making this persistent but need something to hold the data URL for the image taken from our webcam so we can pass it on to ActiveStorage. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;player_picture&lt;/code&gt; has to be accepted in the params inside the controller.&lt;/p&gt;

&lt;p&gt;For the frontend, I have set up everything in &lt;a href=&quot;https://github.com/siaw23/camera2active_storage/blob/master/app/javascript/camera/webcam.js&quot;&gt;webcam.js&lt;/a&gt;. One other important thing worth noting is after getting access to the webcam, we then need to draw a frame from the stream to the canvas, which happens with the following code:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;snapButton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;snapButton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onclick&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// snip!&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;2d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;video&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dataUrl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;canvas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toDataURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;image/jpeg&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;shot&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dataUrl&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;hiddenPlayerPicture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dataUrl&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// snip!&lt;/span&gt;

    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The relevant part in the code above is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hiddenPlayerPicture.value = dataUrl&lt;/code&gt; where we set the value of the hidden field to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dataUrl&lt;/code&gt; which is the data URL of the frame we grabbed from the webcam stream.&lt;/p&gt;

&lt;h2 id=&quot;attaching-webcam-images-to-activestorage&quot;&gt;Attaching Webcam Images to ActiveStorage&lt;/h2&gt;
&lt;p&gt;I haven’t made mention of &lt;a href=&quot;https://edgeguides.rubyonrails.org/active_storage_overview.html&quot;&gt;setting up Rails ActiveStorage&lt;/a&gt; because I assume this &lt;a href=&quot;https://github.com/siaw23/camera2active_storage/blob/master/app/models/player.rb#L6&quot;&gt;has been done already&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In our model, we can set the virtual attribute I mentioned earlier like so:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# /app/models/player.rb&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;attribute&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:player_picture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;default: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and then have the controller accept it:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# /app/controllers/players_controller.rb&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;player_params&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:player&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;permit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
     &lt;span class=&quot;c1&quot;&gt;# other params&lt;/span&gt;
     &lt;span class=&quot;ss&quot;&gt;:player_picture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now that we have the captured frame coming in through the form to the controller, we can attach that data to ActiveStorage. For our use case here we’re only interested in attaching an image to a Player through the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update&lt;/code&gt; action. Now would be a good time to &lt;a href=&quot;https://github.com/siaw23/camera2active_storage/blob/master/app/services/picture_attachment_service.rb&quot;&gt;abstract this functionality to a service&lt;/a&gt; which looks like this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# /app/services/picture_attachment_service.rb&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PictureAttachmentService&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;base_64_image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;gsub!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/^data:.*,/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;decoded_image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;decode64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base_64_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;io: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;StringIO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoded_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;filename: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;player_picture_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique_string&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.jpeg&quot;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;kp&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;unique_string&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;SecureRandom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;urlsafe_base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The code above is the crux of the picture attachment to ActiveStorage. A handful of things are happening here. Remember the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base64&lt;/code&gt; encoded representation of the image we mentioned above that comes from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toDataURL()&lt;/code&gt; which takes this form?&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data:[&amp;lt;mediatype&amp;gt;][;base64],&amp;lt;data&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;There are fours parts to this; a prefix (data:), a MIME type indicating the type of data, an optional base64 token if the data is non-textual, and the data itself.&lt;/p&gt;

&lt;p&gt;An example of such representation is:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICA...42vYWS34f/9k=&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;We just want the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;data&amp;gt;&lt;/code&gt; part of this and that’s what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base_64_image = picture.gsub!(/^data:.*,/, '')&lt;/code&gt; does for us. Then since it’s encoded, we need to decode it with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;decoded_image = Base64.decode64(base_64_image)&lt;/code&gt;. This gives us a decoded string that we can work with.&lt;/p&gt;

&lt;p&gt;One thing I love about ActiveStorage is the fact that it allows us to &lt;a href=&quot;https://edgeguides.rubyonrails.org/active_storage_overview.html#attaching-file-io-objects&quot;&gt;attach IO objects&lt;/a&gt;. An example provided by Rails Guides looks like this:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@message.image.attach(io: File.open('/path/to/file'), filename: 'file.pdf')&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Luckily for us, we can have a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;StringIO&lt;/code&gt; which in our case is the decoded &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base64&lt;/code&gt; data. That’s it. We’ve successfully built the parts that we can connect to attach a frame from a stream (picture) from a webcam.&lt;/p&gt;

&lt;p&gt;Wait. Not so fast.&lt;/p&gt;

&lt;p&gt;We forgot to call this service in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update&lt;/code&gt; action of our controller.&lt;/p&gt;

&lt;p&gt;This is how our &lt;a href=&quot;https://github.com/siaw23/camera2active_storage/blob/master/app/controllers/players_controller.rb#L44&quot;&gt;controller should look like now&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# /app/controllers/players_controller.rb&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;PictureAttachmentService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@player&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'player'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'player_picture'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;respond_to&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# some stuff&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;OK, now we’re done.&lt;/p&gt;

&lt;h2 id=&quot;attaching-webcam-videos-to-activestorage&quot;&gt;Attaching Webcam Videos to ActiveStorage&lt;/h2&gt;

&lt;p&gt;The process for attaching a webcam video is similar to the one done for images. Except, in this case, there’ll be some more work. But the most important thing to remember here is after setting up the UI with play, pause controls, we can get a video of MIME type &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;video/webm&lt;/code&gt; through the very same &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;navigator.mediaDevices&lt;/code&gt; we used earlier. But bear in mind that if the MIME type for the video is not set correctly on the server, the video may not show or show a grey box containing an X (if JavaScript is enabled). I don’t think though, that there would be an issue with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;video/webm&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;MDN Web Docs has an excellent tutorial on how to get the UI right with &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API/Recording_a_media_element&quot;&gt;video recording&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Once the UI bits are in place, all it takes is to display the video in your view with something like this:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;video&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;500&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;300&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;autoplay&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;loop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;%= url_for(@player.video) %&amp;gt;&quot;&lt;/span&gt;
     &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;video/webm&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/video&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@player.video&lt;/code&gt; is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;video/webm&lt;/code&gt; you’d get from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;navigator.mediaDevices&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We can edit our service to look like this accordingly:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;VideoAttachmentService&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;video_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;picture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;io: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;video_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;ss&quot;&gt;filename: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;player_video_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique_string&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.webm&quot;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;kp&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;unique_string&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;SecureRandom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;urlsafe_base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are a few things we could have talked about; error handling in case something goes wrong with our attachment service. Setting up a background job for the service with Sidekiq or Resque, security, refactoring, web server limits, tests among others but those are beyond the scope of this post. We have implemented the primary feature. Everything works, everyone is happy.&lt;/p&gt;

&lt;p&gt;I believe ActiveStorage is capable of a lot more; one example is &lt;a href=&quot;https://api.rubyonrails.org/classes/ActiveStorage/Analyzer/VideoAnalyzer.html&quot;&gt;analyzing videos&lt;/a&gt; – this is a lot to appreciate.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="rails"/>
      
        <category term="javascript"/>
      

      
        <summary type="html">Photo by Laura Boccola</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">RSpec Tutorial: 7 Ways To Run Specific RSpec Tests.</title>
      
      
      <link href="https://manny.codes/7-ways-to-selectively-run-rspec-tests/" rel="alternate" type="text/html" title="RSpec Tutorial: 7 Ways To Run Specific RSpec Tests.">
      
      <published>2019-08-01T17:19:00+00:00</published>
      <updated>2022-10-11T22:29:32+00:00</updated>
      <id>https://manny.codes/7-ways-to-selectively-run-rspec-tests</id>
      <content type="html" xml:base="https://manny.codes/7-ways-to-selectively-run-rspec-tests/">&lt;p&gt;The most common way to run tests in a project is to run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec&lt;/code&gt; in the terminal. This runs tests for all examples in the project. Sometimes, this is not what we want.&lt;/p&gt;

&lt;p&gt;During development, we don’t want to run the whole test suite every time after a change. Most of us want to run only tests related to changes we’ve made to save time.&lt;/p&gt;

&lt;p&gt;If you’re new to RSpec, here’s &lt;a href=&quot;https://manny.codes/rspec-tutorial-a-quick-introduction-to-testing-with-rspec/&quot;&gt;a quick introduction to testing with RSpec.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We can run specific RSpec tests by:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-file--directory-names&quot;&gt;File &amp;amp; Directory Names&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#2-sections-of-an-example-group&quot;&gt;Sections Of An Example Group&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#3-the-description-of-an-example&quot;&gt;The Description Of An Example&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#4-focusing-on-an-example&quot;&gt;Focusing On An Example&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#5-running-only-failing-tests&quot;&gt; Running Only Failing Tests&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#6-running-failing-tests-one-at-a-time&quot;&gt;Running Failing Tests One-At-A-Time&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#7-tag-filtering&quot;&gt;Tag Filtering&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;1-file--directory-names&quot;&gt;1. File &amp;amp; Directory Names&lt;/h2&gt;

&lt;p&gt;Running tests by their file or directory names is the most familiar way to run tests with RSpec. RSpec can take a single file name or directory name and run the file or the contents of the directory.&lt;/p&gt;

&lt;h3 id=&quot;how-to-run-a-single-rspec-test-file&quot;&gt;How to run a single RSpec test file&lt;/h3&gt;

&lt;p&gt;To run a single Rspec test file, you can do:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec spec/models/your_spec.rb&lt;/code&gt; to run the tests in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_spec.rb&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;If you want to run a single RSpec test file in addition to other test files in another folder, RSpec allows you to pass multiple arguments to it. For example, you can do:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec spec/jobs spec/models/your_spec.rb&lt;/code&gt; to run all the tests from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jobs&lt;/code&gt; folder in addition to specs found in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_spec.rb&lt;/code&gt; file.&lt;/p&gt;

&lt;h3 id=&quot;how-to-run-all-rspec-test-files-in-a-directory&quot;&gt;How to run all Rspec test files in a directory&lt;/h3&gt;

&lt;p&gt;Similarly, you can pass as an argument to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec&lt;/code&gt; command the path to a folder or folders to have RSpec run all the test files in the folder:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec spec/jobs&lt;/code&gt; to run the tests found in the jobs directory.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec spec/jobs spec/services&lt;/code&gt; to run only tests found in the jobs and services directory.&lt;/p&gt;

&lt;h2 id=&quot;2-sections-of-an-example-group&quot;&gt;2. Sections Of An Example Group&lt;/h2&gt;

&lt;p&gt;Henceforth, let’s use the spec file and class below as our test sample.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# person_spec.rb&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;attr_accessor&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:last_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:eye_colour&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eye_colour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'grey'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@first_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;first_name&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@last_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_name&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@eye_colour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eye_colour&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;local_greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Person'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Emmanuel'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hayford'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'identity'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should tell first name'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Emmanuel'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should tell last name'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Hayford'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'physical features'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should be able to tell height'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should be able to tell eye colour'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;eye_colour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'grey'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'culture'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should be able to greet in local language'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;local_greeting&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;local_greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Maakye'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Maakye'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;RSpec allows picking one (or several) section of an example group to run, allowing us to run something like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb:21&lt;/code&gt; where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;21&lt;/code&gt; is the line number of the section we want to run. The line number could fall on any of these RSpec methods: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;describe&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;context&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;it&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;expect&lt;/code&gt; and RSpec will run that section. If the line falls on an empty line, RSpec will run the closest (from the top) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;it&lt;/code&gt; block of the test file. If the blank line is above all the test examples, RSpec will run all the tests.&lt;/p&gt;

&lt;p&gt;We can also run a section of tests by doing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb[1:3]&lt;/code&gt;. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[x:y]&lt;/code&gt; format instructs RSpec to run the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x&lt;/code&gt;th group (in our case we have just one group… which is everything inside the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RSpec.describe 'Person'&lt;/code&gt; block) and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;y&lt;/code&gt;th example block. So running &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb[1:3]&lt;/code&gt; will run the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'culture'&lt;/code&gt; block. You can do multiple sections like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb[1:1,1:3]&lt;/code&gt; for example and it will run just the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'identity'&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'culture'&lt;/code&gt; blocks.&lt;/p&gt;

&lt;h2 id=&quot;3-the-description-of-an-example&quot;&gt;3. The Description Of An Example&lt;/h2&gt;

&lt;p&gt;You can run a test like so &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb -e &quot;greet&quot;&lt;/code&gt;; this will &lt;a href=&quot;https://relishapp.com/rspec/rspec-core/docs/command-line/example-option&quot;&gt;run all examples/groups&lt;/a&gt; that have “greet” in their description. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-e&lt;/code&gt; flag is short for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--example&lt;/code&gt;. It is worth noting that this is case sensitive so &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb -e &quot;greet&quot;&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb -e &quot;Greet&quot;&lt;/code&gt; won’t yield the same results.&lt;/p&gt;

&lt;p&gt;Running &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb -e &quot;greet&quot; -fd&lt;/code&gt; in on our spec file will return&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Run&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;options: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:full_description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/greet/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Person&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;culture&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;should&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;able&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;greet&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;language&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Finished&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.00088&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;took&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.09423&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;example&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failures&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There’s only one example that has “greet” in its description.&lt;/p&gt;

&lt;h2 id=&quot;4-focusing-on-an-example&quot;&gt;4. Focusing On An Example&lt;/h2&gt;

&lt;p&gt;This feature is handy if you’re working on just one test or a group that you’re working. To use this feature, you have to go an extra step with your configuration. The configuration in question is:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter_run_when_matching&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;focus: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In a typical Rails project, this might go in your &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec_helper.rb&lt;/code&gt; file. Once this configuration is in place, you can add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;f&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;describe&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;context&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;it&lt;/code&gt; so it becomes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fdescribe&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fcontext&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fit&lt;/code&gt;  and RSpec will “focus” on that example/group. Doing:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should tell height'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is equivalent to&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should tell height'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;focus: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;5-running-only-failing-tests&quot;&gt;5. Running Only Failing Tests&lt;/h2&gt;

&lt;p&gt;RSpec has &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec file_name_spec.rb --only-failures&lt;/code&gt;, very handy when you’re only interested in running tests that fail so you can work on fixing them. But to keep track of which tests failed the last time you run the tests, RSpec needs yet another configuration that will tell it where to store information on which tests failed/passed.&lt;/p&gt;

&lt;p&gt;This configuration should look like&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;example_status_persistence_file_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'some_file.txt'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If you’re working with Git, you might want to add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;some_file.txt&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;It’s essential to run this file once without any flags to record the statuses of all examples – this is how the content looks like after we run our tests for the first time with some (deliberate) failures.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/failing-rspec-tests.jpg&quot; alt=&quot;Running only failing RSpec tests&quot; title=&quot;RSpec record of passing/failing tests.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Once the first run has recorded the statuses of the tests, we can then run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb --only-failures&lt;/code&gt; to run just the failing tests and re-run after we’ve made changes to our code to see if we’ve been able to fix the failure we’re tracking, if it has, its status will change to “passed” in the file that we configured for RSpec to do the tracking.&lt;/p&gt;

&lt;h2 id=&quot;6-running-failing-tests-one-at-a-time&quot;&gt;6. Running Failing Tests (One-At-A-Time)&lt;/h2&gt;

&lt;p&gt;If there are multiple failures with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb --only-failures&lt;/code&gt; from the above, you can do &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb --next-failure&lt;/code&gt;  to repeatedly run a single failure at a time. Neat!&lt;/p&gt;

&lt;h2 id=&quot;7-tag-filtering&quot;&gt;7. Tag Filtering&lt;/h2&gt;

&lt;p&gt;You can tag examples/groups with a hash (RSpec calls this “&lt;a href=&quot;https://relishapp.com/rspec/rspec-core/docs/metadata/user-defined-metadata&quot;&gt;metadata&lt;/a&gt;”, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;focus: true&lt;/code&gt; in the tests you saw above is a metadata example). The hash can contain arbitrary key/values of your choice. For example, let’s say we want to mark some tests as important. We can do so by altering our tests to add an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;important: true&lt;/code&gt; so it looks like the following:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;describe&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Person'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Emmanuel'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hayford'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'identity'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;important: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 👈&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should tell first name'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;first_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Emmanuel'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should tell last name'&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Hayford'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'physical features'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;important: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 👈&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should be able to tell height'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should be able to tell eye colour'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;eye_colour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'grey'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'culture'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;important: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 👈&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'should be able to greet in local language'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;local_greeting&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;local_greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Maakye'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;local_greeting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Maakye'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this change in place, we can run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec person_spec.rb --tag important&lt;/code&gt; and expect to have only 3 examples running instead of 5.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Run&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;options: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:important&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Finished&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.00721&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;took&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.09502&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seconds&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;examples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failures&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Armed with these I’m sure we can save a lot of time, time that we can invest in doing other things. Picking tests you &lt;i&gt;want&lt;/i&gt; will speed up development. I recommend doing this with real work.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="rspec"/>
      
        <category term="testing"/>
      

      
        <summary type="html">The most common way to run tests in a project is to run rspec in the terminal. This runs tests for all examples in the project. Sometimes, this is not what we want.</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Learning Vim With ErgoDox EZ.</title>
      
      
      <link href="https://manny.codes/learning-vim-ergodox-ez/" rel="alternate" type="text/html" title="Learning Vim With ErgoDox EZ.">
      
      <published>2019-06-22T09:13:00+00:00</published>
      <updated>2022-09-25T21:32:46+00:00</updated>
      <id>https://manny.codes/learning-vim-ergodox-ez</id>
      <content type="html" xml:base="https://manny.codes/learning-vim-ergodox-ez/">&lt;h3 id=&quot;vims-learning-curve-may-be-a-myth&quot;&gt;Vim’s learning curve may be a myth!&lt;/h3&gt;
&lt;p&gt;For some years now I’ve been putting off learning Vim. I bet a lot of people will understand why. The learning curve is steep but apparently this sentiment is a &lt;a href=&quot;https://thoughtbot.com/blog/the-vim-learning-curve-is-a-myth&quot;&gt;myth&lt;/a&gt;. I know only two groups of people, those who know Vim very well and those who don’t use it at all (like me). But recently I’ve been wanting to learn Vim more and more. I have my reasons which I believe are good, with these reasons aside, the challenge to learning something new is thrilling!&lt;/p&gt;

&lt;p&gt;An excuse I give myself is that I think Vim is more fun on mechanical keyboards. Currently, I work on a 15” 2017 MacBook Pro. If you don’t already know, the keyboard on this machine is nothing to write home about. The keys are very fragile and feels a bit like you’re pushing your fingers through egg shells. That’s not even the most annoying part, this MacBook doesn’t have a real ESC key! I understand you can map the escape key to another key but the preferences on a Mac suggests that you only map to modifier keys, which doesn’t work for me because I need these keys. Drawbacks like these don’t present any motivation to learn and use tools like Vim.&lt;/p&gt;

&lt;h3 id=&quot;learning-vim-with-ergodox-ez&quot;&gt;Learning Vim with ErgoDox EZ&lt;/h3&gt;
&lt;p&gt;Recently, the urge to get a mechanical keyboard has been progressive, and if I’m going to spend money on getting a mechanical keyboard I better make maximum use of it, this would mean divorcing my trackpad and hopefully making myself more productive in the process. The first thing that comes to mind is getting an &lt;a href=&quot;https://ergodox-ez.com/&quot;&gt;ErgoDox EZ&lt;/a&gt;! I know almost nothing about this keyboard other than the fact that it’s mechanical and cool. A lot of Rubyists from my Twitter timeline seems to use and like it so I thought to myself… this many people can’t be wrong about this keyboard. I’m getting it!&lt;/p&gt;

&lt;h3 id=&quot;the-350-motivation&quot;&gt;The $350 Motivation&lt;/h3&gt;
&lt;p&gt;My motivation to learn Vim costs over $350! And I’m sure the journey will be well worth it. The spec I’m reaching for is a black, backlit keyboard with a black tilt kit and &lt;a href=&quot;https://www.cherrymx.de/en/mx-original/mx-blue.html&quot;&gt;CherryMXBlue switch&lt;/a&gt;. All coming in at $354.&lt;/p&gt;

&lt;p&gt;In all honesty, I don’t think changing over from Sublime Text to Vim will make one more productive. Sublime Text is awesome and gets the job done. But if I’m getting an ErgoDox EZ, then it probably would mean that I won’t be using the trackpad on my MacBook Pro and if I’m not engaging my trackpad, I better learn Vim… or get a mouse.&lt;/p&gt;

&lt;h3 id=&quot;edit-april-3rd-2020&quot;&gt;EDIT: April 3rd, 2020&lt;/h3&gt;

&lt;p&gt;I have since decided to sell my Ergodox EZ. I quickly realised that the keyboard is not for everybody and my purchase was rather impulsive. Though a  decent keyboard, I couldn’t bring myself to having to re-learn the position of the keys. I kept typing the wrong keys and kept retyping. This hindered my productivity and I used it for about 2 days and decided to call quits on it.&lt;/p&gt;

&lt;p&gt;Now, this is just my experience. Ergodox EZ is highly customizable and has some very cool features: you can program the LEDs and keys to a high degree. It just isn’t the product for me.&lt;/p&gt;

&lt;p&gt;I have returned to my usual Magic Keyboard from Apple.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="personal"/>
      
        <category term="weblog"/>
      

      
        <summary type="html">Vim’s learning curve may be a myth! For some years now I’ve been putting off learning Vim. I bet a lot of people will understand why. The learning curve is steep but apparently this sentiment is a myth. I know only two groups of people, those who know Vim very well and those who don’t use it at all (like me). But recently I’ve been wanting to learn Vim more and more. I have my reasons which I believe are good, with these reasons aside, the challenge to learning something new is thrilling!</summary>
      

      
      
    </entry>
  
  
  
    <entry>
      
      <title type="html">Use Active Support’s #present? Sparingly.</title>
      
      
      <link href="https://manny.codes/use-activesupport-s-present-sparingly/" rel="alternate" type="text/html" title="Use Active Support's #present? Sparingly.">
      
      <published>2019-05-30T18:15:00+00:00</published>
      <updated>2022-09-30T14:20:53+00:00</updated>
      <id>https://manny.codes/use-activesupport-s-present-sparingly</id>
      <content type="html" xml:base="https://manny.codes/use-activesupport-s-present-sparingly/">&lt;p&gt;I’ve seen a lot of Rails developers abuse Active Support’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt; method in views and controllers. Most of the times what they want to check is that an object is not &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt;. Rails’ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt; checks if an item is not empty and I think the usage of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt; for this purpose is overkill.&lt;/p&gt;

&lt;p&gt;For an idea of what I mean, here’s a snippet I found in an actual open-source project.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:reply_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;reply_to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:reply_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s look at how &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt; is implemented:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# File activesupport/lib/active_support/core_ext/object/blank.rb, line 26&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blank?&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to the documentation&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;An object is present if it’s not blank.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It returns a boolean and it calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty?&lt;/code&gt; under the hood looks like this:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;blank?&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;respond_to?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:empty?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;empty?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The critical part here is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;respond_to?(:empty?)&lt;/code&gt; where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;blank?&lt;/code&gt; checks the object on which it’s called whether it responds to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty?&lt;/code&gt;, to do this it has to check whether the object is not an instance
of some list of classes that implement &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty?&lt;/code&gt;. Let’s turn to IRB for an idea of how the list may look like:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;ObjectSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;klass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;klass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;instance_methods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;include?&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:empty?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

 &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [Thread::SizedQueue, Thread::Queue, #&amp;lt;Class:FileTest&amp;gt;, #&amp;lt;Class:#&amp;lt;Object:0x00007fdc4b0905b8&amp;gt;&amp;gt;, Hash, Array, Warning::buffer, Symbol, String, SortedSet, Set, Gem::RequestSet::Lockfile::Tokenizer, Gem::Resolver::RequirementList, #&amp;lt;Class:#&amp;lt;Object:0x00007fdc4d0b5280&amp;gt;&amp;gt;, #&amp;lt;Class:#&amp;lt;Hash:0x00007fdc4d0e7230&amp;gt;&amp;gt;, #&amp;lt;Class:#&amp;lt;String:0x00007fdc4d0e6c40&amp;gt;&amp;gt;, #&amp;lt;Class:#&amp;lt;String:0x00007fdc4d0e6cb8&amp;gt;&amp;gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here we’re checking 17 objects whether or not they implement an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty?&lt;/code&gt; method; this is &lt;i&gt;not&lt;/i&gt; inside of
a Rails app. The list is much longer in a Rails app.&lt;/p&gt;

&lt;p&gt;For classes that &lt;i&gt;do&lt;/i&gt; implement &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty?&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt; does more work than checking for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt;. And since at runtime, a lot of classes implement &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty?&lt;/code&gt; &lt;i&gt;and&lt;/i&gt; you have the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;respond_to?&lt;/code&gt; check, you can expect it to be slower. But more importantly, with that many different implementations on different classes, it’s hard to keep in mind what it does. But we can avoid it by only getting rid of it, backed by tests and making sure &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; is what we expect for the absence of an object. The same is true for when &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt; is used in views.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;params&lt;/code&gt; check above could instead be simply modified to avoid &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;present?&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:reply_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;reply_to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:reply_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here’s a simple benchmark to back for some idea of how slower we can get our apps.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'active_support/all'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'benchmark/ips'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;reply_to: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Emmanuel&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Benchmark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ips&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;prezent&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;times&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;abzent&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;times&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;compare!&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Warming&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--------------------------------------&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;prezent&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;128.000&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ms&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;abzent&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;251.000&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ms&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Calculating&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-------------------------------------&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;prezent&lt;/span&gt;      &lt;span class=&quot;mf&quot;&gt;1.273&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;±&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;      &lt;span class=&quot;mf&quot;&gt;6.400&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;5.028756&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;abzent&lt;/span&gt;      &lt;span class=&quot;mf&quot;&gt;2.520&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;±&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;     &lt;span class=&quot;mf&quot;&gt;12.801&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;   &lt;span class=&quot;mf&quot;&gt;5.081013&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Comparison&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
              &lt;span class=&quot;ss&quot;&gt;abzent:     &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2520.1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
             &lt;span class=&quot;ss&quot;&gt;prezent:     &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1273.0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.98&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;slower&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is all pernickety. But recently I found a tweet that summarises the rest of my thoughts:&lt;/p&gt;

&lt;center&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;ActiveSupport&amp;#39;s &lt;a href=&quot;https://twitter.com/hashtag/present?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#present&lt;/a&gt;?/&lt;a href=&quot;https://twitter.com/hashtag/blank?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#blank&lt;/a&gt;? adds additional uncertainty on what type an object is.&lt;br /&gt;&lt;br /&gt;If it&amp;#39;s clear that an object can either be a truthy object (array, string, number) or nil, then just use `if object`. It&amp;#39;s shorter and increases confidence.&lt;/p&gt;&amp;mdash; Janko Marohnić (@jankomarohnic) &lt;a href=&quot;https://twitter.com/jankomarohnic/status/1220825056932257792?ref_src=twsrc%5Etfw&quot;&gt;January 24, 2020&lt;/a&gt;&lt;/blockquote&gt; &lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/center&gt;

&lt;p&gt;Active Support is excellent and has so many useful methods that I wish were part of Ruby Core, but some of these methods come with some overhead cost, in most cases, we can prevent these. And seemingly minimal, watching out for little things like this may help with some speed gains.&lt;/p&gt;</content>

      
      
      
      
      

      
        <author>
            <name>Yous</name>
          
          
        </author>
      

      

      
        <category term="ruby"/>
      
        <category term="rails"/>
      
        <category term="performance"/>
      

      
        <summary type="html">I’ve seen a lot of Rails developers abuse Active Support’s present? method in views and controllers. Most of the times what they want to check is that an object is not nil. Rails’ present? checks if an item is not empty and I think the usage of present? for this purpose is overkill.</summary>
      

      
      
    </entry>
  
  
</feed>
