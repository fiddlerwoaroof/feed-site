<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">code.dblock.org | tech blog</title>
<generator uri="https://github.com/mojombo/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="https://code.dblock.org/feed.xml">
<link rel="alternate" type="text/html" href="https://code.dblock.org">
<updated>2022-08-08T21:50:37+00:00</updated>
<id>https://code.dblock.org/</id>
<author>
  <name>Daniel Doubrovkine</name>
  <uri>https://code.dblock.org/</uri>
  <email>dblock@dblock.org</email>
</author>


<entry>
  <title type="html"><![CDATA[Managing GitHub Notifications in GMail]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2022/08/08/managing-github-notifications-in-gmail.html">
  <id>https://code.dblock.org/2022/08/08/managing-github-notifications-in-gmail</id>
  <published>2022-08-08T00:00:00+00:00</published>
  <updated>2022-08-08T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;My e-mail inbox is flooded with GitHub notifications, just like yours.&lt;/p&gt;

&lt;p&gt;Having tried half a dozen ways to get a queue of notifications, I settled on creating a filter and use it to label the email, and remove it from the inbox, the first time I receive a new notification for a repo I am subscribed to on GitHub.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://code.dblock.org/images/posts/2022/2022-08-08-managing-github-notifications-in-gmail/rules.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then I check those emails in bulk and never miss anything.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://code.dblock.org/images/posts/2022/2022-08-08-managing-github-notifications-in-gmail/labels.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Click &lt;a href=&quot;https://twitter.com/dblockdotorg/status/1452985177530064898&quot;&gt;here&lt;/a&gt; for the original tweet-sized version of the above.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2022/08/08/managing-github-notifications-in-gmail.html&quot;&gt;Managing GitHub Notifications in GMail&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on August 08, 2022.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Making AWS SigV4 Authenticated Requests to Amazon OpenSearch]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2022/07/11/making-sigv4-authenticated-requests-to-managed-opensearch.html">
  <id>https://code.dblock.org/2022/07/11/making-sigv4-authenticated-requests-to-managed-opensearch</id>
  <published>2022-07-11T00:00:00+00:00</published>
  <updated>2022-07-11T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;&lt;a href=&quot;https://aws.amazon.com/opensearch-service/&quot;&gt;Amazon OpenSearch&lt;/a&gt; uses AWS SigV4 for authentication. We’re trying to make it dead easy to make authenticated requests across all OpenSearch clients in &lt;a href=&quot;https://github.com/opensearch-project/opensearch-clients/issues/22&quot;&gt;opensearch-clients#22&lt;/a&gt;. Please help contribute end-to-end cookbook examples to this post below for various clients.&lt;/p&gt;

&lt;h3 id=&quot;curl&quot;&gt;&lt;a href=&quot;https://curl.se/&quot;&gt;curl&lt;/a&gt;&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AWS_ACCESS_KEY_ID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;...
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AWS_SECRET_ACCESS_KEY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;...
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AWS_SESSION_TOKEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;...

curl &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--verbose&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--request&lt;/span&gt; GET &lt;span class=&quot;s2&quot;&gt;&quot;https://...us-west-2.es.amazonaws.com&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--aws-sigv4&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws:amz:us-west-2:es&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--user&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AWS_ACCESS_KEY_ID&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AWS_SECRET_ACCESS_KEY&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x-amz-security-token:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AWS_SESSION_TOKEN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;awscurl&quot;&gt;&lt;a href=&quot;https://github.com/okigan/awscurl&quot;&gt;awscurl&lt;/a&gt;&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AWS_ACCESS_KEY_ID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;...
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AWS_SECRET_ACCESS_KEY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;...
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AWS_SESSION_TOKEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;...

awscurl &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;https://search...us-west-2.es.amazonaws.com&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--region&lt;/span&gt; us-west-2 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--service&lt;/span&gt; es&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;aws-es-curl&quot;&gt;&lt;a href=&quot;https://github.com/joona/aws-es-curl&quot;&gt;aws-es-curl&lt;/a&gt;&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;aws-es-curl &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;https://search...us-west-2.es.amazonaws.com&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--region&lt;/span&gt; us-west-2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;java&quot;&gt;Java&lt;/h3&gt;

&lt;h4 id=&quot;opensearch-java&quot;&gt;&lt;a href=&quot;https://github.com/opensearch-project/opensearch-java&quot;&gt;opensearch-java&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AwsSdk2Transport&lt;/code&gt; introduced in opensearch-java 2.1.0 (see &lt;a href=&quot;https://github.com/opensearch-project/opensearch-java/issues/55&quot;&gt;opensearch-java#55&lt;/a&gt; and &lt;a href=&quot;https://github.com/opensearch-project/opensearch-java/pull/177&quot;&gt;opensearch-java#177&lt;/a&gt; for more information). This is the latest recommended approach.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.opensearch.client.opensearch.OpenSearchClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.opensearch.client.opensearch.core.InfoResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.opensearch.client.transport.aws.AwsSdk2Transport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.opensearch.client.transport.aws.AwsSdk2TransportOptions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.http.SdkHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.http.apache.ApacheHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.regions.Region&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;SdkHttpClient&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpClient&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ApacheHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;nc&quot;&gt;OpenSearchClient&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OpenSearchClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AwsSdk2Transport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;search-...us-west-2.es.amazonaws.com&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;Region&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;US_WEST_2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;AwsSdk2TransportOptions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nc&quot;&gt;InfoResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;distribution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;httpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can see a working demo in &lt;a href=&quot;https://github.com/dblock/opensearch-java-client-demo&quot;&gt;opensearch-java-client-demo&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;aws-request-signing-apache-interceptor&quot;&gt;&lt;a href=&quot;https://github.com/acm19/aws-request-signing-apache-interceptor&quot;&gt;aws-request-signing-apache-interceptor&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Use an interceptor and any Apache REST client, including &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RestHighLevelClient&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.http.HttpRequestInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.http.client.ClientProtocolException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.http.client.methods.CloseableHttpResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.http.client.methods.HttpGet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.http.impl.client.CloseableHttpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.http.impl.client.HttpClients&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;io.github.acm19.aws.interceptor.http.AwsRequestSigningApacheInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.auth.credentials.DefaultCredentialsProvider&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.auth.signer.Aws4Signer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.regions.Region&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;software.amazon.awssdk.utils.IoUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; 
    &lt;span class=&quot;nc&quot;&gt;ClientProtocolException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;nc&quot;&gt;HttpRequestInterceptor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interceptor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AwsRequestSigningApacheInterceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;es&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Aws4Signer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; 
        &lt;span class=&quot;nc&quot;&gt;DefaultCredentialsProvider&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; 
        &lt;span class=&quot;nc&quot;&gt;Region&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;US_WEST_2&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;CloseableHttpClient&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HttpClients&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;custom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addInterceptorLast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interceptor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;nc&quot;&gt;HttpGet&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpGet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HttpGet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://...&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;CloseableHttpResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpResponse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpGet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStatusLine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IoUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toUtf8String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()));&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can see a working demo in the &lt;a href=&quot;https://github.com/acm19/aws-request-signing-apache-interceptor&quot;&gt;interceptor code&lt;/a&gt;. For an example that uses OpenSearch &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RestHighLevelClient&lt;/code&gt; see &lt;a href=&quot;https://github.com/dblock/opensearch-java-client-demo/tree/opensearch-1.x&quot;&gt;1.x&lt;/a&gt; or &lt;a href=&quot;https://github.com/dblock/opensearch-java-client-demo/tree/opensearch-2.x&quot;&gt;2.x&lt;/a&gt; depending on your version.&lt;/p&gt;

&lt;h3 id=&quot;ruby&quot;&gt;Ruby&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-ruby/issues/71&quot;&gt;opensearch-ruby#71&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;php&quot;&gt;PHP&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-php/issues/59&quot;&gt;opensearch-php#59&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;javascript&quot;&gt;JavaScript&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-js/issues/252&quot;&gt;opensearch-js#252&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;python&quot;&gt;Python&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-py/issues/85&quot;&gt;opensearch-py#85&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;go&quot;&gt;Go&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-go/issues/117&quot;&gt;opensearch-go#117&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;rust&quot;&gt;Rust&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-rs/issues/36&quot;&gt;opensearch-rs#36&lt;/a&gt;.&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2022/07/11/making-sigv4-authenticated-requests-to-managed-opensearch.html&quot;&gt;Making AWS SigV4 Authenticated Requests to Amazon OpenSearch&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on July 11, 2022.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[A Year Working on OpenSearch (2.0)]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2022/06/05/a-year-working-on-opensearch-2.0.html">
  <id>https://code.dblock.org/2022/06/05/a-year-working-on-opensearch-2.0</id>
  <published>2022-06-05T00:00:00+00:00</published>
  <updated>2022-06-05T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I’ve now been at Amazon for 3 years, and it has been a year since I joined &lt;a href=&quot;https://opensearch.org/&quot;&gt;OpenSearch&lt;/a&gt;, &lt;a href=&quot;https://aws.amazon.com/blogs/opensource/introducing-opensearch/&quot;&gt;a community-driven, open source fork of Elasticsearch and Kibana&lt;/a&gt;. Last week we &lt;a href=&quot;https://opensearch.org/blog/releases/2022/05/opensearch-2-0-is-now-available/&quot;&gt;released OpenSearch 2.0&lt;/a&gt;. Given that it’s already end of May, it’s time for my first blog post of 2022.&lt;/p&gt;

&lt;p&gt;Many things are going really well.&lt;/p&gt;

&lt;p&gt;The first question anyone asks me is whether I am writing any code. I’ve had &lt;a href=&quot;https://github.com/pulls?q=is%3Apr+author%3Adblock+archived%3Afalse+user%3Aopensearch-project+is%3Aclosed+is%3Amerged&quot;&gt;484 pull requests merged&lt;/a&gt; into opensearch-project, out of &lt;a href=&quot;https://github.com/pulls?q=is%3Apr+author%3Adblock+archived%3Afalse+user%3Aopensearch-project+is%3Aclosed+&quot;&gt;573 pull requests raised&lt;/a&gt;. (The fact that one out of five was not merged probably means that I don’t know what I am doing about 20% of the time.) There are tons of tiny bookkeeping changes, such as version increments, but there are also several meaty ones, half in &lt;a href=&quot;https://github.com/opensearch-project/opensearch-build/pulls?q=is%3Apr+author%3Adblock+is%3Aclosed+is%3Amerged&quot;&gt;opensearch-build&lt;/a&gt;. Turns out, continuously releasing two products (OpenSearch and OpenSearch Dashboards) with dozens of plug-ins each, for a big platform matrix (e.g. Linux, RPM/DEB, x64 and arm64), while working on 3 different releases simultaneously (right now 3.0, 2.1 and 1.3.4), along with half a dozen language clients (e.g. Java, JavaScript, Ruby, Go, and Rust) and integration tools (eg. Logstash or Fluentd), is not easy! We ended up writing a manifest-driven build/test/release automation framework in Python to enable a release train. It worked well, and whereas OpenSearch 1.0 took weeks to ship, we were able to cut 3 versions of the product during the log4j 0-day over a little longer than a week-end.&lt;/p&gt;

&lt;p&gt;The confusion between Elasticsearch and OpenSearch &lt;a href=&quot;https://venturebeat.com/2022/05/19/once-frenemies-elastic-and-aws-are-now-besties/&quot;&gt;seems to have been cleared&lt;/a&gt;, too. Occasionally, users will ask whether a new feature of Elasticsearch will be available in OpenSearch (you’re welcome to contribute features without looking at any non Apache-licensed code). And while OpenSearch will keep improving a thousand small ways to be a delightful, secure experience for everyone, the future of the fork is decidedly cloud-native.&lt;/p&gt;

&lt;p&gt;What’s that all about? I work in the “Search Services” AWS organization, which builds and operates the &lt;a href=&quot;https://aws.amazon.com/opensearch-service/&quot;&gt;Amazon OpenSearch Service&lt;/a&gt;. The folks that wrote the control plane for that service are very strong cloud engineers, and the scale of the service is remarkable. For example, in 2020 Pinterest was &lt;a href=&quot;https://aws.amazon.com/solutions/case-studies/pinterest-elasticsearch-case-study/&quot;&gt;ingesting&lt;/a&gt; 1.7TB of data daily, growing to 3TB that year. Since then, data volumes haven’t grown exponentially, they have exploded. Hundreds of terabytes &lt;em&gt;per day&lt;/em&gt; is no longer some crazy number in 2022, and you can draw a curve from there into the future. The big question now is not whether OpenSearch can support a few TB of data per day, but what does OpenSearch need to look like to support many hundreds, and how soon. We can no longer scale this monolith horizontally by adding more nodes, thus the future of OpenSearch is decidedly cloud-native. This doesn’t mean you must run it in the cloud, and much less on AWS. Simply put, cloud-native systems allow every aspect of the software to scale independently, the software is readily extensible, and easily multi-tenant. For example, scaling reads can happen independently of scaling writes, and search can be scaled independently from indexing. Plug-ins can run in isolation with clear, safe boundaries and interfaces, and don’t require a cluster restart. Data access is secure.&lt;/p&gt;

&lt;p&gt;As an example of a cloud-native evolution, consider &lt;a href=&quot;https://www.amazon.science/latest-news/amazon-redshift-ten-years-of-continuous-reinvention&quot;&gt;Amazon Redshift&lt;/a&gt;. Similarly, in OpenSearch we’ve embarked on &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/issues/2095&quot;&gt;a journey&lt;/a&gt; towards rethinking extensibility, storage, indexing and search. While I have not written much (or any) code in these areas, I’ve spent many hours with various Engineers brainstorming and building an &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/issues/2447&quot;&gt;OpenSearch SDK&lt;/a&gt; that will help decouple the engine from its extensions, &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/issues/2578&quot;&gt;refactoring and scaling storage&lt;/a&gt;, starting with &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/issues/2229&quot;&gt;segment replication&lt;/a&gt;, and much more. Most of these are not my ideas, but I believe I have been able to help folks feel safe making bigger bets, and aiming high, while staying pragmatic, and always writing code.&lt;/p&gt;

&lt;p&gt;That said, don’t dismiss me too quickly as merely a cheerleader - I did help debug a customer problem in the managed service, and &lt;a href=&quot;https://github.com/apache/lucene/pull/711&quot;&gt;wrote a unit test in Lucene for the fix authored by a long time Lucene committer and Elasticsearch Engineer&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Outside of code I like to persevere in areas where others would not.&lt;/p&gt;

&lt;p&gt;I helped move &lt;a href=&quot;https://github.com/opensearch-project/opensearch-plugin-template-java&quot;&gt;opensearch-plugin-template-java&lt;/a&gt; into the opensearch-project organization, while preserving the original author who doesn’t work for Amazon as an external repo administrator (a first for Amazon open-source), and worked through a process of adding external maintainers to OpenSearch project repos, merged as &lt;a href=&quot;https://github.com/opensearch-project/.github/pull/59&quot;&gt;opensearch-project/.github#59&lt;/a&gt; with 197 comments. This paved the way for our &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/pull/2905&quot;&gt;first external maintainer&lt;/a&gt; in OpenSearch core. In some ways these changes were hard (you know what I’m talking about if you’ve ever navigated a large organization with senior decision makers that own a significant P&amp;amp;L), and in other ways they were easy, because everyone at AWS wanted this. In practice, someone just needed to do it, removing obstacles one-by-one. I like this work and believe that enabling others always has much bigger impact vs. anything I could accomplish alone.&lt;/p&gt;

&lt;p&gt;There are also some challenges.&lt;/p&gt;

&lt;p&gt;I often hear that Amazon isn’t contributing enough to open-source, and I prefer to acknowledge that my colleagues and I can do more. So we do. As of today, I counted 191 out of 401 contributors to OpenSearch that don’t work for Amazon, two dozen Amazon contributors to Lucene, etc.&lt;/p&gt;

&lt;p&gt;Across my larger organization, and AWS as a whole, open-source is still considered as an “upstream” activity. Engineers working in proprietary software tend to implement solutions in their territory, and then to open-source some parts (they never get enough time to do it). Doing open-source is perceived as, at the very least, a time-consuming “expense”, or at most a “risk”. Neither is actually true. Open-source is cheaper to write, and solves a number of real problems: it eases access to a more diverse group of experts, improves collaboration in code, creates higher quality software when done right, favors longer term product and design thinking, reduces staff attrition, and improves transparency and security. Open-source software, such as the Apache-licensed OpenSearch, powers many businesses and delivers real customer value to anyone who cares to run the software. Some then choose to invest their time and money into development, while retaining the freedom to do whatever they want with the results.&lt;/p&gt;

&lt;p&gt;I’m excited for the rest of 2022 and the &lt;a href=&quot;https://github.com/orgs/opensearch-project/projects/1&quot;&gt;OpenSearch Roadmap&lt;/a&gt;. See you at &lt;a href=&quot;https://opensearch.org/blog/community/2022/05/opensearchcon/&quot;&gt;OpenSearchCon in Seattle&lt;/a&gt; September 21!&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2022/06/05/a-year-working-on-opensearch-2.0.html&quot;&gt;A Year Working on OpenSearch (2.0)&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on June 05, 2022.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[How I Learned Rust by Accident]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/09/03/how-i-learned-rust-by-accident.html">
  <id>https://code.dblock.org/2021/09/03/how-i-learned-rust-by-accident</id>
  <published>2021-09-03T00:00:00+00:00</published>
  <updated>2021-09-03T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I had to quickly ramp up my Python over &lt;a href=&quot;https://github.com/opensearch-project/opensearch-build/pulls?q=is%3Apr+is%3Aclosed+author%3Adblock&quot;&gt;the past few weeks&lt;/a&gt;. Mind, because Ruby is obviously better, I’ve never really written any Python in 20 years of programming. At least not production-grade Python with unit tests. Working on a real active codebase was the easiest and fastest way for me to learn, but I’m not telling you anything you didn’t already know.&lt;/p&gt;

&lt;p&gt;Then yesterday, I accidentally “learned” Rust. I’m, obviously, still a total Rust noob, but at least now I know what &lt;a href=&quot;https://doc.rust-lang.org/cargo/reference/manifest.html&quot;&gt;Cargo and TOML&lt;/a&gt; are, and I think I’m getting just sufficiently dangerous with it. Here’s the full story.&lt;/p&gt;

&lt;p&gt;The OpenSearch project uses a link checker called &lt;a href=&quot;https://github.com/lycheeverse/lychee&quot;&gt;lychee&lt;/a&gt; to ensure that links in the OpenSearch markdown docs work. The tool is open-source, and is written in &lt;a href=&quot;https://www.rust-lang.org/&quot;&gt;Rust&lt;/a&gt;. Yesterday, the &lt;a href=&quot;http://icu-project.org/&quot;&gt;icu-project.org&lt;/a&gt; website became a redirect, causing the link checker to &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/issues/1199&quot;&gt;fail&lt;/a&gt;, blocking CI.&lt;/p&gt;

&lt;p&gt;I started fixing CI by adding &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;icu-project.org&lt;/code&gt; to the list of websites to exclude, and noticed that the GitHub action code that ran the link checker was already excluding a long list of URLs with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude=website1 --exclude=website2 --exclude=...&lt;/code&gt;. I read the Lychee documentation to see if it supported exclusion lists that could be stored in files. It didn’t, so I opened &lt;a href=&quot;https://github.com/lycheeverse/lychee/issues/302&quot;&gt;a feature request&lt;/a&gt;. I was &lt;a href=&quot;https://github.com/lycheeverse/lychee/issues/302#issuecomment-909599246&quot;&gt;pointed&lt;/a&gt; to the fact that Lychee supported config files, but I would still have to put exclusions into a long list.&lt;/p&gt;

&lt;p&gt;CI couldn’t wait, but I was still not going to add a URL to a very long command-line. I devised a hack, and put the list of websites into a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.lycheeexclude&lt;/code&gt; file, loaded the file into an environment variable with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LYCHEE_EXCLUDE=$(sed -e :a  -e 'N;s/\n/ /;ta' .lycheeexclude)&lt;/code&gt; inside the GitHub action code, used it with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude ${{ env.LYCHEE_EXCLUDE }}&lt;/code&gt;, and PRed this in &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/pull/1189&quot;&gt;OpenSearch#1189&lt;/a&gt; and &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/pull/1201&quot;&gt;OpenSearch#1201&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I decided to add the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude-file&lt;/code&gt; feature to Lychee and began by checking out Lychee code and tried to build it. After minimal Internet reading I learned that one needed &lt;a href=&quot;https://rustup.rs/&quot;&gt;rustup&lt;/a&gt; to get started, as opposed to just installing Rust. I added that to the &lt;a href=&quot;https://github.com/lycheeverse/lychee/blob/master/README.md#contributing-to-lychee&quot;&gt;Lychee README&lt;/a&gt; for the next noob like me, and was able to run tests with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cargo test&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The CI code linter was now complaining, so &lt;a href=&quot;https://github.com/lycheeverse/lychee/commit/c5d75447cad2a665e9bb126f2a04090ebd6df7f5&quot;&gt;I fixed all&lt;/a&gt; but &lt;a href=&quot;https://github.com/lycheeverse/lychee/pull/304#issuecomment-911603614&quot;&gt;one problem&lt;/a&gt; and &lt;a href=&quot;https://github.com/lycheeverse/lychee/pull/304#issuecomment-912158085&quot;&gt;asked for help&lt;/a&gt;. I was now able to run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cargo clippy&lt;/code&gt; and get a clean code lint.&lt;/p&gt;

&lt;p&gt;I finally copy-pasted code from the existing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude&lt;/code&gt; implementation into similarly looking code for  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude-file&lt;/code&gt;, copy-pasted more code from Stack Overflow to read a file line-by-line, &lt;a href=&quot;https://github.com/lycheeverse/lychee/pull/306#discussion_r701921275&quot;&gt;wrote some missing tests for the existing&lt;/a&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude&lt;/code&gt; feature, added tests for the new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude-file&lt;/code&gt;, then &lt;a href=&quot;https://github.com/lycheeverse/lychee/pull/306&quot;&gt;submitted a pull request&lt;/a&gt;. With my fixes above, CI was passing, except for a publish check.&lt;/p&gt;

&lt;p&gt;It took me a while to comprehend that Lychee is actually a library called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lychee-lib&lt;/code&gt; and a binary called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lychee-bin&lt;/code&gt;, and that the publish check was trying to dry-run publishing the lib first, then the binary. The publishing dry-run was failing with an unresolved import, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;error[E0432]: unresolved import lychee_lib::collector::Collector&lt;/code&gt;. Ths looked suspicious, as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Collector&lt;/code&gt; code was recently added, breaking CI. I figured that the dry-run of the binary publication was picking up the previously released version of the lib, and not the current one. Incrementing the version in the source code of both the lib and the binary made this even more obvious as the publication dry-run couldn’t find the new version of the lib.&lt;/p&gt;

&lt;p&gt;I Googled the problem, and discovered &lt;a href=&quot;https://crates.io/crates/cargo-publish-all&quot;&gt;cargo-publish-all&lt;/a&gt; that was designed to address this exact scenario. However, that &lt;a href=&quot;https://github.com/idanarye/rust-typed-builder/issues/57&quot;&gt;failed&lt;/a&gt; with an obscure &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;error[E0433]: failed to resolve: use of undeclared crate or module proc_macro&lt;/code&gt; that came from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rust-typed-builder&lt;/code&gt;, and has been &lt;a href=&quot;https://gitlab.com/torkleyy/cargo-publish-all/-/issues/3&quot;&gt;an open issue for over a year&lt;/a&gt;. The error made no sense to anyone, but the maintainer of rust-type-builder was able to come up with &lt;a href=&quot;https://github.com/idanarye/rust-typed-builder/issues/57#issuecomment-912802451&quot;&gt;a workaround&lt;/a&gt;. A new version of that library, 0.9.1, was also cut.&lt;/p&gt;

&lt;p&gt;I made a &lt;a href=&quot;https://github.com/lycheeverse/lychee/pull/309&quot;&gt;final pull request&lt;/a&gt; to the publish workflow and CI went back to green!&lt;/p&gt;

&lt;p&gt;To summarize, Lychee now has a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--exclude-file&lt;/code&gt; feature, and a working CI, while I got to learn Rust pretty much by accident. This would have never happened had I not be working in open-source by default. Oh, and it helped to be a bit persistent and not giving up on each one of the problems encountered above.&lt;/p&gt;

&lt;p&gt;Similar accidents have generated defining moments in my career. Will I end up writing Rust full time one day? We shall see!&lt;/p&gt;


  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/09/03/how-i-learned-rust-by-accident.html&quot;&gt;How I Learned Rust by Accident&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on September 03, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Generating a Task Matrix by Looping over Repo Files with GitHub Actions]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/09/03/generating-task-matrix-by-looping-over-repo-files-with-github-actions.html">
  <id>https://code.dblock.org/2021/09/03/generating-task-matrix-by-looping-over-repo-files-with-github-actions</id>
  <published>2021-09-03T00:00:00+00:00</published>
  <updated>2021-09-03T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I’ve been having more fun with GitHub actions after &lt;a href=&quot;/2021/08/13/automating-code-changes-with-github-actions-making-pull-requests.html&quot;&gt;Automating Code Changes via GitHub Actions Making Pull Requests&lt;/a&gt;. Let’s generate a job matrix from a list of files.&lt;/p&gt;

&lt;p&gt;Why would I need that? In &lt;a href=&quot;https://github.com/opensearch-project/opensearch-build/pull/386&quot;&gt;opensearch-project/opensearch-build&lt;/a&gt; we create manifest files that are used to produce an OpenSearch distribution. These files are created manually, one for every version. Each needs to be sanity-checked when created or changed.&lt;/p&gt;

&lt;p&gt;These checks can be executed in parallel, so we can create a GitHub Actions matrix like so.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;manifests&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ubuntu-latest&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;strategy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;manifests/opensearch-1.1.0.yml&lt;/span&gt;
                &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;manifests/opensearch-1.0.0.yml&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/checkout@v2&lt;/span&gt;   
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;./check-manifest $&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We’ll definitely forget to update the matrix when a new file is created, so let’s just list those files dynamically, and generate a matrix from the list.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;manifests&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;list-manifests&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ubuntu-latest&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ steps.set-matrix.outputs.matrix }}&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/checkout@v2&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;set-matrix&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo &quot;::set-output name=matrix::$(ls manifests/*.yml | jq -R -s -c 'split(&quot;\n&quot;)[:-1]')&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;needs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;list-manifests&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ubuntu-latest&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;strategy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ fromJson(needs.list-manifests.outputs.matrix) }}&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/checkout@v2&lt;/span&gt;   
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;./check-manifest ${{ martix.manifest }}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here’s how this works.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;A shell command &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls manifests/*.yml&lt;/code&gt; lists all .yml files.&lt;/li&gt;
  &lt;li&gt;A pipe to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;| jq -R -s -c 'split(&quot;\n&quot;)[:-1]'&lt;/code&gt; transforms the file list into a JSON array (from &lt;a href=&quot;https://stackoverflow.com/questions/10234327/convert-bash-ls-output-to-json-array&quot;&gt;StackOverflow#10234327&lt;/a&gt;). Note that &lt;a href=&quot;https://github.com/actions/virtual-environments/blob/main/images/linux/Ubuntu2004-README.md&quot;&gt;jq is installed on all GHA Linux images&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;matrix&lt;/code&gt; output is set to the JSON array of files using &lt;a href=&quot;https://docs.github.com/en/actions/reference/workflow-commands-for-github-actions#setting-an-output-parameter&quot;&gt;set-output&lt;/a&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo &quot;::set-output name=matrix::value&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;manifest&lt;/code&gt; values are loaded from the JSON array using &lt;a href=&quot;https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#fromjson&quot;&gt;fromJson&lt;/a&gt; and become part of the updated workflow.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This is so awesome that it generates the matrix during the build!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/542335/132070992-4e9ba64f-a8f4-4459-9102-95684de2cda7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;profit&quot;&gt;Profit&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/opensearch-build/pull/386&quot;&gt;opensearch-project/opensearch-build#386&lt;/a&gt; for a working example.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/09/03/generating-task-matrix-by-looping-over-repo-files-with-github-actions.html&quot;&gt;Generating a Task Matrix by Looping over Repo Files with GitHub Actions&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on September 03, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Automating Code Changes via GitHub Actions Making Pull Requests]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/08/13/automating-code-changes-with-github-actions-making-pull-requests.html">
  <id>https://code.dblock.org/2021/08/13/automating-code-changes-with-github-actions-making-pull-requests</id>
  <published>2021-08-13T00:00:00+00:00</published>
  <updated>2021-08-13T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;You’ve probably been depending on automated pull requests from &lt;a href=&quot;https://dependabot.com/&quot;&gt;Dependabot&lt;/a&gt;, but how about making your own pull requests from GitHub actions? This capability can be used for automation that looks for changes, then updates files in your own repository with little to no additional setup needed.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;In &lt;a href=&quot;https://github.com/dblock/lost-robbies/blob/master/.github/workflows/check-sales.yml&quot;&gt;dblock/lost-robbies&lt;/a&gt; the workflow checks for new sales and raises a PR after updating the JSON data and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;README.md&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;In &lt;a href=&quot;https://github.com/opensearch-project/project-meta/blob/main/.github/workflows/check-repos.yml&quot;&gt;opensearch-project/project-meta&lt;/a&gt; the workflow enumerates public repositories in the opensearch-project organization and adds new repos to a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.meta&lt;/code&gt; file.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Below are some implementation details from &lt;a href=&quot;https://github.com/opensearch-project/project-meta/blob/main/.github/workflows/check-repos.yml&quot;&gt;opensearch-project/project-meta&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;github-action-setup&quot;&gt;GitHub Action Setup&lt;/h3&gt;

&lt;p&gt;The job is executed on all changes to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main&lt;/code&gt; and daily at midnight.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Check for new Project Repos&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;main&lt;/span&gt;  
  &lt;span class=&quot;na&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;cron&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;*&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;permissions-and-tokens&quot;&gt;Permissions and Tokens&lt;/h3&gt;

&lt;p&gt;The job checks out code, and needs a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GITHUB_TOKEN&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;env.&lt;/code&gt; to make pull requests.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;check-project-repos&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ubuntu-latest&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/checkout@v2&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Update project repositories&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;GITHUB_TOKEN&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ secrets.GITHUB_TOKEN }}&lt;/span&gt;      &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;generating-a-pr-title-and-body&quot;&gt;Generating a PR Title and Body&lt;/h3&gt;

&lt;p&gt;At first I was hard-coding PR titles and commit messages. That’s not ideal. Compare the following PRs. The second version is much more specific!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/542335/129234923-42116ea8-dee6-4247-a904-35862d67919a.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/542335/129370221-380b84a1-e65d-4da5-8bb3-83a9277b946f.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This can be achieved by setting an environment variable during the workflow execution by piping it into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$GITHUB_ENV&lt;/code&gt;, and reusing it in the PR.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;REPOS_ADDED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;git diff &lt;span class=&quot;nt&quot;&gt;--unified&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 .gitignore | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'+/'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f2&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;paste&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sd&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;','&lt;/span&gt; - | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s/,/, /g&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/\(.*\),/\1 and/'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$GITHUB_ENV&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;The workflow modifies &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gitignore&lt;/code&gt; by adding lines to it, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cross-cluster-replication/&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Find all additions that start with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;+/&lt;/code&gt; using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;| grep '+/'&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Extract the name of each addition with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;| cut -f2 -d'/'&lt;/code&gt;, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cross-cluster-replication&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Combine all additions into a comma-separated list with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;| paste -sd ',' -&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Add a space after each comma with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;| sed &quot;s/,/, /g&quot; |&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Replace the last comma by an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;and&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;| sed 's/\(.*\),/\1 and/'&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Pipe everything into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;REPOS_ADDED=&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo REPOS_ADDED=$(...) &amp;gt;&amp;gt; $GITHUB_ENV&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;make-a-pull-request&quot;&gt;Make a Pull Request&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Create Pull Request&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;peter-evans/create-pull-request@v3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;commit-message&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Added ${{ env.REPOS_ADDED }}.&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;delete-branch&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Added&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;${{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;env.REPOS_ADDED&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;}}.'&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;Added ${{ env.REPOS_ADDED }}.&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Check outputs&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;echo &quot;Pull Request Number - ${{ steps.cpr.outputs.pull-request-number }}&quot;&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;echo &quot;Pull Request URL - ${{ steps.cpr.outputs.pull-request-url }}&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;profit&quot;&gt;Profit&lt;/h3&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/opensearch-project/project-meta/pull/7&quot;&gt;opensearch-project/project-meta#7&lt;/a&gt; for an example.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/08/13/automating-code-changes-with-github-actions-making-pull-requests.html&quot;&gt;Automating Code Changes via GitHub Actions Making Pull Requests&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on August 13, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[How to run GitHub Actions Locally using Act]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/06/15/running-github-actions-locally-using-act.html">
  <id>https://code.dblock.org/2021/06/15/running-github-actions-locally-using-act</id>
  <published>2021-06-15T00:00:00+00:00</published>
  <updated>2021-06-15T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I’m a big fan of &lt;a href=&quot;https://github.com/features/actions&quot;&gt;GitHub Actions&lt;/a&gt; to automate workflows. They are declarative in nature, developed as open-source components, and execution is container-based. I also recently learned that GitHub Actions were actually not tied to GitHub infrastructure, and can be executed locally, using &lt;a href=&quot;https://github.com/nektos/act&quot;&gt;act&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Let’s build OpenSearch &lt;a href=&quot;https://github.com/opensearch-project/job-scheduler&quot;&gt;job-scheduler&lt;/a&gt; on a local Linux.&lt;/p&gt;

&lt;h3 id=&quot;download-act&quot;&gt;Download Act&lt;/h3&gt;

&lt;p&gt;Download and install act from &lt;a href=&quot;https://github.com/nektos/act#installation&quot;&gt;here&lt;/a&gt;. I just run the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;install.sh&lt;/code&gt; because YOLO.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl https://raw.githubusercontent.com/nektos/act/master/install.sh | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;check-out-jobscheduler&quot;&gt;Check Out JobScheduler&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git checkout git@github.com:opensearch-project/job-scheduler.git
cd job-scheduler
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;modify-workflow-temporary&quot;&gt;Modify Workflow (Temporary)&lt;/h3&gt;

&lt;p&gt;By default the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;runner&lt;/code&gt; user under which the workflow runs in the Docker container does not have write access to the current folder, therefore &lt;a href=&quot;https://github.com/opensearch-project/job-scheduler/blob/main/.github/workflows/test-and-build-workflow.yml&quot;&gt;the workflow&lt;/a&gt; as implemented requires one additional step. Add the following code locally in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.github/workflows/test-and-build-workflow.yml&lt;/code&gt; after “Setup Java”.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Chown&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;sudo chown -R runner .&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;environment&quot;&gt;Environment&lt;/h3&gt;

&lt;p&gt;The current workflow implementation checks out OpenSearch and builds it, thus needing a token to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git clone&lt;/code&gt; from GitHub. Create a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.secrets&lt;/code&gt; file with a read-only GitHub token. This gets automatically picked up by act.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GITHUB_TOKEN=valid-token
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;invoke-act&quot;&gt;Invoke Act&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;act -r pull_request -P ubuntu-latest=catthehacker/ubuntu:runner-latest 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Act uses an open-source Docker container to run the job. Enjoy a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BUILD SUCCESSFUL&lt;/code&gt; result!&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/06/15/running-github-actions-locally-using-act.html&quot;&gt;How to run GitHub Actions Locally using Act&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on June 15, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[To Wrap or Not to Wrap in Markdown?]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/06/07/to-wrap-or-not-to-wrap-in-markdown.html">
  <id>https://code.dblock.org/2021/06/07/to-wrap-or-not-to-wrap-in-markdown</id>
  <published>2021-06-07T00:00:00+00:00</published>
  <updated>2021-06-07T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I keep antagonizing OSS contributors trying to wrap text in Markdown files, e.g. &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/pull/689#issuecomment-839241016&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/pull/712#issuecomment-855271225&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Should one wrap text in .markdown files at 80 columns or should one not?&lt;/p&gt;

&lt;p&gt;First, let me say that I don’t care. Except that I do. Wrapped text in markdown really feeds my OCD in the worst possible way, right behind missing periods at the end of sentences, and two spaces. Oddly, I don’t care about tabs vs. spaces.&lt;/p&gt;

&lt;p&gt;Here’s a logical argument for &lt;em&gt;not wrapping&lt;/em&gt; text in markdown.&lt;/p&gt;

&lt;p&gt;Markdown doesn’t use line the breaks: whether you include a line break in your markdown or not the rendered result is the same, unless you use 2 line breaks.&lt;/p&gt;

&lt;p&gt;For example, consider the following text wrapped at 23 characters for illustration purposes.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;A quick brown fox jumps 
over the lazy dog.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We swap “a” and “the”, producing the following new text.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The quick brown fox 
jumps over a lazy dog.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because of a line wrap, this 2-word change is now a 2-line change. It hurts.&lt;/p&gt;

&lt;p&gt;Without the wrap the diff would have been super clean.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt;A quick brown fox jumps over the lazy dog.
&amp;lt;The quick brown fox jumps over a lazy dog.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Furthermore, GitHub &lt;a href=&quot;https://github.com/dblock/code.dblock.org/commit/99a4948a737ef21bf4025f3faa5b6167410e3de8&quot;&gt;does an even better job at the 1-line diff&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://code.dblock.org/images/posts/2021/2021-06-07-to-wrap-or-not-to-wrap-in-markdown/diff.png&quot; alt=&quot;diff&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Notice how the word “jumps” was highlighted, even though it wasn’t actually changed.&lt;/p&gt;

&lt;p&gt;For an argument &lt;em&gt;for&lt;/em&gt; wrapping text, see &lt;a href=&quot;https://github.com/opensearch-project/OpenSearch/pull/712#issuecomment-855271225&quot;&gt;this comment&lt;/a&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/06/07/to-wrap-or-not-to-wrap-in-markdown.html&quot;&gt;To Wrap or Not to Wrap in Markdown?&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on June 07, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Walking Ethereum Transaction Logs to Find Lost Robbies w/Etherscan API]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/04/27/walking-ethereum-transaction-logs-to-find-lost-robbies-using-etherscan-api.html">
  <id>https://code.dblock.org/2021/04/27/walking-ethereum-transaction-logs-to-find-lost-robbies-using-etherscan-api</id>
  <published>2021-04-27T00:00:00+00:00</published>
  <updated>2021-04-27T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;On July 17, 2018, I &lt;a href=&quot;https://www.youtube.com/watch?v=KT-gPtK5uHY&amp;amp;t=4h13m20s&quot;&gt;spoke&lt;/a&gt; at the Christies first ever annual Tech Summit entitled “Exploring Blockchain”, in London. I even got a freebie NFT!&lt;/p&gt;

&lt;p&gt;During the event &lt;a href=&quot;http://superrare.io/&quot;&gt;SuperRare&lt;/a&gt; partnered with &lt;a href=&quot;https://www.artnome.com/about-artnome&quot;&gt;Jason Bailey&lt;/a&gt; and enlisted &lt;a href=&quot;https://robbiebarrat.github.io/&quot;&gt;Robbie Barrat&lt;/a&gt;, the first artist to ever tokenize on SuperRare. Robbie created “AI Generated Nude Portrait #7” for the event, which he intended as 300 separate frames of a single artwork. Each of the 300 frames was tokenized separately and added to redeemable ETH gift cards with directions for how to claim the 1/1 token.&lt;/p&gt;

&lt;p&gt;A small handful of these original NFTs are known to still exist. We’ll call them “Robbies”. On April 5th, 2021, &lt;a href=&quot;https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-269-459&quot;&gt;frame 269&lt;/a&gt; sold for 125ETH ($265K).&lt;/p&gt;

&lt;p&gt;If you enjoyed the forensics in &lt;a href=&quot;https://digitalartcollector.com/rare-lost-robbie-ai-nude-nfts-worth-millions-surface/&quot;&gt;Rare “Lost Robbie” AI Nude NFTs Worth Millions Surface&lt;/a&gt;, or if you just want to know how SuperRare or other marketplaces display token history, this post is for you. We’ll walk the Ethereum blockchain transaction logs to find all the Robbies using &lt;a href=&quot;https://www.npmjs.com/package/etherscan-api&quot;&gt;etherscan-api&lt;/a&gt; (&lt;a href=&quot;https://etherscan.io/apis&quot;&gt;Etherscan API&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Please do note that I am no expert, and that I would greatly appreciate suggestions and fixes to my approach and &lt;a href=&quot;https://github.com/dblock/lost-robbies&quot;&gt;the code&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;An freebie OBJKT NFT was also minted, inspired by this project. Available at &lt;a href=&quot;https://www.hicetnunc.xyz/objkt/53103&quot;&gt;hicetnunc.xyz/objkt/53103&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;getting-started&quot;&gt;Getting Started&lt;/h3&gt;

&lt;p&gt;First, get an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ETHERSCAN_API_KEY&lt;/code&gt; from &lt;a href=&quot;https://etherscan.io/myapikey&quot;&gt;Etherscan&lt;/a&gt; and save it to a file called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.env&lt;/code&gt;. We’ll use &lt;a href=&quot;https://www.npmjs.com/package/dotenv&quot;&gt;dotenv&lt;/a&gt; to automatically load it, and initialize &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EtherscanApi&lt;/code&gt; with this key.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dotenv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;dotenv&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;EtherscanApi&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;etherscan-api&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;dotenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;etherscanApiKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ETHERSCAN_API_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;etherscanApiKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Missing ETHERSCAN_API_KEY&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;EtherscanApi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;etherscanApiKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  
&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// do something useful here&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The rest of the code goes somewhere into that &lt;em&gt;do something useful here&lt;/em&gt; part above.&lt;/p&gt;

&lt;h3 id=&quot;who-is-robbie&quot;&gt;Who is Robbie?&lt;/h3&gt;

&lt;p&gt;Robbie Barrat, or &lt;a href=&quot;https://superrare.co/videodrome&quot;&gt;@videodrome&lt;/a&gt; is &lt;a href=&quot;https://etherscan.io/address/0x860c4604fe1125ea43f81e613e7afb2aa49546aa&quot;&gt;0x860c4604fe1125ea43f81e613e7afb2aa49546aa&lt;/a&gt;. I found that address by following transaction links on SuperRare.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x860c4604fe1125ea43f81e613e7afb2aa49546aa&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Robbie has &lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000000000000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toFixed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; ETH&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This says Robbie has earned 118.66 ETH (~$317K) from sales so far. Not bad.&lt;/p&gt;

&lt;h3 id=&quot;superrare-contract&quot;&gt;SuperRare Contract&lt;/h3&gt;

&lt;p&gt;Ethereum transactions execute methods that are written in a &lt;em&gt;contract&lt;/em&gt;, which is basically a bunch of code that implements a set of known methods (an interface, e.g. &lt;a href=&quot;https://github.com/ethereum/eips/issues/721&quot;&gt;ERC721&lt;/a&gt;). As all code, method have inputs and outputs. The SuperRare contract is &lt;a href=&quot;https://etherscan.io/address/0x41a322b28d0ff354040e2cbc676f0320d8c8850d&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/a&gt;, also found by examining a transaction linked from SuperRare.&lt;/p&gt;

&lt;p&gt;Contracts are expressed in JSON, include method names, inputs, outputs, and other metadata. Contracts, along with all inputs and outputs on Ethereum, are encoded in binary format, using an application binary interface (ABI). We can fetch the contract with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;contract.getabi&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;contract&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getabi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;abi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The ABI also gives you the ability to create an instance of a &lt;a href=&quot;https://www.npmjs.com/package/ethereum-input-data-decoder&quot;&gt;ethereum-input-data-decoder&lt;/a&gt; to decode data in transactions that had been executed under this contract with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;new InputDataDecoder(json)&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;transactions-and-logs&quot;&gt;Transactions and Logs&lt;/h3&gt;

&lt;p&gt;Ethereum transactions are a series of method calls. Each transaction has an address, input arguments and output results. Each method call inside a transaction receives input, or &lt;em&gt;topics&lt;/em&gt;, that can be &lt;em&gt;indexed&lt;/em&gt;. A successful method call creates a log entry. Etherscan lets you query logs that belong to a certain contract using indexed topics.&lt;/p&gt;

&lt;p&gt;For example, you can query logs for all method calls for the SuperRare contract.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;logs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getLogs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;logs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// first page of a lot of logs&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;dude-wheres-my-nft&quot;&gt;Dude, where’s my NFT?&lt;/h3&gt;

&lt;p&gt;So, what’s the address of my NFT? Well, there isn’t one.&lt;/p&gt;

&lt;p&gt;The SuperRare contract &lt;em&gt;mints&lt;/em&gt; a new NFT as a side effect of a call to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addNewToken&lt;/code&gt; method. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addNewToken&lt;/code&gt; call increments &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;totalSupply()&lt;/code&gt; of tokens to obtain a new token ID. By convention, this looks like a transfer from address &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x00&lt;/code&gt; to the caller using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Transfer&lt;/code&gt; method.&lt;/p&gt;

&lt;p&gt;Take a look at &lt;a href=&quot;https://etherscan.io/tx/0x397cf219aadb0e25afc7fcbb35f36ebccd8611375b5c7ad888e4cbacced2d7ea&quot;&gt;the first Nude Portrait #7 token creation transaction&lt;/a&gt;. The transaction address was &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x397cf219aadb0e25afc7fcbb35f36ebccd8611375b5c7ad888e4cbacced2d7ea&lt;/code&gt;. It called the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addNewToken&lt;/code&gt; method with an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_uri&lt;/code&gt; of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://ipfs.pixura.io/ipfs/QmWkvzP1FZBrwBXjj3vD258RQm9MtV25G69zcqzYmc1cGd&lt;/code&gt;, which contains the JSON of frame #1.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;name:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AI Generated Nude Portrait #7 Frame #1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;description:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Artwork generated by a GAN trained on thousands of nude portrait oil paintings.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;yearCreated:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2018&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;createdBy:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Robbie Barrat&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;tags:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Nude&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Portrait&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;AI&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Painting&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Portrait&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Generative&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;GAN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Machine&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Learning&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Artificial&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Intelligence&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Nude&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;,
        &quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Abstract&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;image.jpg&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;image:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://ipfs.pixura.io/ipfs/QmaFkStftgA9rW9NyKUFyCKhAvKkENtD1CUfCkzEAWghyr&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The output of this transaction was a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_tokenId&lt;/code&gt; of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;191&lt;/code&gt;. Navigating to &lt;a href=&quot;https://superrare.co/artwork/191&quot;&gt;superrare.co/artwork/191&lt;/a&gt; will incidentally show you the first frame from “Nude Portrait #7”.&lt;/p&gt;

&lt;h3 id=&quot;finding-create-transactions&quot;&gt;Finding Create Transactions&lt;/h3&gt;

&lt;p&gt;As I described above, creating a token means calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Transfer&lt;/code&gt; from address &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x00&lt;/code&gt;. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tokenId&lt;/code&gt; argument, however, is not indexed, so I could not find how to get the transaction that created, for example, token number 191. However, I figured out how to find all the transactions that generated the 300 tokens by specifying the source address of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x00&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getLogs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// contract address&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;5977236&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// fromBlock, from https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-1-191&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;5977931&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// toBlock, from https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-300-490&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x0000000000000000000000000000000000000000000000000000000000000000&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// from at creation&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;examining-a-transaction&quot;&gt;Examining a Transaction&lt;/h3&gt;

&lt;p&gt;Now that we have a collection of 300 logs, we can, for each &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;log&lt;/code&gt;, get the corresponding transactions, decode input data, identify the method called, etc.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;proxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eth_getTransactionByHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transactionHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// _uri: https://ipfs.pixura.io/ipfs/QmWkvzP1FZBrwBXjj3vD258RQm9MtV25G69zcqzYmc1cGd&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;decodedInputData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;inputDataDecoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;decodeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// addNewToken&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;decodedInputData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;first-transfers&quot;&gt;First Transfers&lt;/h3&gt;

&lt;p&gt;After creation, the tokens were transferred from @videodrome’s address into newly created wallets. Those transfers are indexed by the sender’s address. Again, because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tokenId&lt;/code&gt; is not indexed in these transactions, I couldn’t figure out how to query all transfer logs for a single token, but we can get the entire set.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getLogs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// contract address&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;5977931&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// fromBlock, from https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-1-191&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;5979502&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// toBlock, from https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-300-490&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x000000000000000000000000860c4604fe1125ea43f81e613e7afb2aa49546aa&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// videodrome's address&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sales-and-bids&quot;&gt;Sales and Bids&lt;/h3&gt;

&lt;p&gt;Reading the contract shows that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bid&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;acceptBid&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;buy&lt;/code&gt; event logs are indexed by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tokenId&lt;/code&gt; as the 3rd topic.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// e.g. '0x0000000000000000000000000000000000000000000000000000000000000126'&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;topic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tokenId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;padStart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getLogs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// fromBlock&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// toBlock&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic0&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic0_1_opr&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic1&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic1_2_opr&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic2&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic2_3_opr&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;topic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic3, tokenId&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Similarly, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setSalePrice&lt;/code&gt; is indexed by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tokenId&lt;/code&gt; as the 1st topic.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-typescript&quot; data-lang=&quot;typescript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getLogs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;0x41a322b28d0ff354040e2cbc676f0320d8c8850d&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// fromBlock&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// toBlock&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic0&lt;/span&gt;
  &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic0_1_opr&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;topic&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// topic1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Decoding inputs in these logs tells us, for example, the amount for the sale price set (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parseInt(log.topics[2], 16)&lt;/code&gt;) or the transaction timestamp (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;moment.unix(parseInt(log.timeStamp, 16))&lt;/code&gt;).&lt;/p&gt;

&lt;h3 id=&quot;putting-it-all-together&quot;&gt;Putting It All Together&lt;/h3&gt;

&lt;p&gt;The complete code to this blog post is &lt;a href=&quot;https://github.com/dblock/lost-robbies&quot;&gt;here&lt;/a&gt;. It fetches and stores the initial create transactions, subsequent transfer transactions, then all the sales transactions.&lt;/p&gt;

&lt;p&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm run update&lt;/code&gt; to fetch any new data updates, cached locally, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;npm run sales&lt;/code&gt; to show the most recent sales.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;frame 13 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;100.888 ETH on Sat Apr 10 2021 00:40:21 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-13-203
frame 24 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0.100 ETH on Fri Jul 20 2018 10:32:22 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-24-214
frame 44 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;350.000 ETH on Sun Apr 25 2021 16:42:41 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-44-234
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;110.000 ETH on Mon Apr 19 2021 14:17:32 GMT-0400
frame 45 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;100.888 ETH on Fri Apr 09 2021 15:38:00 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-45-235
frame 53 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;2500.000 ETH on Wed Mar 24 2021 21:44:31 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-53-243
frame 65 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;545.000 ETH on Sun Apr 04 2021 22:14:41 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-65-255
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;47.000 ETH on Sun Apr 04 2021 08:32:42 GMT-0400
frame 78 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;222.000 ETH on Fri Apr 23 2021 17:37:51 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-78-268
frame 92 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;122.000 ETH on Mon Apr 26 2021 16:58:29 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-92-282
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;50.000 ETH on Mon Apr 05 2021 13:50:40 GMT-0400
frame 101 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;5555.000 ETH on Fri Mar 12 2021 07:11:07 GMT-0500 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-101-291
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;1.500 ETH on Mon Dec 02 2019 13:46:32 GMT-0500
frame 104 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;1000.000 ETH on Mon Mar 15 2021 16:12:56 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-104-294
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;19.000 ETH on Thu Jun 11 2020 16:28:09 GMT-0400
frame 149 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;888.000 ETH on Wed Mar 24 2021 08:29:05 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-149-339
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;35.000 ETH on Tue Aug 04 2020 02:06:33 GMT-0400
frame 153 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;16.500 ETH on Wed Jan 01 2020 15:37:56 GMT-0500 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-153-343
frame 165 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;2000.000 ETH on Mon Apr 05 2021 15:52:17 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-165-355
frame 166 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;2200.000 ETH on Mon Apr 19 2021 22:24:50 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-166-356
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;80.000 ETH on Sat Apr 03 2021 03:56:19 GMT-0400
frame 175 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0.001 ETH on Sat Jul 11 2020 23:54:29 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-175-365
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0.001 ETH on Sat Jul 11 2020 23:37:43 GMT-0400
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0.001 ETH on Sat Jul 11 2020 23:30:37 GMT-0400
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0.001 ETH on Sat Jul 11 2020 23:14:22 GMT-0400
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;21.000 ETH on Mon Jun 29 2020 22:48:05 GMT-0400
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;1.500 ETH on Sat Dec 21 2019 00:09:56 GMT-0500
frame 179 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;299.000 ETH on Mon Apr 12 2021 21:17:18 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-179-369
frame 206 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;60.000 ETH on Wed Apr 07 2021 15:40:30 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-206-396
frame 269 sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;125.000 ETH on Mon Apr 05 2021 16:36:12 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-269-459
frame 275 was listed &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sale &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;885.000 ETH on Mon Apr 19 2021 22:25:38 GMT-0400 | https://superrare.co/artwork/ai-generated-nude-portrait-7-frame-275-465
  sold &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;50.000 ETH on Wed Apr 07 2021 19:29:54 GMT-0400&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;


  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/04/27/walking-ethereum-transaction-logs-to-find-lost-robbies-using-etherscan-api.html&quot;&gt;Walking Ethereum Transaction Logs to Find Lost Robbies w/Etherscan API&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on April 27, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Adding Work E-Mail to a GPG Key and Signing Git Commits]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/04/16/adding-work-email-to-a-gpg-key-and-signing-git-commits.html">
  <id>https://code.dblock.org/2021/04/16/adding-work-email-to-a-gpg-key-and-signing-git-commits</id>
  <published>2021-04-16T00:00:00+00:00</published>
  <updated>2021-04-16T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;Last week I joined the &lt;a href=&quot;https://opensearch.org/&quot;&gt;OpenSearch Team&lt;/a&gt; at AWS, a community-driven, open source fork of Elasticsearch and Kibana (read more about it &lt;a href=&quot;https://aws.amazon.com/blogs/opensource/introducing-opensearch/&quot;&gt;here&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Security is always our top priority at AWS, so I had to learn some new development best practices in this area. One of my colleagues, and Apache contributor &lt;a href=&quot;https://github.com/nknize&quot;&gt;@nknize&lt;/a&gt; has been signing his commits with GPG. I decided to add my work e-mail address to my existing GPG key, and setup git signing as well.&lt;/p&gt;

&lt;h3 id=&quot;generating-keys&quot;&gt;Generating Keys&lt;/h3&gt;

&lt;p&gt;If you don’t already have a key, install &lt;a href=&quot;https://gnupg.org/download/&quot;&gt;gpg2&lt;/a&gt; (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install gpg&lt;/code&gt;), and follow the instructions in &lt;a href=&quot;https://docs.github.com/en/github/authenticating-to-github/generating-a-new-gpg-key&quot;&gt;this doc&lt;/a&gt;. It will tell you to run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpg --full-generate-key&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;You can list keys with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpg --list-secret-keys --keyid-format LONG&lt;/code&gt; and note the key ID.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gpg &lt;span class=&quot;nt&quot;&gt;--list-secret-keys&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--keyid-format&lt;/span&gt; LONG
/Users/dblock/.gnupg/pubring.kbx
&lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
sec   rsa2048/75BF031B7C94E183 2013-12-24 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;SC]
      4A720FE790B07A68744E371675BF031B7C94E183
uid                 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ultimate] Daniel Doubrovkine &amp;lt;dblock[at]dblock.org&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In my example the key ID is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;75BF031B7C94E183&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;backing-up-keys&quot;&gt;Backing up Keys&lt;/h3&gt;

&lt;p&gt;I export and store a copy of my GPG keys in Dropbox and store the private key passphrase in 1Password. The latter is required to export or import a private key (gpg will prompt you).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gpg &lt;span class=&quot;nt&quot;&gt;--export-secret-key&lt;/span&gt; 75BF031B7C94E183 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 75BF031B7C94E183.gpg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;adding-my-work-e-mail&quot;&gt;Adding my Work E-Mail&lt;/h3&gt;

&lt;p&gt;I only have one identity, but multiple e-mails. I decided to add my work e-mail to my GPG key (YMMV) as explained &lt;a href=&quot;https://docs.github.com/en/github/authenticating-to-github/associating-an-email-with-your-gpg-key&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gpg &lt;span class=&quot;nt&quot;&gt;--edit-key&lt;/span&gt; 75BF031B7C94E183

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg&amp;gt; adduid

&lt;span class=&quot;c&quot;&gt;# follow prompts, finish with `save`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;My key now has both my personal and work e-mail addresses.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--list-secret-keys&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--keyid-format&lt;/span&gt; LONG
/Users/dblock/.gnupg/pubring.kbx
&lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
sec   rsa2048/75BF031B7C94E183 2013-12-24 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;SC]
      4A720FE790B07A68744E371675BF031B7C94E183
uid                 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ultimate] Daniel Doubrovkine &amp;lt;dblock[at]amazon.com&amp;gt;
uid                 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ultimate] Daniel Doubrovkine &amp;lt;dblock[at]dblock.org&amp;gt;
ssb   rsa2048/960955779E55310A 2013-12-24 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;E]&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I then exported the public key with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpg -a --export 3AA5C34371567BD2&lt;/code&gt; and &lt;a href=&quot;https://docs.github.com/en/articles/adding-a-new-gpg-key-to-your-github-account&quot;&gt;added it to my Github account&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;signing-git-commits&quot;&gt;Signing Git Commits&lt;/h3&gt;

&lt;p&gt;I wanted to enable commit signing globally to avoid having to constantly appenad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-S&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git commit&lt;/code&gt;, and &lt;a href=&quot;https://github.com/dblock/dotfiles/commit/073adde3335182ce33625951c84a8431adea8256&quot;&gt;added the following settings to my dotfiles&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# make GPG work&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;GPG_TTY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tty&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# use my key to sign all commits&lt;/span&gt;
git config &lt;span class=&quot;nt&quot;&gt;--global&lt;/span&gt; user.signingkey 75BF031B7C94E183
&lt;span class=&quot;c&quot;&gt;# automatically sign all commits&lt;/span&gt;
git config &lt;span class=&quot;nt&quot;&gt;--global&lt;/span&gt; commit.gpgsign &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;checking-it-out&quot;&gt;Checking it Out&lt;/h3&gt;

&lt;p&gt;Commit signatures appear in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git log --show-signature&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;~/source/dotfiles &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;master&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--show-signature&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
commit 073adde3335182ce33625951c84a8431adea8256 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;HEAD -&amp;gt; master, origin/master, origin/HEAD&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
gpg: Signature made Thu Apr 15 18:19:41 2021 EDT
gpg:                using RSA key 4A720FE790B07A68744E371675BF031B7C94E183
gpg: Good signature from &lt;span class=&quot;s2&quot;&gt;&quot;Daniel Doubrovkine &amp;lt;dblock[at]amazon.com&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ultimate]
gpg:                 aka &lt;span class=&quot;s2&quot;&gt;&quot;Daniel Doubrovkine &amp;lt;dblock[at]dblock.org&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ultimate]
Author: dblock &amp;lt;dblock[at]amazon.com&amp;gt;
Date:   Thu Apr 15 18:19:41 2021 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt;

    Installing GPG keys.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And you can see a nice icon next to verified commits on GitHub!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://code.dblock.org/images/posts/2021/2021-04-16-adding-work-email-to-a-gpg-key-and-signing-git-commits/verified.gif&quot; alt=&quot;verified&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now, how do I get verified &lt;a href=&quot;https://twitter.com/dblockdotorg&quot;&gt;on Twitter&lt;/a&gt;?!&lt;/p&gt;

&lt;h3 id=&quot;passphrase&quot;&gt;Passphrase&lt;/h3&gt;

&lt;p&gt;I find it annoying to have to re-enter the passphrase every few minutes. Put the following into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.gnupg/gpg-agent.conf&lt;/code&gt; to set the timeout to a day’s worth.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;default-cache-ttl 86400&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Restart &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpgagent&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpgconf --kill gpg-agent&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h3&gt;

&lt;p&gt;If you’re having trouble with gog, try &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo &quot;test&quot; | gpg --clearsign&lt;/code&gt; to get a better error. If it complains that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpg-agent&lt;/code&gt; is not started, run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gpgagent&lt;/code&gt; and correct any errors.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/04/16/adding-work-email-to-a-gpg-key-and-signing-git-commits.html&quot;&gt;Adding Work E-Mail to a GPG Key and Signing Git Commits&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on April 16, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[How I Minted My First Generative Art NFT]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2021/03/20/how-i-minted-my-first-generative-art-nft.html">
  <id>https://code.dblock.org/2021/03/20/how-i-minted-my-first-generative-art-nft</id>
  <published>2021-03-20T00:00:00+00:00</published>
  <updated>2021-03-20T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I’ve long watched my inspiring friends make generative art and mint NFTs. I own a handful of works on paper by &lt;a href=&quot;https://linktr.ee/dmitricherniak&quot;&gt;Dmitri Cherniak&lt;/a&gt;, and we’ve &lt;a href=&quot;https://www.instagram.com/p/BtuX53IHMBx/&quot;&gt;briefly collaborated in 2019&lt;/a&gt; - Dmitri made digital works, and I drew a smaller set inspired by his output. I really enjoyed observing his process, and thought about trying making digital drawings myself, but then I stubbornly stuck to making my own works on paper. Dmitri’s recent success with &lt;a href=&quot;https://opensea.io/assets/art-blocks?search%5BstringTraits%5D%5B0%5D%5Bname%5D=Ringers&amp;amp;search%5BstringTraits%5D%5B0%5D%5Bvalues%5D%5B0%5D=All%20Ringers&quot;&gt;Ringers&lt;/a&gt; selling at crazy prices was not overnight. He has long made, and believed in generative art, he’s a true artist that doesn’t care much about commercial success. Nevertheless, the $ outcomes are worthy of a mention, his art is now being recognized by collectors outside of the traditional gallery system.&lt;/p&gt;

&lt;p&gt;Last week, after listening to a conversation with &lt;a href=&quot;https://twitter.com/osinachiart&quot;&gt;Osinachi&lt;/a&gt;, an incredibly inspiring Nigerian artist that has been minting NFTs for a while, I finally decided to give generative art NFTs a go.&lt;/p&gt;

&lt;p&gt;You can buy one of the works &lt;a href=&quot;https://opensea.io/collection/generative-sanguines&quot;&gt;here&lt;/a&gt;, until they sell out. &lt;strong&gt;Update&lt;/strong&gt;: works 1-6 have sold as of March 24th, 2021.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/dblock/p5art/master/shape.gif&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here’s the technicalities of how I minted my first NFTs.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;I started with &lt;a href=&quot;https://github.com/Gaweph/p5-typescript-starter&quot;&gt;p5-typescript-starter&lt;/a&gt;, including &lt;a href=&quot;https://github.com/Gaweph/p5-typescript-starter/pull/14&quot;&gt;fixing a typo&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Found inspiration in my own &lt;a href=&quot;https://www.instagram.com/p/B9etMYGnMQ3/&quot;&gt;existing paper drawing&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Reproduced the sanguine (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;color('#850505')&lt;/code&gt;) shape &lt;a href=&quot;https://github.com/dblock/p5art/blob/master/sketch/sketch.ts#L28&quot;&gt;in code&lt;/a&gt;, using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;quad&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Animated 10 frames and saved them to files using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;saveCanvas&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Created &lt;a href=&quot;https://opensea.io/collection/generative-sanguines&quot;&gt;a collection on OpenSea&lt;/a&gt;. Each work is a unique result of a different frame.&lt;/li&gt;
  &lt;li&gt;Bought $200 worth of ETH on Coinbase, and moved it to OpenSea to pay gas on some wallet initialization process.&lt;/li&gt;
  &lt;li&gt;Listed &lt;a href=&quot;https://opensea.io/assets/0x495f947276749ce646f68ac8c248420045cb7b5e/48718886585399041049872855307944290111042886289234588241181420742469385977857&quot;&gt;work 1/10&lt;/a&gt; in an auction, and sold my first NFT to my first bidder, someone I don’t know!&lt;/li&gt;
  &lt;li&gt;In hindsight listing as an auction was a mistake because the seller ends up paying gas fees, which are high, at about $50 per transaction. I have since listed, and sold, works 2-6 as “buy now” for a fixed price. Buyer pays gas fee for those to complete.&lt;/li&gt;
&lt;/ol&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2021/03/20/how-i-minted-my-first-generative-art-nft.html&quot;&gt;How I Minted My First Generative Art NFT&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on March 20, 2021.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[How to tell an Engineer to avoid the weasel word "like"]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/12/28/how-to-tell-an-engineer-to-avoid-the-weasel-word-like.html">
  <id>https://code.dblock.org/2020/12/28/how-to-tell-an-engineer-to-avoid-the-weasel-word-like</id>
  <published>2020-12-28T00:00:00+00:00</published>
  <updated>2020-12-28T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I had a telecom professor in college that said “Euuuuh” every other word during lectures. It was impossible not to notice, and I couldn’t focus on the content anymore. So I counted the “Euuuuh”’s to pass time. The record sat around 150 “Euuuuh” per hour.&lt;/p&gt;

&lt;p&gt;Fast forward to 2020. My speaking and writing have both significantly improved since I joined AWS. I am more concise, making arguments in fewer words. I’ve worked hard on replacing opinions with data. But while I have made progress, I’ve also become more allergic to the worst offenders in weasel and filler words in conversations with fellow Engineers, starting with “like”.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;At 33% this spline is, &lt;strong&gt;like&lt;/strong&gt;, poorly reticulated.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I’m fuming. Instinctively, I start counting the “likes”. I no longer pay attention to the content.&lt;/p&gt;

&lt;p&gt;So how do you tell an otherwise very competent Engineer to avoid saying “like”? Just telling them has not always been effective - they quickly agree, try to swipe it under the rug, and do it again. Thus, I devised a better approach.&lt;/p&gt;

&lt;p&gt;People that say &lt;em&gt;like&lt;/em&gt; a lot will do it often. I choose to wait for a particularly successful meeting that the individual runs, compliment the content presented, and recommend an improvement around &lt;em&gt;public speaking&lt;/em&gt; that is not exclusively centered on the weasel or filler word itself, explain why, and offer myself up as a former public offender.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;I thought you did a great job with the document presented yesterday at office hours. The design was at the right abstraction level, and was super clear. This was a multi-dimensional, complex problem, and you did a tremendous job spelling out the technical options for the group with well-researched supporting data. The solution you came up with was solid.&lt;/p&gt;

  &lt;p&gt;I wanted to give you feedback to help you deliver such excellent content better. I recommend working on improving your public speaking in the following areas: 1) you should be able to speak with a lot more confidence 2) you really, really need to cut filler words such as “like” out. The last one is really dumb, but important.  Every time you add “like”, you dilute an otherwise on-point message.&lt;/p&gt;

  &lt;p&gt;I had the same problem, too. What helped was to write the word “like” on a piece of paper and stick it on my monitor to remind myself not to say it during meetings.&lt;/p&gt;

  &lt;p&gt;Hope this helps!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So far I’ve sent a version of this advice to a dozen people. Everyone responded positively. I have noticed a lot of progress in the team to weed “likes” out. I really like it!&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/12/28/how-to-tell-an-engineer-to-avoid-the-weasel-word-like.html&quot;&gt;How to tell an Engineer to avoid the weasel word &quot;like&quot;&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on December 28, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Migrating Classic Slack Ruby Bots to Granular Permissions]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/11/30/migrating-classic-slack-ruby-bots-to-granular-permissions.html">
  <id>https://code.dblock.org/2020/11/30/migrating-classic-slack-ruby-bots-to-granular-permissions</id>
  <published>2020-11-30T00:00:00+00:00</published>
  <updated>2020-11-30T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;Slack recently &lt;a href=&quot;https://medium.com/slack-developer-blog/more-precision-less-restrictions-a3550006f9c3&quot;&gt;introduced granular permissions&lt;/a&gt; and is now requiring all new apps to use those. The old apps are called &lt;em&gt;classic&lt;/em&gt; apps, and new apps are called … apps. Slack also provided a &lt;a href=&quot;https://api.slack.com/authentication/migration&quot;&gt;migration guide&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;As of December 4th, 2020 Slack no longer accept resubmissions from apps that are not using granular permissions. On November 18, 2021 Slack will start delisting apps that have not migrated to use granular permissions. So you better get going with a migration ASAP.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I found the migration quite challenging for my &lt;a href=&quot;https://www.vestris.com&quot;&gt;many real-time bots&lt;/a&gt; with existing customers. New bots cannot use real-time, and there’s no way to automatically migrate existing installations - users must reinstall a newer version of the bot. I chose to avoid a data migration and picked a path of upgrading the bot to granular permissions, then operating both the old and the new version on top of the same database.&lt;/p&gt;

&lt;p&gt;To support migrations I’ve recently extracted &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server-rtm&quot;&gt;slack-ruby-bot-server-rtm&lt;/a&gt; out of &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server&quot;&gt;slack-ruby-bot-server&lt;/a&gt;, and created &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server-events&quot;&gt;slack-ruby-bot-server-events&lt;/a&gt; for handling events with granular permissions. I’ve also implemented &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server-events-app-mentions&quot;&gt;slack-ruby-bot-server-events-app-mentions&lt;/a&gt; to help migrate existing slack-ruby-bot commands.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The migration effectively involves replacing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;slack-ruby-bot-server-rtm&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;slack-ruby-bot-server-events&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;upgrade-to-slack-ruby-bot-server-120-and-slack-ruby-bot-server-rtm&quot;&gt;Upgrade to Slack-Ruby-Bot-Server 1.2.0 and Slack-Ruby-Bot-Server-Rtm&lt;/h3&gt;

&lt;p&gt;Upgrade to the latest version of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;slack-ruby-bot-server-rtm&lt;/code&gt; , which extracts real-time components. Practically, replace &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SlackRubyBotServer::Server&lt;/code&gt; by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SlackRubyBotServer::RealTime::Server&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Upgrade to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;slack-ruby-bot-server&lt;/code&gt; 1.2.0. This version introduces two new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Team&lt;/code&gt; fields, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;oauth_version&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;oauth_scope&lt;/code&gt; to store which version of the bot performed the install. This allows slack-ruby-bot-server-rtm to ignore newer bots and only boot RTM for legacy bots.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server/blob/master/UPGRADING.md#upgrading-to--120&quot;&gt;UPGRADING&lt;/a&gt; for more information on ActiveRecord database migrations.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/slack-ruby/slack-shellbot/commit/db40cb592a3416ce1bd04bb04dd5828c33adc6d7&quot;&gt;slack-shellbot@db40cb59&lt;/a&gt; and &lt;a href=&quot;https://github.com/slack-ruby/slack-shellbot/commit/bda862ced477d57d720f885703435b1eb3819f0e&quot;&gt;slack-shell@bda862ce&lt;/a&gt; for an example.&lt;/p&gt;

&lt;p&gt;Deploy your bot and make sure everything is working without any changes.&lt;/p&gt;

&lt;h3 id=&quot;create-a-new-slack-app&quot;&gt;Create a New Slack App&lt;/h3&gt;

&lt;p&gt;In order not to affect existing users, &lt;a href=&quot;https://api.slack.com/apps&quot;&gt;create a new Slack app&lt;/a&gt; with new granular permissions and scopes. For example, to send messages to Slack you will need &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chat:write&lt;/code&gt;. To read messages in public channels, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;channels:history&lt;/code&gt;. To receive bot mentions you’ll need &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;app_mentions:read&lt;/code&gt; and to receive DMs, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;im:history&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;respond-to-slack-events&quot;&gt;Respond to Slack Events&lt;/h3&gt;

&lt;h4 id=&quot;app-mentions&quot;&gt;App Mentions&lt;/h4&gt;

&lt;p&gt;A typical bot may want to respond to mentions, which is made very easy by the new &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server-events-app-mentions&quot;&gt;slack-ruby-bot-server-events-app-mentions&lt;/a&gt; gem.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;SlackRubyBotServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;oauth_version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:v2&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;oauth_scope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'app_mentions:read'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'im:history'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'chat:write'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ping&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;SlackRubyBotServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AppMentions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Mention&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;mention&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ping'&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Slack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Web&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;token: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;team&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;chat_postMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;channel: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;channel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;text: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'pong'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;See a &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server-events-app-mentions-sample&quot;&gt;complete sample&lt;/a&gt; for more details.&lt;/p&gt;

&lt;h4 id=&quot;other-messages&quot;&gt;Other Messages&lt;/h4&gt;

&lt;p&gt;More advanced bots may want to handle all kinds of messages. For example, &lt;a href=&quot;https://github.com/slack-ruby/slack-shellbot/pull/22&quot;&gt;slack-shellbot#22&lt;/a&gt; configures scopes to receive the kitchen sink of events, then handles them carefully avoiding handling its own messages.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;SlackRubyBotServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;oauth_version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:v2&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;oauth_scope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'chat:write'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'im:history'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'mpim:history'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'channels:history'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'groups:history'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;SlackRubyBotServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'event_callback'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'message'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# SlackShellbot::Commands::Base.logger.info event&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;next&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'event'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'subtype'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# updates, etc.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;next&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'authorizations'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'user_id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'event'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'user'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# self&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;team&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Team&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;team_id: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'team_id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;first&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;next&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;team&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Slack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Messages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'event'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# handles event data here&lt;/span&gt;

    &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;deploy&quot;&gt;Deploy&lt;/h3&gt;

&lt;p&gt;Create a new app deployment, use the same database as your production bot. I operate my bots on Digital Ocean and follow &lt;a href=&quot;/2016/02/08/running-slack-bots-on-digital-ocean-with-dokku.html&quot;&gt;this post&lt;/a&gt;. The new bot needs a configuration with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLACK_CLIENT_ID&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLACK_CLIENT_SECRET&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLACK_SIGNING_SECRET&lt;/code&gt; from the new app with granular permissions. I use the same database as my old RTM bot. Deploy the new app.&lt;/p&gt;

&lt;p&gt;Now there are two versions of the app running on top of the same database: one is the legacy one, and the other is the granular scopes app. The old app will ignore new bot installations that use granular permissions. The new app should ignore any old bot installations. Thus both apps should work.&lt;/p&gt;

&lt;h3 id=&quot;switch-dns&quot;&gt;Switch DNS&lt;/h3&gt;

&lt;p&gt;Switch DNS, new bot registrations can use the new granular scopes app. Make sure in Slack the event URLs are configured properly to point to this DNS.&lt;/p&gt;

&lt;h3 id=&quot;slow-migration-for-existing-teams&quot;&gt;Slow Migration for Existing Teams&lt;/h3&gt;

&lt;p&gt;Existing teams can uninstall the old bot and re-install the new one. The old real-time implementation will stop working once the token has been switched, but the data will remain intact and the team will get reactivated using the new bot with granular permissions.&lt;/p&gt;

&lt;h3 id=&quot;upgraded-apps&quot;&gt;Upgraded Apps&lt;/h3&gt;

&lt;p&gt;So far I’ve upgraded &lt;a href=&quot;https://github.com/slack-ruby/slack-shellbot&quot;&gt;slack-shellbot&lt;/a&gt;. The new version is available at &lt;a href=&quot;https://shell.playplay.io&quot;&gt;shell.playplay.io&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Leave comments on this migration guide here, or in &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server/issues/134&quot;&gt;slack-ruby-bot-server#134&lt;/a&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/11/30/migrating-classic-slack-ruby-bots-to-granular-permissions.html&quot;&gt;Migrating Classic Slack Ruby Bots to Granular Permissions&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on November 30, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Dup, Don't Modify Input Hash Parameters in Ruby]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/11/11/dup-dont-modify-input-hash-parameters-in-ruby.html">
  <id>https://code.dblock.org/2020/11/11/dup-dont-modify-input-hash-parameters-in-ruby</id>
  <published>2020-11-11T00:00:00+00:00</published>
  <updated>2020-11-11T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;We often write Ruby functions that take an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;options&lt;/code&gt; Hash, remove some of its values, then pass the hash further down. Unfortunately we also often &lt;a href=&quot;https://github.com/dblock/iex-ruby-client/pull/94#discussion_r520637150&quot;&gt;introduce a very difficult to catch bug&lt;/a&gt;. Here’s why you always want to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dup&lt;/code&gt; input options in Ruby that come in as a Hash.&lt;/p&gt;

&lt;p&gt;Consider the following example from &lt;a href=&quot;https://github.com/dblock/iex-ruby-client&quot;&gt;iex-ruby-client&lt;/a&gt;. We pluck &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;range&lt;/code&gt; out of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;options&lt;/code&gt; to use in an HTTP request path, then pass the rest of the options as query string parameters. We want to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.delete&lt;/code&gt; the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;range&lt;/code&gt; key to avoid passing its value further down because the API does not expect it, and could have all kinds of unfortunate side-effects. We also don’t know all the possible arguments to the API, especially not the future ones, as we want to be forward-compatible.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;historical_prices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{})&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;stock/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/chart&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;key?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Seems innocent enough. But consider this code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;range: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'year'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;msft_prices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;historical_prices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'MSFT'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;goog_prices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;historical_prices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'GOOG'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can see the problem: the second call to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;historical_prices&lt;/code&gt; has incorrect options as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;range&lt;/code&gt; was removed by the first call. Here’s a fix.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;historical_prices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{})&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dup&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;stock/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/chart&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;key?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can optimize a little to avoid &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.dup&lt;/code&gt; in all cases, but I don’t think it’s worth it because it does not provide any meaningful performance improvement unless the function gets called a lot.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;historical_prices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{})&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;stock/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/chart&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;key?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dup&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If you use Rails, you can use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;except&lt;/code&gt;. I like how clean this is.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;historical_prices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{})&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;stock/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbol&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/chart&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;key?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Lastly, both &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.dup&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.clone&lt;/code&gt; are both shallow, but that doesn’t matter as long as you only use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.delete&lt;/code&gt; and remove values. If you were to modify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;options&lt;/code&gt; Hash in any other way, you may need to &lt;a href=&quot;https://apidock.com/rails/Hash/deep_dup&quot;&gt;deep_dup&lt;/a&gt; it instead. So, don’t modify an object that your method doesn’t own and remember that Ruby passes objects such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hash&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Array&lt;/code&gt; by reference, and not by value into functions.&lt;/p&gt;

&lt;p&gt;All that said, if you know the finite list of parameters to your functions, use &lt;a href=&quot;https://thoughtbot.com/blog/ruby-2-keyword-arguments&quot;&gt;Ruby 2 Keyword Arguments&lt;/a&gt; instead.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/11/11/dup-dont-modify-input-hash-parameters-in-ruby.html&quot;&gt;Dup, Don't Modify Input Hash Parameters in Ruby&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on November 11, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Keeping a CHANGELOG at Work]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/09/01/keep-a-changelog-at-work.html">
  <id>https://code.dblock.org/2020/09/01/keep-a-changelog-at-work</id>
  <published>2020-09-01T00:00:00+00:00</published>
  <updated>2020-09-01T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;What did you do at work today? How about last week? I spent a couple of days in quarterly business reviews, and wrapped up yearly planning activities for AWS Data Exchange and AWS Marketplace. I also added some unit tests to a project that I am onboarding into.&lt;/p&gt;

&lt;p&gt;Since my first day in AWS, just over a year ago, I’ve been experimenting with keeping a CHANGELOG of everything I do, available for everyone at the company to see. I think you should too!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://code.dblock.org/images/posts/2020/2020-09-01-keep-a-changelog-at-work/changelog.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Keeping track of humanly readable changes in the open-source world has been a long established best practice. It shows that maintainers truly care about customers - making it accessible and easy to understand the changes across multiple releases. As a user, I can find out how changes will affect my application when upgrading, without having to engage a human. I can track down a regression, or an improvement. CHANGELOGs promote transparency, improve clarity and, in the long run, increase trust in the work of others.&lt;/p&gt;

&lt;p&gt;My customers are AWS customers, but also developers and managers that I work with. Keeping a CHANGELOG has helped me earn their trust. In general, earning trust is one of the most challenging things to do. Trust is slowly won, and quickly lost. Earning trust is uniquely difficult in more senior engineering roles, as the scope of your work grows, the nature of the work becomes more independent, and results are often delivered over longer timeframes.&lt;/p&gt;

&lt;p&gt;So far, keeping a personal CHANGELOG has had several clear benefits.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;My 1:1s have gotten to be a lot more productive. All my 1:1s, including with my manager, begin by having them read my CHANGELOG since our last 1:1. This gives them the opportunity to quickly gather context, immediately see what I have been working on, understand what’s going on in my world, and quickly get to more meaty conversations.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;My CHANGELOG helped a lot of new Engineers joining the organization. Many have said that my early CHANGELOG entries were helpful to understand what one actually does during their first weeks at Amazon. For example, I spent a huge amount of hours in training, set up a laptop backup drive, and made my first non-trivial code change during week 2.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;My CHANGELOG serves as a personal wiki and reference. I often need to refer to an existing document, person or conversation. Remember reading a document last week? I know exactly where to find that link!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;My CHANGELOG serves as an internal motivator. It helps me to be honest with myself, and gives me data that helps me reflect on how much busy work I do vs. “actual” work and teaches me where and how I can learn and improve.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So how do I actually keep a CHANGELOG? I keep a yellow sticky note to which I add items during the week, then copy-paste it into a Wiki every Monday. I always pay attention not to include any confidential information, such as names of candidates interviewing with AWS or referring to customers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://code.dblock.org/images/posts/2020/2020-09-01-keep-a-changelog-at-work/onboarding.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If you start a CHANGELOG, tell me about it!&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/09/01/keep-a-changelog-at-work.html&quot;&gt;Keeping a CHANGELOG at Work&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on September 01, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Calling a GraphQL API in Redwood.js]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/08/27/calling-a-graphql-api-in-redwood-js.html">
  <id>https://code.dblock.org/2020/08/27/calling-a-graphql-api-in-redwood-js</id>
  <published>2020-08-27T00:00:00+00:00</published>
  <updated>2020-08-27T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I recently needed to stand up a demo app that invoked an &lt;a href=&quot;https://aws.amazon.com/appsync/&quot;&gt;AWS AppSync&lt;/a&gt; GraphQL API. The existing endpoint (not available publicly) returned restaurant data for a given zip with the following schema.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ZipData&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;timezone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;RestaurantData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;RestaurantData&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;latitude&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;longitude&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;get_restaurants_by_zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ZipData&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Query&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The app I wanted to build was throwaway, and my goal was to make it happen effortlessly, during a single lunch break. I was told to try &lt;a href=&quot;https://redwoodjs.com/&quot;&gt;Redwood.js&lt;/a&gt;, &lt;a href=&quot;https://aws.amazon.com/amplify/&quot;&gt;AWS Amplify&lt;/a&gt;, &lt;a href=&quot;https://www.sanity.io/&quot;&gt;Sanity.io&lt;/a&gt;, &lt;a href=&quot;https://nextjs.org/&quot;&gt;Next.js&lt;/a&gt; via &lt;a href=&quot;https://github.com/prisma/prisma-examples&quot;&gt;prisma-examples&lt;/a&gt;, and some zero-code tools, including &lt;a href=&quot;https://retool.com/&quot;&gt;ReTool&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;redwoodjs&quot;&gt;Redwood.js&lt;/h2&gt;

&lt;p&gt;Let’s start with Redwood.js …&lt;/p&gt;

&lt;h3 id=&quot;create-an-app&quot;&gt;Create an App&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nvm use 12
yarn create redwood-app ./redwood-js-appsync-graphql-demo
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ./redwood-js-appsync-graphql-demo&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;add-a-homepage&quot;&gt;Add a Homepage&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yarn redwood generate page home /&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;add-an-input-box-for-the-zip-code&quot;&gt;Add an Input Box for the Zip Code&lt;/h3&gt;

&lt;p&gt;When the form is submitted, state (including zip code) will change.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-react&quot; data-lang=&quot;react&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Link&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;routes&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;@redwoodjs/router&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;useState&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;react&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TextField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Submit&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;@redwoodjs/forms&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;HomePage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setZip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;onSubmit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;setZip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onSubmit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onSubmit&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;TextField&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zip&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Zip code&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;maxLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;5&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Submit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;Go&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Submit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;HomePage&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;add-graphql-request&quot;&gt;Add graphql-request&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yarn add &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; graphql-request&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;add-the-graphql-query&quot;&gt;Add the GraphQL Query&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-react&quot; data-lang=&quot;react&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;GraphQLClient&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;graphql-request&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getRestaurantsByZip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;endpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;APPSYNC_API_ENDPOINT_URL&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;graphQLClient&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;GraphQLClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;endpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;x-api-key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;APPSYNC_API_KEY&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`query GetZip($zip: String!) {
    get_restaurants_by_zip(zip: $zip) {
      zip
      timezone
      restaurants {
        name
      }
    }
  }`&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;graphQLClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;wire-up-graphql-results&quot;&gt;Wire Up GraphQL Results&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-react&quot; data-lang=&quot;react&quot;&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;onSubmit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;getRestaurantsByZip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;setZip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get_restaurants_by_zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    ...
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timezone&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;not-taking-advantage-of-redwoodjs&quot;&gt;Not Taking Advantage of Redwood.js&lt;/h3&gt;

&lt;p&gt;So far I used Redwood.js similarly to how one would use Rails without models, views or controllers, just to host some Ruby code on a web page. Redwood has lots of features, including cells and side-loading. Seems like a missed opportunity! So I asked the Redwood.js community to &lt;a href=&quot;https://community.redwoodjs.com/t/how-can-i-wire-up-a-graphql-api-to-redwoodjs/1112&quot;&gt;help me leverage Redwood.js better&lt;/a&gt;. The answer is more generally described in the documentation under &lt;a href=&quot;https://redwoodjs.com/cookbook/using-a-third-party-api#server-side-api-integration&quot;&gt;Server-Side API Integration&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;expose-restaurants-side-loading&quot;&gt;Expose Restaurants Side-Loading&lt;/h3&gt;

&lt;p&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;api/src/graphql/restaurants.sdl.js&lt;/code&gt; with the schema that our Redwood.js service will return.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;graphql-tag&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`
  type Restaurant {
    name: String
    longitude: String
    latitude: String
  }
  type Zip {
    zip: String
    timezone: String
    restaurants: [Restaurant]
  }
  type Query {
    restaurants(zip: String!): Zip
  }
`&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;fetch-data-from-the-appsync-api&quot;&gt;Fetch Data from the AppSync API&lt;/h3&gt;

&lt;p&gt;Wire up calls to the AppSync endpoint in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;api/src/lib/db.js&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;GraphQLClient&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;graphql-request&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;endpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;APPSYNC_API_ENDPOINT_URL&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;graphQLClient&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;GraphQLClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;endpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;x-api-key&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;APPSYNC_API_KEY&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;graphQLClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;api/src/services/restaurants.js&lt;/code&gt; that loads restaurant data using the above endpoint.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;src/lib/db&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;graphql-request&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`query GetZip($zip: String!) {
    get_restaurants_by_zip(zip: $zip) {
      zip
      timezone
      restaurants {
        name
        longitude
        latitude
      }
    }
  }`&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get_restaurants_by_zip&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;add-a-restaurants-cell&quot;&gt;Add a Restaurants Cell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yarn redwood generate cell restaurants&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The cell makes a query to the Redwood.js service to fetch restaurants.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-react&quot; data-lang=&quot;react&quot;&gt;&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;QUERY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`query($zip: String!) {
  restaurants(zip: $zip) {
    zip
    timezone
    restaurants {
      name
      longitude
      latitude
    }
  }
}`&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Loading&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;Loading ...&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Empty&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;No zip yet!&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;Error loading zip &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;: &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timezone&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;h3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;restaurants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Wire up the cell in the homepage.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-react&quot; data-lang=&quot;react&quot;&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;HomePage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;setZip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;onSubmit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;setZip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zipCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RestaurantsCell&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;put-it-all-together&quot;&gt;Put it All Together&lt;/h3&gt;

&lt;p&gt;Create a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.env&lt;/code&gt; file with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;APPSYNC_API_ENDPOINT_URL&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;APPSYNC_API_KEY&lt;/code&gt; and run the app with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yarn redwood dev&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/dblock/redwood-js-appsync-graphql-demo&quot;&gt;github.com/dblock/redwood-js-appsync-graphql-demo&lt;/a&gt; for the complete, working code, along with some Google maps.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://github.com/dblock/redwood-js-appsync-graphql-demo/raw/master/demo.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/08/27/calling-a-graphql-api-in-redwood-js.html&quot;&gt;Calling a GraphQL API in Redwood.js&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on August 27, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Comparing Version Numbers in Ruby]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/07/16/comparing-version-numbers-in-ruby.html">
  <id>https://code.dblock.org/2020/07/16/comparing-version-numbers-in-ruby</id>
  <published>2020-07-16T00:00:00+00:00</published>
  <updated>2020-07-16T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;Time and &lt;a href=&quot;https://github.com/ruby-grape/grape/pull/2091#discussion_r455763685&quot;&gt;again&lt;/a&gt;, and &lt;a href=&quot;https://github.com/opensearch-project/opensearch-ruby/pull/76#discussion_r910422525&quot;&gt;again&lt;/a&gt;, developers fail to compare gem or ruby version numbers correctly. It’s an easy mistake to make.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2.6.6&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'2.7.7'&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ok&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'2.6.5'&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ok&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'2.10.0'&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ouch&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;to_f&lt;/code&gt; is another common mistake.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2.10.0&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.7&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ouch&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_f&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;There’s a &lt;a href=&quot;https://metaredux.com/posts/2018/10/28/a-better-way-to-compare-versions-in-ruby.html&quot;&gt;great post&lt;/a&gt; that comes up on top of Google that recommends using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Gem::Version&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#&amp;lt;Gem::Version &quot;2.6.6&quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.7.7'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ok&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.5'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ok&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.10.0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ok&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This works correctly, including for pre-release versions.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6.pre1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;However, especially in this last case it may not be what you want. In fact, it’s almost never what you want. Consider the following example with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RUBY_VERSION = 2.6.6.pre1&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# this code works with any 2.6.6, including 2.6.6.pre1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# this code works with 2.6.5 or older&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This doesn’t work because “2.6.6.pre1” is not newer than “2.6.6”.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6.pre1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;
 &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The desired effect can be achieved easily.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;release&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# this code works with any 2.6.6, including 2.6.6.pre1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# this code works with 2.6.5 or older&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another common pattern that I have observed is to check versions at runtime.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;do_something&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;release&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# this code works with any 2.6.6, including 2.6.6.pre1&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# this code works with 2.6.5 or older&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Avoid evaluating this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if&lt;/code&gt; multiple times by declaring different methods depending on the Ruby version.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY_VERSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;release&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2.6.6'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;do_something&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# this code works with any 2.6.6, including 2.6.6.pre1&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;do_something&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# this code works with 2.6.5 or older&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can also hide this implementation detail in some cases using the &lt;a href=&quot;https://github.com/dblock/with-version&quot;&gt;with-version&lt;/a&gt; gem. Consider contributing to support more if-then-else scenarios.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;with_minimum_ruby&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'2.6.6'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# this code works with 2.6.6 or newer, including 2.6.6.pre1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;


  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/07/16/comparing-version-numbers-in-ruby.html&quot;&gt;Comparing Version Numbers in Ruby&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on July 16, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Using Bash Parameter Expansion for Conditionals in GitHub Actions]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/06/24/using-bash-parameter-expansion-for-conditionals-in-github-actions.html">
  <id>https://code.dblock.org/2020/06/24/using-bash-parameter-expansion-for-conditionals-in-github-actions</id>
  <published>2020-06-24T00:00:00+00:00</published>
  <updated>2020-06-24T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I am late to using GitHub Actions for CI, and immediately ran into an issue trying to figure out how to conditionally install a different version of Bundler for a certain version of Rails in &lt;a href=&quot;https://github.com/radar/distance_of_time_in_words/pull/104&quot;&gt;radar/distance_of_time_in_words#104&lt;/a&gt;. Bundler 2.x doesn’t work with Rails 4, and needs to be downgraded.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Fetching gem metadata from http://rubygems.org/.............
Fetching gem metadata from http://rubygems.org/.
Resolving dependencies...
Bundler could not find compatible versions &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;gem &lt;span class=&quot;s2&quot;&gt;&quot;bundler&quot;&lt;/span&gt;:
  In rails_4.gemfile:
    bundler

    rails &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;~&amp;gt; 4.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; was resolved to 4.2.11.3, which depends on
      bundler &lt;span class=&quot;o&quot;&gt;(&amp;gt;=&lt;/span&gt; 1.3.0, &amp;lt; 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

  Current Bundler version:
    bundler &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.1.4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I decided to use default Bundler as much as possible, and run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gem install bundler -v 1.17.3&lt;/code&gt; for a certain version of Rails.&lt;/p&gt;

&lt;h3 id=&quot;use-if&quot;&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if:&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;My first solution was to use an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if:&lt;/code&gt; step.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ubuntu-latest&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;strategy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;fail-fast&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;false&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ruby-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.6.x&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ruby-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.4.x&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;bundler-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;1.17.3&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;gemfile&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;gemfiles/rails_4.gemfile&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/checkout@v2&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Set up Ruby&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/setup-ruby@v1&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;ruby-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.ruby-version }}&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install Bundler&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.bundler-version }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;gem uninstall bundler&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;gem install bundler -v ${{ matrix.bundler-version }}&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Build and test&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;BUNDLE_GEMFILE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.gemfile }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;bundle install&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;bundle exec rake&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This &lt;a href=&quot;https://github.com/dblock/distance_of_time_in_words/runs/803512680?check_suite_focus=true&quot;&gt;worked&lt;/a&gt; because &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundler&lt;/code&gt; was installed by default.&lt;/p&gt;

&lt;h3 id=&quot;use-another-if&quot;&gt;Use another &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if:&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;Using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if:&lt;/code&gt; to install a non-default version of Bundler will suddenly break when some future run uses a newer, default, version of Bundler that breaks everything. We can craft another &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if:&lt;/code&gt; to install a specific version or, for now, display the default version of Bundler.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Use Default Bundler&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ !matrix.bundler-version }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;bundler --version&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install Custom Bundler&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.bundler-version }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;gem uninstall bundler&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;gem install bundler -v ${{ matrix.bundler-version }}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This &lt;a href=&quot;https://github.com/dblock/distance_of_time_in_words/pull/1/checks?check_run_id=803594427&quot;&gt;worked&lt;/a&gt; using the negation operator &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;!&lt;/code&gt;. I do find the lack of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;else:&lt;/code&gt; regrettable.&lt;/p&gt;

&lt;h3 id=&quot;use-bash-parameter-expansion&quot;&gt;Use Bash Parameter Expansion&lt;/h3&gt;

&lt;p&gt;My final and favorite solution is to use &lt;a href=&quot;https://wiki.bash-hackers.org/syntax/pe&quot;&gt;bash parameter expansion&lt;/a&gt;. In Bash you can write &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${BUNDLER:-2.1.4}&lt;/code&gt; which uses the value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$BUNDLER&lt;/code&gt; when available, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2.1.4&lt;/code&gt; otherwise.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ubuntu-latest&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;strategy&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;fail-fast&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;false&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ruby-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.4.x&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ruby-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.4.x&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;bundler-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;1.17.3&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;gemfile&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;gemfiles/rails_4.gemfile&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/checkout@v2&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Set up Ruby&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;actions/setup-ruby@v1&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;ruby-version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.ruby-version }}&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Build and test&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;BUNDLE_GEMFILE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.gemfile }}&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;BUNDLER&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ matrix.bundler-version }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;gem uninstall bundler&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;gem install bundler -v ${BUNDLER:-2.1.4}&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;bundle install --jobs 4 --retry 3&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;bundle exec rake&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I find this pattern quite elegant. To summarize.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Set a variable in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;matrix&lt;/code&gt;, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundler-version: 1.17.3&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Assign it to an environment variable via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;env&lt;/code&gt;, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BUNDLER: $&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Use it with a default value in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;run&lt;/code&gt;, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gem install bundler -v ${BUNDLER:-2.1.4}&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/radar/distance_of_time_in_words/pull/104&quot;&gt;radar/distance_of_time_in_words#104&lt;/a&gt; for more details.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/06/24/using-bash-parameter-expansion-for-conditionals-in-github-actions.html&quot;&gt;Using Bash Parameter Expansion for Conditionals in GitHub Actions&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on June 24, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[I've Asked You to Become an Open-Source Project's Co-Maintainer]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/06/08/i-ve-asked-you-to-become-an-open-source-project-co-maintainer.html">
  <id>https://code.dblock.org/2020/06/08/i-ve-asked-you-to-become-an-open-source-project-co-maintainer</id>
  <published>2020-06-08T00:00:00+00:00</published>
  <updated>2020-06-08T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;If you made any significant, high quality, contribution to one of my open-source projects, and have a decent contribution history on Github, I will ask you to join as a co-maintainer. In some ways, this ask is a non-automated, higher touch, softer implementation of the &lt;a href=&quot;https://github.com/Moya/contributors&quot;&gt;Moya Contributing Guidelines&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You will typically get the following note.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Thanks for the contribution! Would you like to help out with project maintenance? Maybe make the next release?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;For Ruby projects I may add a note along the lines of &lt;em&gt;drop me an email with your rubygems username/email&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Some examples of this in &lt;a href=&quot;https://github.com/ruby-grape/grape/pull/1803#issuecomment-433619949&quot;&gt;grape#1803&lt;/a&gt;, &lt;a href=&quot;https://github.com/dblock/open-weather-ruby-client/pull/20#issuecomment-638265068&quot;&gt;open-weather-ruby-client#20&lt;/a&gt;, &lt;a href=&quot;https://github.com/dblock/iex-ruby-client/pull/63#issuecomment-593147832&quot;&gt;iex-ruby-client#63&lt;/a&gt;, &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-bot-server/pull/95#issuecomment-472461133&quot;&gt;slack-ruby-bot-server#95&lt;/a&gt;, &lt;a href=&quot;https://github.com/mongoid/mongoid-history/pull/202#issuecomment-344092634&quot;&gt;mongoid-history#202&lt;/a&gt;, &lt;a href=&quot;https://github.com/dblock/strava-ruby-cli/pull/5#issuecomment-639440785&quot;&gt;strava-ruby-cli#5&lt;/a&gt;, and &lt;a href=&quot;https://github.com/mongoid/mongoid-scroll/pull/20#issuecomment-373012494&quot;&gt;mongoid-scroll#20&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;why-do-i-ask&quot;&gt;Why do I ask?&lt;/h3&gt;

&lt;p&gt;My goal is to reduce bus factor, and completely work myself out of the maintainer job, especially if I am the only one on record. Adding maintainers distributes workload, and gives opportunity of ownership to a new person that is likely more motivated than me - after all, you’ve just made a significant contribution! In the best case scenario I’ll be able to step back from being the point-person on a project. The worst case is that you will make a release, saving me a little bit of time.&lt;/p&gt;

&lt;p&gt;Some of the best examples of when this worked well include &lt;a href=&quot;https://github.com/michaelherold&quot;&gt;Michael Herold&lt;/a&gt; becoming the de-factor owner of &lt;a href=&quot;https://github.com/hashie/hashie&quot;&gt;Hashie&lt;/a&gt;, a top 100 most popular Ruby gem, and &lt;a href=&quot;https://github.com/dbwiddis&quot;&gt;Daniel Widdis&lt;/a&gt; taking over &lt;a href=&quot;https://github.com/oshi/oshi&quot;&gt;Oshi&lt;/a&gt;, the now-default mechanism for Java projects to obtain OS and hardware information natively.&lt;/p&gt;

&lt;h3 id=&quot;what-are-the-expectations-of-a-new-maintainer&quot;&gt;What are the expectations of a new maintainer?&lt;/h3&gt;

&lt;p&gt;In short, &lt;em&gt;none&lt;/em&gt;. I have no expectations, except not to break things on purpose, help out by sharing some responsibilities, and add more people, especially if I get run over by a bus. You can just be a backup plan. Therefore, I do not expect you to spend any of your time on any of the projects, except if you want to. All my asks are nice-to-have’s, time permitting.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Make releases whenever it feels like it, often self-interested when you need one.&lt;/li&gt;
  &lt;li&gt;Review other people’s pull requests, merge, reject and comment.&lt;/li&gt;
  &lt;li&gt;Pay attention to new issues or questions, comment, resolve, discuss and steward any discussion.&lt;/li&gt;
  &lt;li&gt;Engage future active contributors as maintainers.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;why-should-you-say-yes&quot;&gt;Why should you say “yes”?&lt;/h3&gt;

&lt;p&gt;I think you should say “yes” to joining any well-maintained open-source project as a co-maintainer. Aside of giving back to the community, OSS maintenance is a great learning opportunity. A large part of my own career was been built around work on open-source, mostly on projects that I didn’t start, including Ruby Grape and Hashie. There’s nothing to lose, and a lot to gain in terms of personal and professional development.&lt;/p&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/06/08/i-ve-asked-you-to-become-an-open-source-project-co-maintainer.html&quot;&gt;I've Asked You to Become an Open-Source Project's Co-Maintainer&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on June 08, 2020.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Writing a New OpenWeatherMap.org API Ruby Client]]></title>
 <link rel="alternate" type="text/html" href="https://code.dblock.org/2020/05/17/writing-a-new-openweather-ruby-client.html">
  <id>https://code.dblock.org/2020/05/17/writing-a-new-openweather-ruby-client</id>
  <published>2020-05-17T00:00:00+00:00</published>
  <updated>2020-05-17T00:00:00+00:00</updated>
  <author>
    <name>Daniel Doubrovkine</name>
    <uri>https://code.dblock.org</uri>
    <email>dblock@dblock.org</email>
  </author>
  <content type="html">&lt;p&gt;I have been writing Ruby clients for various services for a few years now using the same pattern described in &lt;a href=&quot;/2018/11/27/writing-a-new-strava-api-ruby-client.html&quot;&gt;Writing a New Strava API Ruby Client&lt;/a&gt;. That itself was built on the experience of &lt;a href=&quot;https://github.com/slack-ruby/slack-ruby-client&quot;&gt;slack-ruby-client&lt;/a&gt; and &lt;a href=&quot;https://github.com/dblock/iex-ruby-client&quot;&gt;iex-ruby-client&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A couple of weeks ago I took to &lt;a href=&quot;https://openweathermap.org/api&quot;&gt;OpenWeatherMap.org&lt;/a&gt;’s with &lt;a href=&quot;https://github.com/dblock/open-weather-ruby-client&quot;&gt;open-weather-ruby-client&lt;/a&gt;. I’m now &lt;a href=&quot;https://github.com/dblock/slack-strava/pull/88&quot;&gt;using it&lt;/a&gt; in &lt;a href=&quot;https://slava.playplay.io&quot;&gt;Slava&lt;/a&gt; to fetch weather during a Strava activity.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;OpenWeather&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;api_key: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;...&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;current_weather&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;city: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'London'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; OpenWeather::Models::City::Weather&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Returns basic weather information.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 'London'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; Time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;feels_like&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 277.73&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;humidity&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 81&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pressure&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1005&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 283.15, degrees Kelvin&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Has built-in temperature conversion.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;temp_c&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 10, degrees Celcius&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;temp_f&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 50.0, degrees Farenheit&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And can return some weather history via the &lt;a href=&quot;https://openweathermap.org/api/one-call-api&quot;&gt;OneCall API&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;one_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;lat: &lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;33.441792&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;lon: &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;94.037689&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;dt: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; OpenWeather::Models::OneCall::Weather&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;lat&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 33.44&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;lon&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; -94.04&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timezone&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 'America/Chicago'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;current&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; OpenWeather::Models::OneCall::CurrentWeather&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;hourly&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; Array[OpenWeather::Models::OneCall::HourlyWeather]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;links&quot;&gt;Links&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/dblock/open-weather-ruby-client&quot;&gt;open-weather-ruby-client&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

  &lt;p&gt;&lt;a href=&quot;https://code.dblock.org/2020/05/17/writing-a-new-openweather-ruby-client.html&quot;&gt;Writing a New OpenWeatherMap.org API Ruby Client&lt;/a&gt; was originally published by Daniel Doubrovkine at &lt;a href=&quot;https://code.dblock.org&quot;&gt;code.dblock.org | tech blog&lt;/a&gt; on May 17, 2020.&lt;/p&gt;</content>
</entry>

</feed>
