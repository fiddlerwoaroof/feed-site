{
  "title":"Using S3 for File Storage in Laravel",
  "date":"2022-11-17T04:11:14.000000Z",
  "author":"Funke Faith Olasupo",
  "id":"https://www.honeybadger.io/blog/laravel-s3/",
  "link":"https://www.honeybadger.io/blog/laravel-s3/",
  "content":"<p>Laravel incorporates a strong file system abstraction that provides simple drivers for working with local filesystems, SFTP, and Amazon S3. This article will explain how to use Amazon Simple Storage Service (S3) for file storage in Laravel. It also provides in-depth foundational knowledge of file systems, Amazon S3 storage, file storage in Laravel, and their relationships. Here are a few things you'll learn:</p>\n\n<ul>\n<li>File systems.</li>\n<li>What is Amazon S3?</li>\n<li>Setting up an Amazon S3 bucket.</li>\n<li>AWS Identity and Access Management (IAM) service.</li>\n<li>Configuring S3 cloud storage credentials.</li>\n<li>File storage with S3 in Laravel.</li>\n</ul>\n\n<h2 id=\"introduction\">Introduction</h2>\n\n<p><a href=\"https://laravel.com/docs/master/filesystem\">Laravel Filesystem</a> provides different drivers to work with, for example, local filesystem, Amazon S3, and Rackspace. These drivers provide a convenient and easy way to upload files locally or on the cloud. For Amazon S3, although the functionality is essentially built into the framework, getting started can be a little disorienting, especially for people who aren't familiar with the AWS suite. To integrate it successfully, we only need our AWS credentials to access the console and create a new S3 bucket.</p>\n\n<h2 id=\"file-systems\">File Systems</h2>\n\n<p>A file system is a mechanism and data structure for controlling how data is saved and accessed. There are numerous types of file systems. Each one has its own structure, logic, and characteristics, such as speed, adaptability, security, and size. Some file systems were created with specific applications in mind. The way files are named, saved, and retrieved from a storage device is defined by a file system. Without a file system, the storage device would have a large chunk of data placed back-to-back and wouldn't be distinguishable.</p>\n\n<h2 id=\"amazon-simple-storage-service-s3\">Amazon Simple Storage Service (S3)</h2>\n\n<p>The Amazon Simple Storage Service (Amazon S3) is a web-based cloud storage service that is scalable, high-speed, and easy to use. On Amazon Web Services, the service is meant for data and application backup and archiving online (AWS). It's an AWS cloud service for storing data in a safe, highly accessible, and redundant manner. Customers of different sizes and sectors utilize it for a variety of purposes, including backup and recovery and data storage for cloud-native applications.</p>\n\n<p>It is a cloud-based object storage service that provides industry-leading scalability, data availability, security, and performance. You can save money, organize data, and establish fine-tuned access restrictions to suit specific business, organizational, and compliance requirements with cost-effective storage classes and easy-to-use administration tools.</p>\n\n<h2 id=\"benefits-of-s3-storage\">Benefits of S3 Storage</h2>\n\n<h3 id=\"versioning\">Versioning</h3>\n\n<p>Versioning allows different variants of a file/object to reside in the same bucket, but it is not enabled by default. If an object is accidentally removed, this allows for a rollback or recovery. S3 will also manage the removal of non-current versions of an object if an object expiration lifecycle policy is implemented.</p>\n\n<h3 id=\"security\">Security</h3>\n\n<p>Thanks to encryption features and access management capabilities, data stored in your AWS S3 environment are protected from unauthorized access. This includes restricting public access to all of your items, at both the bucket and the account level. The security of data stored regionally is ensured by strong authentication.</p>\n\n<h3 id=\"data-redundancy\">Data Redundancy</h3>\n\n<p>AWS S3 maintains your data across numerous devices in an S3 region that spans at least three availability zones (AZs). It has reduced redundancy storage (RRS), which minimizes latency by storing data in buckets that are geographically separated. For users in geographically scattered locations, this saves resources and improves application efficiency.</p>\n\n<h3 id=\"accessibility-scalability-and-durability\">Accessibility, Scalability, and Durability</h3>\n\n<p>For things stored in S3, the service guarantees 99.999999999 percent durability and offers several security and compliance certifications. It allows for infinite data and object storage in a number of formats for most data types. A stored dataset, which is an object, ranges from 1 to 5 gigabytes.</p>\n\n<h3 id=\"rest-and-soap-api-interfaces\">REST and SOAP API Interfaces</h3>\n\n<p>S3 storage provides web service interfaces based on representational state transfer (REST) and simple object access protocol (SOAP) that may be used with any form of Web development toolkit.</p>\n\n<h2 id=\"aws-s3-buckets\">AWS S3 Buckets</h2>\n\n<p>A bucket is a box that holds objects. A file and any metadata that describe it are also considered objects. To store an object in Amazon S3, you must first establish a bucket and then upload the object to it. You may open, download, and transfer the object once it's in the bucket. You can clean up your resources when you no longer require an object or a bucket.</p>\n\n<h3 id=\"how-to-create-an-s3-bucket\">How to Create an S3 Bucket</h3>\n\n<ul>\n<li><a href=\"https://signin.aws.amazon.com/\">Log in</a> to your AWS account; if you don’t have one already, sign up for one.</li>\n<li>Proceed to the <a href=\"https://s3.console.aws.amazon.com/s3/home\">S3 section.</a></li>\n<li>Select “Create Bucket”.</li>\n<li>Enter a unique name for your bucket.</li>\n<li>Select a region.</li>\n<li>Uncheck the box to block public access.</li>\n<li>Leave all other default settings unchanged and select “Create”.</li>\n</ul>\n\n<h3 id=\"how-to-create-a-bucket-policy\">How to Create a Bucket Policy</h3>\n\n<p>This is an AWS Identity and Access Management (IAM) policy that is resource-based. To provide other AWS accounts or IAM users access permissions to the bucket and the items within it, you must apply a bucket policy. Object permissions only apply to items created by the bucket owner.</p>\n\n<p>Begin by selecting the bucket.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/bucket.png\" alt=\"Create Bucket\"></p>\n\n<p>Select the “Permissions” tab and then select “Edit“ in the “Bucket Policy“ session.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/permissions.png\" alt=\"Permission\"></p>\n\n<p>Copy Bucket ARN and proceed to the “Policy Generator“.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/bucket_policy.png\" alt=\"ARN\"></p>\n\n<p>Edit the statement. Use the ARN you copied earlier.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/policy_generator.png\" alt=\"Policy Generator\"></p>\n\n<p>Generate the policy document.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/policy_document.png\" alt=\"Policy Document\"></p>\n\n<p>The Policy is generated in JSON format. Copy and paste it into the Bucket Policy tab and save. Ensure that you have unchecked &quot;Block all public access&quot; in the permissions tab before creating the bucket policy.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/policy.png\" alt=\"Policy Document\"></p>\n\n<h2 id=\"aws-identity-and-access-management-iam-service\">AWS Identity and Access Management (IAM) Service</h2>\n\n<p><a href=\"https://aws.amazon.com/iam/\">AWS Identity and Access Management (IAM</a>) allows for fine-grained access management throughout the whole AWS infrastructure. You can control who has access to which services and resources, and under what conditions, using IAM. You can manage permissions to your workforce and systems with IAM policies to ensure least-privilege permissions and easily manage authorized and unauthorized resources.\nYou can manage users and permissions in AWS with AWS Identity and Access Management (IAM). The service is geared towards businesses with a large number of users or systems that use AWS products. Users’ security credentials, such as access keys, and permissions can all be managed from a single location.</p>\n\n<h3 id=\"how-to-create-an-iam-user\">How to Create an IAM User</h3>\n\n<p>If you don’t have an existing user, you can <a href=\"https://console.aws.amazon.com/iamv2/home?region=eu-west-2#/users\">create a new one</a> and add a bucket policy that allows the <a href=\"https://console.aws.amazon.com/iamv2/home?region=eu-west-2#/users\">IAM user to upload to an S3 bucket</a>.</p>\n\n<ul>\n<li>Select “Add User”.</li>\n<li>Add the user name and select the AWS access type.</li>\n<li>Set the password and then proceed to permissions.</li>\n<li>Leave the other default settings unchanged and create the user.</li>\n<li>Save the user’s access key ID and secret access key since the secret access key can only be viewed once.</li>\n</ul>\n\n<h2 id=\"file-storage-with-s3-in-laravel\">File Storage with S3 in Laravel</h2>\n\n<p>Next, you’ll learn how to upload files to S3 in Laravel. It’s important to have created your bucket and IAM user before proceeding. You’ll need the user’s access key ID and secret access key.</p>\n\n<p>Laravel now has a simple method for uploading files to Amazon S3. Because Laravel comes with the setup to use it whenever you want, the approach is really simple. We only need our AWS credentials to access the interface and build a new S3 bucket to integrate it effectively. Doesn’t this seem easy?</p>\n\n<h3 id=\"create-a-new-laravel-application\">Create a New Laravel Application</h3>\n\n<p>You can create a new Laravel project via the Composer command or the Laravel installer:</p>\n<div class=\"highlight\"><pre class=\"highlight shell\"><code>laravel new project_name   \nor\ncomposer create-project laravel/laravel project_name\n</code></pre></div>\n<h3 id=\"add-amazon-s3-cloud-storage-credentials\">Add Amazon S3 Cloud Storage Credentials</h3>\n\n<p>Open the <code>.env</code> file and update the AWS bucket configurations.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"no\">AWS_ACCESS_KEY_ID</span><span class=\"o\">=</span>\n<span class=\"no\">AWS_SECRET_ACCESS_KEY</span><span class=\"o\">=</span>\n<span class=\"no\">AWS_DEFAULT_REGION</span><span class=\"o\">=&lt;</span><span class=\"n\">region_name</span><span class=\"o\">&gt;</span>\n<span class=\"no\">AWS_BUCKET</span><span class=\"o\">=&lt;</span><span class=\"n\">bucket_name</span><span class=\"o\">&gt;</span>\n<span class=\"no\">AWS_USE_PATH_STYLE_ENDPOINT</span><span class=\"o\">=</span><span class=\"kc\">false</span>\n</code></pre></div>\n<p>In <code>conig/filesystems.php</code>, the S3 driver is configured in the <code>s3 array</code> and can be modified to suit your requirements.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"s1\">'s3'</span> <span class=\"o\">=&gt;</span> <span class=\"p\">[</span>\n            <span class=\"s1\">'driver'</span> <span class=\"o\">=&gt;</span> <span class=\"s1\">'s3'</span><span class=\"p\">,</span>\n            <span class=\"s1\">'key'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_ACCESS_KEY_ID'</span><span class=\"p\">),</span>\n            <span class=\"s1\">'secret'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_SECRET_ACCESS_KEY'</span><span class=\"p\">),</span>\n            <span class=\"s1\">'region'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_DEFAULT_REGION'</span><span class=\"p\">),</span>\n            <span class=\"s1\">'bucket'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_BUCKET'</span><span class=\"p\">),</span>\n            <span class=\"s1\">'url'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_URL'</span><span class=\"p\">),</span>\n            <span class=\"s1\">'endpoint'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_ENDPOINT'</span><span class=\"p\">),</span>\n            <span class=\"s1\">'use_path_style_endpoint'</span> <span class=\"o\">=&gt;</span> <span class=\"nf\">env</span><span class=\"p\">(</span><span class=\"s1\">'AWS_USE_PATH_STYLE_ENDPOINT'</span><span class=\"p\">,</span> <span class=\"kc\">false</span><span class=\"p\">),</span>\n        <span class=\"p\">],</span>\n</code></pre></div>\n<h3 id=\"set-up-the-model-and-migrations\">Set Up the Model and Migrations</h3>\n\n<p>Now that we have made the necessary configuration changes, create the model and database migration simultaneously by running the following command:</p>\n<div class=\"highlight\"><pre class=\"highlight shell\"><code>php artisan make:model Image <span class=\"nt\">-m</span>\n</code></pre></div>\n<p>This creates a <a href=\"https://laravel.com/docs/8.x/eloquent\">model</a> file called <em>Image.php</em> in the <em>app/Models</em> directory, and a <a href=\"https://laravel.com/docs/8.x/migrations#introduction\">migration</a> file called <em>create_images_table.php</em> in the <em>database/migrations</em> directory.\nUpdate <em>Images.php</em> by adding the code below to the top of the file, which enables Model <a href=\"https://laravel.com/docs/8.x/eloquent#mass-assignment\">mass assignment</a>.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"k\">protected</span> <span class=\"nv\">$guarded</span> <span class=\"o\">=</span> <span class=\"p\">[];</span>\n</code></pre></div>\n<p>Then, update the <code>up()</code> method of the migration file as shown in the following example.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code> <span class=\"k\">public</span> <span class=\"k\">function</span> <span class=\"n\">up</span><span class=\"p\">()</span>\n    <span class=\"p\">{</span>\n        <span class=\"nc\">Schema</span><span class=\"o\">::</span><span class=\"nf\">create</span><span class=\"p\">(</span><span class=\"s1\">'images'</span><span class=\"p\">,</span> <span class=\"k\">function</span> <span class=\"p\">(</span><span class=\"kt\">Blueprint</span> <span class=\"nv\">$table</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n            <span class=\"nv\">$table</span><span class=\"o\">-&gt;</span><span class=\"nf\">id</span><span class=\"p\">();</span>\n            <span class=\"nv\">$table</span><span class=\"o\">-&gt;</span><span class=\"nf\">string</span><span class=\"p\">(</span><span class=\"s1\">'title'</span><span class=\"p\">);</span>\n            <span class=\"nv\">$table</span><span class=\"o\">-&gt;</span><span class=\"nf\">string</span><span class=\"p\">(</span><span class=\"s1\">'image'</span><span class=\"p\">);</span>\n            <span class=\"nv\">$table</span><span class=\"o\">-&gt;</span><span class=\"nf\">timestamps</span><span class=\"p\">();</span>\n        <span class=\"p\">});</span>\n    <span class=\"p\">}</span>\n</code></pre></div>\n<h3 id=\"connect-to-your-database\">Connect to Your Database</h3>\n\n<p><a href=\"https://dev.to/roxie/how-to-connect-laravel-application-to-mysql-database-5han\">Here</a> is an article I wrote that explains how to <a href=\"https://dev.to/roxie/how-to-connect-laravel-application-to-mysql-database-5han\">connect a Laravel Application to a MySQL database</a>. If you have a different database, make sure to connect to it appropriately.</p>\n\n<h3 id=\"install-the-composer-package\">Install the Composer Package</h3>\n\n<p>Before using the S3 driver, you will need to install the appropriate package via the Composer package manager:</p>\n<div class=\"highlight\"><pre class=\"highlight shell\"><code>composer require <span class=\"nt\">--with-all-dependencies</span> league/flysystem-aws-s3-v3 <span class=\"s2\">&quot;^1.0&quot;</span>\n</code></pre></div>\n<h3 id=\"set-up-the-controller\">Set Up the Controller</h3>\n\n<p>To create the controller, run this Artisan command:</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"n\">php</span> <span class=\"n\">artisan</span> <span class=\"n\">make</span><span class=\"o\">:</span><span class=\"n\">controller</span> <span class=\"nc\">ImageController</span>\n</code></pre></div>\n<p>It will create a new file called <em>ImageController.php</em> in the <em>app/Http/Controllers</em> directory. After creating the file, add the following <code>import</code> statements to import the classes that the controller will use:</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"kn\">use</span> <span class=\"nc\">App\\Models\\Image</span><span class=\"p\">;</span>\n<span class=\"kn\">use</span> <span class=\"nc\">Illuminate\\Http\\Request</span><span class=\"p\">;</span>\n</code></pre></div>\n<p>Next, update the controller with an <code>upload()</code> method to return the form to upload and a <code>store()</code> method to upload the image to S3.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"k\">public</span> <span class=\"k\">function</span> <span class=\"n\">upload</span><span class=\"p\">()</span>\n    <span class=\"p\">{</span>\n        <span class=\"k\">return</span> <span class=\"nf\">view</span><span class=\"p\">(</span><span class=\"s1\">'upload'</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n    <span class=\"k\">public</span> <span class=\"k\">function</span> <span class=\"n\">store</span><span class=\"p\">(</span><span class=\"kt\">Request</span> <span class=\"nv\">$request</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n        <span class=\"nv\">$request</span><span class=\"o\">-&gt;</span><span class=\"nf\">validate</span><span class=\"p\">([</span>\n            <span class=\"s1\">'title'</span> <span class=\"o\">=&gt;</span> <span class=\"s1\">'required'</span><span class=\"p\">,</span>\n            <span class=\"s1\">'image'</span> <span class=\"o\">=&gt;</span> <span class=\"s1\">'required|image|mimes:jpeg,png,jpg,gif,svg|max:2048'</span><span class=\"p\">,</span>\n        <span class=\"p\">]);</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nv\">$request</span><span class=\"o\">-&gt;</span><span class=\"nf\">hasFile</span><span class=\"p\">(</span><span class=\"s1\">'image'</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n            <span class=\"nv\">$extension</span>  <span class=\"o\">=</span> <span class=\"nf\">request</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"nb\">file</span><span class=\"p\">(</span><span class=\"s1\">'image'</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"nf\">getClientOriginalExtension</span><span class=\"p\">();</span> <span class=\"c1\">//This is to get the extension of the image file just uploaded</span>\n            <span class=\"nv\">$image_name</span> <span class=\"o\">=</span> <span class=\"nb\">time</span><span class=\"p\">()</span> <span class=\"mf\">.</span><span class=\"s1\">'_'</span> <span class=\"mf\">.</span> <span class=\"nv\">$request</span><span class=\"o\">-&gt;</span><span class=\"n\">title</span> <span class=\"mf\">.</span> <span class=\"s1\">'.'</span> <span class=\"mf\">.</span> <span class=\"nv\">$extension</span><span class=\"p\">;</span>\n            <span class=\"nv\">$path</span> <span class=\"o\">=</span> <span class=\"nv\">$request</span><span class=\"o\">-&gt;</span><span class=\"nb\">file</span><span class=\"p\">(</span><span class=\"s1\">'image'</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"nf\">storeAs</span><span class=\"p\">(</span>\n                <span class=\"s1\">'images'</span><span class=\"p\">,</span>\n                <span class=\"nv\">$image_name</span><span class=\"p\">,</span>\n                <span class=\"s1\">'s3'</span>\n            <span class=\"p\">);</span>\n            <span class=\"nc\">Image</span><span class=\"o\">::</span><span class=\"nf\">create</span><span class=\"p\">([</span>\n                <span class=\"s1\">'title'</span><span class=\"o\">=&gt;</span><span class=\"nv\">$request</span><span class=\"o\">-&gt;</span><span class=\"n\">title</span><span class=\"p\">,</span>\n                <span class=\"s1\">'image'</span><span class=\"o\">=&gt;</span><span class=\"nv\">$path</span>\n            <span class=\"p\">]);</span>\n            <span class=\"k\">return</span> <span class=\"nf\">redirect</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"nf\">back</span><span class=\"p\">()</span><span class=\"o\">-&gt;</span><span class=\"nf\">with</span><span class=\"p\">([</span>\n                <span class=\"s1\">'message'</span><span class=\"o\">=&gt;</span> <span class=\"s2\">&quot;Image uploaded successfully&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">]);</span>\n     <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n</code></pre></div>\n<h3 id=\"set-up-routes\">Set Up Routes</h3>\n\n<p>You need one route for getting the view and another for storing the image.</p>\n\n<p>To define them, add the following code to <em>routes/web.php</em>.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"nc\">Route</span><span class=\"o\">::</span><span class=\"nf\">get</span><span class=\"p\">(</span><span class=\"s1\">'image-upload'</span><span class=\"p\">,</span> <span class=\"p\">[</span> <span class=\"nc\">ImageController</span><span class=\"o\">::</span><span class=\"n\">class</span><span class=\"p\">,</span> <span class=\"s1\">'upload'</span> <span class=\"p\">])</span><span class=\"o\">-&gt;</span><span class=\"nf\">name</span><span class=\"p\">(</span><span class=\"s1\">'image.upload'</span><span class=\"p\">);</span>\n<span class=\"nc\">Route</span><span class=\"o\">::</span><span class=\"nf\">post</span><span class=\"p\">(</span><span class=\"s1\">'image-store'</span><span class=\"p\">,</span> <span class=\"p\">[</span> <span class=\"nc\">ImageController</span><span class=\"o\">::</span><span class=\"n\">class</span><span class=\"p\">,</span> <span class=\"s1\">'store'</span> <span class=\"p\">])</span><span class=\"o\">-&gt;</span><span class=\"nf\">name</span><span class=\"p\">(</span><span class=\"s1\">'image.upload.post'</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>Then, add the <code>import</code> statement to the top of the file.</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"kn\">use</span> <span class=\"nc\">App\\Http\\Controllers\\ImageController</span><span class=\"p\">;</span>\n</code></pre></div>\n<h3 id=\"set-up-the-view\">Set Up the View</h3>\n\n<p>You will need to create a blade file <em>resources/views</em> directory called <em>upload.blade.php.</em> and update it like this:</p>\n<div class=\"highlight\"><pre class=\"highlight php\"><code><span class=\"cp\">&lt;!DOCTYPE html&gt;</span>\n<span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;</span>\n    <span class=\"nt\">&lt;title&gt;</span>Laravel File Storage with Amazon S3 <span class=\"nt\">&lt;/title&gt;</span>\n    <span class=\"nt\">&lt;link</span> <span class=\"na\">rel=</span><span class=\"s\">&quot;stylesheet&quot;</span> <span class=\"na\">href=</span><span class=\"s\">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;/head&gt;</span>\n\n<span class=\"nt\">&lt;body&gt;</span>\n<span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;container d-flex justify-content-center align-items-center&quot;</span> <span class=\"na\">style=</span><span class=\"s\">&quot;height: 100vh;&quot;</span><span class=\"nt\">&gt;</span>\n\n    <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;panel panel-primary&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;panel-heading&quot;</span><span class=\"nt\">&gt;&lt;h2&gt;</span>Laravel File Storage with Amazon S3 <span class=\"nt\">&lt;/h2&gt;&lt;/div&gt;</span>\n      <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;panel-body&quot;</span><span class=\"nt\">&gt;</span>\n\n        @if (Session::get('message'))\n        <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;alert alert-success alert-block&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;strong&gt;</span>{{Session::get('message')}}<span class=\"nt\">&lt;/strong&gt;</span>\n        <span class=\"nt\">&lt;/div&gt;</span>\n        @endif\n\n        @if (count($errors) &gt; 0)\n            <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;alert alert-danger&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;strong&gt;</span>Whoops!<span class=\"nt\">&lt;/strong&gt;</span> There were some problems with your input.\n                <span class=\"nt\">&lt;ul&gt;</span>\n                    @foreach ($errors-&gt;all() as $error)\n                        <span class=\"nt\">&lt;li&gt;</span>{{ $error }}<span class=\"nt\">&lt;/li&gt;</span>\n                    @endforeach\n                <span class=\"nt\">&lt;/ul&gt;</span>\n            <span class=\"nt\">&lt;/div&gt;</span>\n        @endif\n\n        <span class=\"nt\">&lt;form</span> <span class=\"na\">action=</span><span class=\"s\">&quot;{{ route('image.upload.post') }}&quot;</span> <span class=\"na\">method=</span><span class=\"s\">&quot;POST&quot;</span> <span class=\"na\">enctype=</span><span class=\"s\">&quot;multipart/form-data&quot;</span><span class=\"nt\">&gt;</span>\n            @csrf\n            <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;row&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;col-md-6&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;label</span> <span class=\"na\">for=</span><span class=\"s\">&quot;&quot;</span><span class=\"nt\">&gt;</span>Title<span class=\"nt\">&lt;/label&gt;</span>\n                    <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;text&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;title&quot;</span> <span class=\"na\">class=</span><span class=\"s\">&quot;form-control&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;/div&gt;</span>\n\n                <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;col-md-6&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;label</span> <span class=\"na\">for=</span><span class=\"s\">&quot;&quot;</span><span class=\"nt\">&gt;</span>Image<span class=\"nt\">&lt;/label&gt;</span>\n                    <span class=\"nt\">&lt;input</span> <span class=\"na\">type=</span><span class=\"s\">&quot;file&quot;</span> <span class=\"na\">name=</span><span class=\"s\">&quot;image&quot;</span> <span class=\"na\">class=</span><span class=\"s\">&quot;form-control&quot;</span><span class=\"nt\">&gt;</span>\n                <span class=\"nt\">&lt;/div&gt;</span>\n\n                <span class=\"nt\">&lt;div</span> <span class=\"na\">class=</span><span class=\"s\">&quot;col-md-6&quot;</span><span class=\"nt\">&gt;</span>\n                    <span class=\"nt\">&lt;button</span> <span class=\"na\">type=</span><span class=\"s\">&quot;submit&quot;</span> <span class=\"na\">class=</span><span class=\"s\">&quot;btn btn-success&quot;</span><span class=\"nt\">&gt;</span>Upload<span class=\"nt\">&lt;/button&gt;</span>\n                <span class=\"nt\">&lt;/div&gt;</span>\n\n            <span class=\"nt\">&lt;/div&gt;</span>\n        <span class=\"nt\">&lt;/form&gt;</span>\n\n      <span class=\"nt\">&lt;/div&gt;</span>\n    <span class=\"nt\">&lt;/div&gt;</span>\n<span class=\"nt\">&lt;/div&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n\n<span class=\"nt\">&lt;/html&gt;</span>\n</code></pre></div>\n<h3 id=\"testing\">Testing</h3>\n\n<p>You can now test to see if the image uploads correctly. Visit the form at <code>http://127.0.0.1:8000/image-upload</code>. It should look like this:</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/upload.png\" alt=\"Upload\"></p>\n\n<p>After uploading the image, it gives a successful alert. You can also check the bucket to see if the image uploaded successfully.</p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/upload_success.png\" alt=\"Success\"></p>\n\n<p><img src=\"/images/blog/posts/laravel-s3/image_uploaded.png\" alt=\"Image\"></p>\n\n<h2 id=\"conclusion\">Conclusion</h2>\n\n<p>In this tutorial, you’ve learned how to handle file storage with S3 in Laravel. File storage in Laravel is a broad concept on its own, but this tutorial can serve as a great starter guide. More information can be found in the <a href=\"https://laravel.com/docs/8.x/filesystem\">official Laravel documentation</a>. The code for this project is open-source and available <a href=\"https://github.com/Roxie-32/amazon_s3\">on GitHub</a>.</p>\n\n<p>I am open to questions, contributions, and conversations on better ways to implement APIs, so please comment on the repository or DM me <a href=\"https://twitter.com/OlasupoFunke\">@twitter</a>.</p>\n\n<p><strong>Happy coding!</strong></p>\n"
}