{
  "title":"FindIt: Generalized Object Localization with Natural Language Queries",
  "date":"2022-10-31T21:01:27.282000Z",
  "author":"Google AI",
  "id":"tag:blogger.com,1999:blog-8474926331452026626.post-6639900871004963241",
  "link":"http://ai.googleblog.com/2022/09/findit-generalized-object-localization.html",
  "content":"<span class=\"byline-author\">Posted by Weicheng Kuo and Anelia Angelova, Research Scientists, Google Research, Brain Team</span> <img src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRaPsdl4AdqQprPVoN9xRVQpw4oyc4e9wXl3QDbM6hu9u3K1o1A0nwVNxA-JnCIg2YyMc1NVYPLCkjqRQUHInynLpgdo5E13kdffkV9XyatQpnZl7xR_5CXSW-uSX7r4H934VAgGHpuAFDOmQf-rcUdnDVMquinbeP6emaXqg7cu9aiGHbXLXQ5wLOoA/s1600/image4.gif\"> <p>Natural language enables flexible descriptive queries about images. The interaction between text queries and images grounds linguistic meaning in the visual world, facilitating a better understanding of object relationships, human intentions towards objects, and interactions with the environment. The research community has studied object-level visual grounding through a range of tasks, including <a href=\"https://paperswithcode.com/task/referring-expression-comprehension\">referring expression comprehension</a>, <a href=\"https://openaccess.thecvf.com/content/CVPR2022/papers/Gupta_Towards_General_Purpose_Vision_Systems_An_End-to-End_Task-Agnostic_Vision-Language_Architecture_CVPR_2022_paper.pdf\">text-based localization</a>, and more broadly <a href=\"https://paperswithcode.com/task/object-detection\">object detection</a>, each of which require different skills in a model. For example, object detection seeks to find all objects from a predefined set of classes, which requires accurate localization and classification, while referring expression comprehension localizes an object from a referring text and often requires complex reasoning on prominent objects. At the intersection of the two is text-based localization, in which a simple category-based text query prompts the model to detect the objects of interest. </p><a name=\"more\"></a><p>Due to their dissimilar task properties, referring expression comprehension, detection, and text-based localization are mostly studied through separate benchmarks with most models only dedicated to one task. As a result, existing models have not adequately synthesized information from the three tasks to achieve a more holistic visual and linguistic understanding. Referring expression comprehension models, for instance, are trained to predict one object per image, and often struggle to localize multiple objects, reject negative queries, or detect novel categories. In addition, detection models are unable to process text inputs, and text-based localization models often struggle to process complex queries that refer to one object instance, such as “Left half sandwich.” Lastly, none of the models can generalize sufficiently well beyond their training data and categories. </p><p>To address these limitations, we are presenting “<a href=\"https://arxiv.org/abs/2203.17273\">FindIt: Generalized Localization with Natural Language Queries</a>” at <a href=\"https://eccv2022.ecva.net/\">ECCV 2022</a>. Here we propose a unified, general-purpose and multitask visual grounding model, called FindIt, that can flexibly answer different types of grounding and detection queries. Key to this architecture is a multi-level cross-modality fusion module that can perform complex reasoning for referring expression comprehension and simultaneously recognize small and challenging objects for text-based localization and detection. In addition, we discover that a standard object detector and detection losses are sufficient and surprisingly effective for all three tasks without the need for task-specific design and losses common in existing works. FindIt is simple, efficient, and outperforms alternative state-of-the-art models on the referring expression comprehension and text-based localization benchmarks, while being competitive on the detection benchmark. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\"><tbody><tr><td><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPIIB2rIV0acedyIsoK8cqvf_ZNc6ZY55KXI_L6Cv8LuDHY3OZTJ3d4MQlMq4WCGu73Cp41NOM8J07yCMEHTrUViWdCqdntnhKw86c34datYAJZTaNrbxaof2xw5GAdWhXX2bX6xd5avmM7nH1acHnsCp8zxRJe11yzwuR5VViFiAUrmwwPqFV-W8TyQ/s1999/image5.png\"><img border=\"0\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjPIIB2rIV0acedyIsoK8cqvf_ZNc6ZY55KXI_L6Cv8LuDHY3OZTJ3d4MQlMq4WCGu73Cp41NOM8J07yCMEHTrUViWdCqdntnhKw86c34datYAJZTaNrbxaof2xw5GAdWhXX2bX6xd5avmM7nH1acHnsCp8zxRJe11yzwuR5VViFiAUrmwwPqFV-W8TyQ/s16000/image5.png\"></a></td></tr><tr><td class=\"tr-caption\">FindIt is a unified model for referring expression comprehension (col. 1), text-based localization (col. 2), and the object detection task (col. 3). FindIt can respond accurately when tested on object types/classes not known during training, e.g. “Find the desk” (col. 4). Compared to existing baselines (<a href=\"https://arxiv.org/abs/1801.08186\">MattNet</a> and <a href=\"https://openaccess.thecvf.com/content/CVPR2022/papers/Gupta_Towards_General_Purpose_Vision_Systems_An_End-to-End_Task-Agnostic_Vision-Language_Architecture_CVPR_2022_paper.pdf\">GPV</a>), FindIt can perform these tasks well and in a single model.</td></tr></tbody></table><div>    <br></div><h2>Multi-level Image-Text Fusion</h2><p>Different localization tasks are created with different semantic understanding objectives. For example, because the referring expression task primarily references prominent objects in the image rather than small, occluded or faraway objects, low resolution images generally suffice. In contrast, the detection task aims to detect objects with various sizes and occlusion levels in higher resolution images. Apart from these benchmarks, the general visual grounding problem is inherently multiscale, as natural queries can refer to objects of any size. This motivates the need for a multi-level image-text fusion model for efficient processing of higher resolution images over different localization tasks.  </p><p>The premise of FindIt is to fuse the higher level semantic features using more expressive <a href=\"https://arxiv.org/abs/1706.03762v5\">transformer</a> layers, which can capture all-pair interactions between image and text. For the lower-level and higher-resolution features, we use a cheaper <a href=\"https://en.wikipedia.org/wiki/Dot_product\">dot-product</a> fusion to save computation and memory cost. We attach a detector head (e.g., <a href=\"https://arxiv.org/abs/1506.01497\">Faster R-CNN</a>) on top of the fused feature maps to predict the boxes and their classes. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\"><tbody><tr><td><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRaPsdl4AdqQprPVoN9xRVQpw4oyc4e9wXl3QDbM6hu9u3K1o1A0nwVNxA-JnCIg2YyMc1NVYPLCkjqRQUHInynLpgdo5E13kdffkV9XyatQpnZl7xR_5CXSW-uSX7r4H934VAgGHpuAFDOmQf-rcUdnDVMquinbeP6emaXqg7cu9aiGHbXLXQ5wLOoA/s1600/image4.gif\"><img border=\"0\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRaPsdl4AdqQprPVoN9xRVQpw4oyc4e9wXl3QDbM6hu9u3K1o1A0nwVNxA-JnCIg2YyMc1NVYPLCkjqRQUHInynLpgdo5E13kdffkV9XyatQpnZl7xR_5CXSW-uSX7r4H934VAgGHpuAFDOmQf-rcUdnDVMquinbeP6emaXqg7cu9aiGHbXLXQ5wLOoA/s16000/image4.gif\"></a></td></tr><tr><td class=\"tr-caption\">FindIt accepts an image and a query text as inputs, and processes them separately in image/text backbones before applying the multi-level fusion. We feed the fused features to Faster R-CNN to predict the boxes referred to by the text. The feature fusion uses more expressive <a href=\"https://arxiv.org/abs/1706.03762v5\">transformers</a> at higher levels and cheaper dot-product at the lower levels.</td></tr></tbody></table><div>    <br></div>   <h2>Multitask Learning</h2><p>Apart from the multi-level fusion described above, we adapt the text-based localization and detection tasks to take the same inputs as the referring expression comprehension task. For the text-based localization task, we generate a set of queries over the categories present in the image. For any present category, the text query takes the form “Find the [<code>object</code>],” where [<code>object</code>] is the category name. The objects corresponding to that category are labeled as foreground and the other objects as background. Instead of using the aforementioned prompt, we use a static prompt for the detection task, such as “Find all the objects.”. We found that the specific choice of prompts is not important for text-based localization and detection tasks.  </p><p>After adaptation, all tasks in consideration share the same inputs and outputs — an image input, a text query, and a set of output bounding boxes and classes. We then combine the datasets and train on the mixture. Finally, we use the standard object detection losses for all tasks, which we found to be surprisingly simple and effective. </p><div>    <br></div><h2>Evaluation</h2><p>We apply FindIt to the popular <a href=\"https://paperswithcode.com/dataset/refcoco\">RefCOCO</a> benchmark for referring expression comprehension tasks. When only the <a href=\"https://cocodataset.org/#home\">COCO</a> and RefCOCO dataset is available, FindIt outperforms the state-of-the-art-model on all tasks. In the settings where external datasets are allowed, FindIt sets a new state of the art by using COCO and all RefCOCO splits together (no other datasets). On the challenging <a href=\"https://github.com/lichengunc/refer\">Google and UMD splits</a>, FindIt outperforms the state of the art by a 10% margin, which, taken together, demonstrate the benefits of multitask learning. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\"><tbody><tr><td><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiUY4nOj2imEyW4rV-mBEfdA4v5W_MIJ_fDr9pxjXaOolm_YcYqsoqKj9GsHepuXyZxfuxNQk6re_SCfX6qmVg4RvNUsxsb3cRvFaJWLWttP06RYfifP_-wPV20_Y2GiNAsKW4jeGX6VGQWTkK_t6d-zhFoHsJ6h6GxGkXU6IakldIAtD6Wu1UNG29kdg/s1324/image3.png\"><img border=\"0\" height=\"428\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiUY4nOj2imEyW4rV-mBEfdA4v5W_MIJ_fDr9pxjXaOolm_YcYqsoqKj9GsHepuXyZxfuxNQk6re_SCfX6qmVg4RvNUsxsb3cRvFaJWLWttP06RYfifP_-wPV20_Y2GiNAsKW4jeGX6VGQWTkK_t6d-zhFoHsJ6h6GxGkXU6IakldIAtD6Wu1UNG29kdg/w640-h428/image3.png\" width=\"640\"></a></td></tr><tr><td class=\"tr-caption\">Comparison with the state of the art on the popular referring expression benchmark. FindIt is superior on both the <a href=\"https://cocodataset.org/#home\">COCO</a> and unconstrained settings (additional training data allowed).</td></tr></tbody></table><p>On the text-based localization benchmark, FindIt achieves 79.7%, higher than the <a href=\"https://openaccess.thecvf.com/content/CVPR2022/papers/Gupta_Towards_General_Purpose_Vision_Systems_An_End-to-End_Task-Agnostic_Vision-Language_Architecture_CVPR_2022_paper.pdf\">GPV</a> (73.0%), and <a href=\"https://arxiv.org/abs/1506.01497\">Faster R-CNN</a> baselines (75.2%). Please refer to the <a href=\"https://arxiv.org/abs/2203.17273\">paper</a> for more quantitative evaluation. </p><p>We further observe that FindIt generalizes better to novel categories and super-categories in the text-based localization task compared to competitive single-task baselines on the popular <a href=\"https://cocodataset.org/#home\">COCO</a> and <a href=\"https://www.objects365.org/overview.html\">Objects365</a> datasets, shown in the figure below. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\"><tbody><tr><td><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgr1Z0xl-mLE30eKpa69jWj6_BYASXXd6O0p_kpfwDhTAndm4mnER3QS37UkWG1mQTdyfo215knHHLVtw89EKrPYBVPNCVVhruF-n7MSNHvLPJv4y_GDnxz0XTnLJdGjIiSh0ymMcogMRpx1M0Nj4jBCRpYmPgej2USGOfGjB6dcqY6LQYTRFFw3TByTA/s1375/Screenshot%202022-09-20%209.40.47%20AM.png\"><img border=\"0\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgr1Z0xl-mLE30eKpa69jWj6_BYASXXd6O0p_kpfwDhTAndm4mnER3QS37UkWG1mQTdyfo215knHHLVtw89EKrPYBVPNCVVhruF-n7MSNHvLPJv4y_GDnxz0XTnLJdGjIiSh0ymMcogMRpx1M0Nj4jBCRpYmPgej2USGOfGjB6dcqY6LQYTRFFw3TByTA/s16000/Screenshot%202022-09-20%209.40.47%20AM.png\"></a></td></tr><tr><td class=\"tr-caption\">FindIt on novel and super categories. <b>Left:</b> FindIt outperforms the single-task baselines especially on the novel categories. <b>Right:</b> FindIt outperforms the single-task baselines on the unseen super categories. “Rec-Single” is the Referring expression comprehension single task model and “Loc-Single” is the text-based localization single task model.</td></tr></tbody></table><div>    <br></div><h2>Efficiency</h2><p>We also benchmark the inference times on the referring expression comprehension task (see Table below). FindIt is efficient and comparable with existing one-stage approaches while achieving higher accuracy. For fair comparison, all running times are measured on one <a href=\"https://www.nvidia.com/en-us/geforce/10-series/\">GTX 1080Ti</a> GPU. </p> <table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\"><tbody><tr>  <td><b>Model</b></td><td>   </td>   <td><b>Image Size</b></td><td>   </td>   <td><b>Backbone</b></td><td>   </td>   <td><b>Runtime (ms)</b></td>  </tr>  <tr>   <td><a href=\"https://arxiv.org/abs/1801.08186\">MattNet</a></td><td>   </td>   <td>1000</td><td>   </td>   <td><a href=\"https://arxiv.org/abs/1512.03385\">R101</a></td><td>   </td>   <td>378</td>  </tr>  <tr>   <td><a href=\"https://openaccess.thecvf.com/content_ICCV_2019/papers/Yang_A_Fast_and_Accurate_One-Stage_Approach_to_Visual_Grounding_ICCV_2019_paper.pdf\">FAOA</a></td><td>   </td>   <td>256</td><td>   </td>   <td><a href=\"https://arxiv.org/abs/1804.02767\">DarkNet53</a></td><td>   </td>   <td>39</td>  </tr>  <tr>   <td><a href=\"https://arxiv.org/abs/2003.08813\">MCN</a></td><td>   </td>   <td>416</td><td>   </td>   <td><a href=\"https://arxiv.org/abs/1804.02767\">DarkNet53</a></td><td>   </td>   <td>56</td>  </tr>  <tr>   <td><a href=\"https://arxiv.org/abs/2104.08541\">TransVG</a></td><td>   </td>   <td>640</td><td>   </td>   <td><a href=\"https://arxiv.org/abs/1512.03385\">R50</a></td><td>   </td>   <td>62</td>  </tr>  <tr>   <td><em>FindIt (Ours)</em></td><td>   </td>   <td>640</td><td>   </td>   <td>R50</td><td>   </td>   <td>107</td>  </tr>  <tr>   <td><em>FindIt (Ours)</em></td><td>   </td>   <td>384</td><td>   </td>   <td>R50</td><td>   </td>   <td>57</td>  </tr></tbody></table><div>    <br>    <br></div><h2>Conclusion</h2><p>We present Findit, which unifies referring expression comprehension, text-based localization, and object detection tasks. We propose multi-scale cross-attention to unify the diverse localization requirements of these tasks. Without any task-specific design, FindIt surpasses the state of the art on referring expression and text-based localization, shows competitive performance on detection, and generalizes better to out-of-distribution data and novel classes. All of these are accomplished in a single, unified, and efficient model. </p><div>    <br></div><h2>Acknowledgements</h2><p><em>This work is conducted by Weicheng Kuo, Fred Bertsch, Wei Li, AJ Piergiovanni, Mohammad Saffar, and Anelia Angelova. We would like to thank Ashish Vaswani, Prajit Ramachandran, Niki Parmar, David Luan, Tsung-Yi Lin, and other colleagues at Google Research for their advice and helpful discussions. We would like to thank Tom Small for preparing the animation.</em></p>"
}