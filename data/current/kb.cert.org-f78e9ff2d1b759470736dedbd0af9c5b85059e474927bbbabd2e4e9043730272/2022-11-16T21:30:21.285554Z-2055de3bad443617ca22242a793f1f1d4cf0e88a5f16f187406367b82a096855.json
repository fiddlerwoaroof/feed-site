{
  "title":"VU#794340: OpenSSL 3.0.0 to 3.0.6 decodes some punycode email addresses in X.509 certificates improperly",
  "date":"2022-11-16T21:30:21.285554Z",
  "author":null,
  "id":"https://kb.cert.org/vuls/id/794340",
  "link":"https://kb.cert.org/vuls/id/794340",
  "content":"\n\n<div class=\"row\" id=\"content\">\n  <div class=\"large-9 medium-9 columns\">\n    <div class=\"blog-post\">\n      <div class=\"row\">\n        <div class=\"large-12 columns\">\n\t  \n\t  <h3 id=\"overview\">Overview</h3>\n<p>Two buffer overflow vulnerabilities were discovered in OpenSSL versions 3.0.0 through 3.0.6. These vulnerabilities were introduced in version 3.0.0 with the inclusion of support for punycode email address parsing for X.509 certificates.   OpenSSL's assessment of the severity of the vulnerabilities has <a href=\"https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/\">reduced from CRITICAL to HIGH</a>, and OpenSSL 3.0.7 addresses the issues.</p>\n<h3 id=\"description\">Description</h3>\n<p>Two buffer overflows have been reported in the OpenSSL 3.0.x branch prior to version 3.0.7 that, when exploited, may lead to denial of services or, in some cases, remote code execution in the vulnerable target environment. OpenSSL client and server implementations that use the vulnerable libraries are affected.  The server implementation also requires that <a href=\"https://www.rfc-editor.org/rfc/rfc4346#appendix-F.1.1\">TLS client authentication</a> is enabled in order to attack, and potentially exploit, a vulnerable target.   <a href=\"https://gist.github.com/FiloSottile/611fc3fa95c3aceebf2580983f76148c\">OpenSSL provides details:</a> </p>\n<pre><code>* Fixed two buffer overflows in punycode decoding functions.\n\n   A buffer overrun can be triggered in X.509 certificate verification,\n   specifically in name constraint checking. Note that this occurs after\n   certificate chain signature verification and requires either a CA to\n   have signed the malicious certificate or for the application to continue\n   certificate verification despite failure to construct a path to a trusted\n   issuer.\n\n   In a TLS client, this can be triggered by connecting to a malicious\n   server.  In a TLS server, this can be triggered if the server requests\n   client authentication and a malicious client connects.\n\n   An attacker can craft a malicious email address to overflow\n   an arbitrary number of bytes containing the `.`  character (decimal 46)\n   on the stack.  This buffer overflow could result in a crash (causing a\n   denial of service).\n   ([CVE-2022-3786])\n\n   An attacker can craft a malicious email address to overflow four\n   attacker-controlled bytes on the stack.  This buffer overflow could\n   result in a crash (causing a denial of service) or potentially remote code\n   execution depending on stack layout for any given platform/compiler.\n   ([CVE-2022-3602])\n</code></pre>\n\n<p>OpenSSL versions 1.1.1 and 1.0.2 are not affected.</p>\n<p>CERT/CC is unaware of any exploitation of this vulnerability at this time.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>Successful exploitation could lead to denial of service or remote execution of arbitrary code in the target environment.</p>\n<h3 id=\"solution\">Solution</h3>\n<p>Any services depending on versions of OpenSSL 3.0.x prior to OpenSSL 3.0.7 should be upgraded to version 3.0.7 or later.  Operators may also consider temporarily disabling TLS client authentication until applying an update.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>Thanks to OpenSSL for coordinating and remediating the vulnerability. Polar Bear is credited as having discovered CVE--2022-3602. Viktor Dukhovni is reported as the source of CVE-2022-3786.</p>\n<p>This document was written by Kevin Stephens, Eric Hatleback, Vijay Sarvepalli, and Jeffrey S. Havrilla.</p>\n\t  \n\t</div>\n      </div>\n      <div class=\"row\">\n\t<div class=\"large-12 columns\">\n\t  <h3> Vendor Information </h3>\n\t  \n\t  <div id=\"vendorinfo\">\n\t    One or more vendors are listed for this advisory. Please reference the full report for more information.\n\t  </div>\n\t  \n\t</div>\n      </div>\n      <br>\n      \n      \n      <div class=\"row\">\n\t<div class=\"large-12 columns\">\n\t  <h3> References </h3>\n\t  <ul>\n\t    \n\t    \n\t    \n            <li><a href=\"https://www.openssl.org/news/secadv/20221101.txt\" class=\"vulreflink safereflink\" rel=\"noopener\">https://www.openssl.org/news/secadv/20221101.txt</a></li>\n            \n          \n\t    \n            <li><a href=\"https://gist.github.com/FiloSottile/611fc3fa95c3aceebf2580983f76148c\" class=\"vulreflink safereflink\" rel=\"noopener\">https://gist.github.com/FiloSottile/611fc3fa95c3aceebf2580983f76148c</a></li>\n            \n          \n\t    \n            <li><a href=\"https://github.com/NCSC-NL/OpenSSL-2022/tree/main/software\" class=\"vulreflink safereflink\" rel=\"noopener\">https://github.com/NCSC-NL/OpenSSL-2022/tree/main/software</a></li>\n            \n          \n\t    \n            <li><a href=\"https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/\" class=\"vulreflink safereflink\" rel=\"noopener\">https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/</a></li>\n            \n          \n\t  \n\t  </ul>\n\t</div>\n      </div>\n      \n      <h3>Other Information</h3>\n        <div class=\"vulcontent\">\n          <table class=\"unstriped\">\n            <tbody>\n\t      \n              <tr>\n                <td width=\"200\"><b>CVE IDs:</b></td>\n\t\t<td>\n\t\t\n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-3602\">CVE-2022-3602  </a>\n\t\t\n                \n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-3786\">CVE-2022-3786  </a>\n\t\t\n                \n\t\t</td>\n\t      </tr>\n\t      \n\t      <tr>\n\t\t<td>\n\t\t  <b>Date Public:</b>\n\t\t</td>\n                <td>2022-11-01</td>\n              </tr>\n              <tr>\n                <td><b>Date First Published:</b></td>\n                <td id=\"datefirstpublished\">2022-11-01</td>\n              </tr>\n              <tr>\n                <td><b>Date Last Updated: </b></td>\n                <td>2022-11-16 21:30 UTC</td>\n              </tr>\n              <tr>\n                <td><b>Document Revision: </b></td>\n                <td>10 </td>\n              </tr>\n            </tbody>\n          </table>\n\t</div>\n    </div>\n  </div>\n  <div class=\"large-3 medium-3 columns\">\n  <div class=\"sticky\">\n    <div class=\"sidebar-links\">\n      <ul class=\"menu vertical\">\n\t<li><a href=\"https://vuls.cert.org/confluence/display/VIN/Vulnerability+Note+Help\" rel=\"noopener\">About vulnerability notes</a></li>\n\t<li><a href=\"mailto:cert@cert.org?Subject=VU%23794340 Feedback\">Contact us about this vulnerability</a></li>\n\t<li><a href=\"https://vuls.cert.org/confluence/display/VIN/Case+Handling#CaseHandling-Givingavendorstatusandstatement\">Provide a vendor statement</a></li>\n      </ul>\n    </div>\n  </div>\n</div>\n\n</div>\n\n\n\n"
}