{
  "title":"VU#709991: Netatalk contains multiple error and memory management vulnerabilities",
  "date":"2022-11-16T13:57:16.209234Z",
  "author":null,
  "id":"https://kb.cert.org/vuls/id/709991",
  "link":"https://kb.cert.org/vuls/id/709991",
  "content":"\n\n<div class=\"row\" id=\"content\">\n  <div class=\"large-9 medium-9 columns\">\n    <div class=\"blog-post\">\n      <div class=\"row\">\n        <div class=\"large-12 columns\">\n\t  \n\t  <h3 id=\"overview\">Overview</h3>\n<p>There are six new vulnerabilities in the latest release of Netatalk (3.1.12) that could allow for Remote Code Execution as well as Out-of-bounds Read.</p>\n<h3 id=\"description\">Description</h3>\n<p>Below are the new CVEs. Per ZDI: </p>\n<p><strong>CVE-2022-0194</strong>\nThis vulnerability allows remote attackers to execute arbitrary code on affected installations of Netatalk. Authentication is not required to exploit this vulnerability.</p>\n<p>The specific flaw exists within the ad_addcomment function. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to execute code in the context of root.</p>\n<p><strong>CVE-2022-23121</strong>\nThis vulnerability allows remote attackers to execute arbitrary code on affected installations of Netatalk. Authentication is not required to exploit this vulnerability.</p>\n<p>The specific flaw exists within the parse_entries function. The issue results from the lack of proper error handling when parsing AppleDouble entries. An attacker can leverage this vulnerability to execute code in the context of root.</p>\n<p><strong>CVE-2022-23122</strong>\nThis vulnerability allows remote attackers to execute arbitrary code on affected installations of Netatalk. Authentication is not required to exploit this vulnerability.</p>\n<p>The specific flaw exists within the setfilparams function. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to execute code in the context of root.</p>\n<p><strong>CVE-2022-23124</strong>\nThis vulnerability allows remote attackers to disclose sensitive information on affected installations of Netatalk. Authentication is not required to exploit this vulnerability.</p>\n<p>The specific flaw exists within the get_finderinfo method. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root.</p>\n<p><strong>CVE-2022-23125</strong>\nThis vulnerability allows remote attackers to execute arbitrary code on affected installations of Netatalk. Authentication is not required to exploit this vulnerability.</p>\n<p>The specific flaw exists within the copyapplfile function. When parsing the len element, the process does not properly validate the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to execute code in the context of root.</p>\n<p><strong>CVE-2022-23123</strong>\nThis vulnerability allows remote attackers to disclose sensitive information on affected installations of Netatalk. Authentication is not required to exploit this vulnerability.</p>\n<p>The specific flaw exists within the getdirparams method. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of root.</p>\n<p>For more detailed information, please review the Netatalk announcement. Also available for reference are releases detailing the information from ZDI &amp; Western Digital. </p>\n<p>Netatalk does not regularly receive security updates, is receiving security research attention, and is difficlut to get right because reverse engineering a proprietary protocol. WD has removed Netatalk code from NAS firmware. We suggest Samba+vfs_fruit for longer term use (more likely to get security updates in a timely way).\n(see samba vfs_fruit vuls).</p>\n<h3 id=\"impact\">Impact</h3>\n<p>An unauthenticated, remote attacker can execute arbitrary code on affected installations of Netatalk.</p>\n<h3 id=\"solution\">Solution</h3>\n<p>Netatalk has released version <a href=\"https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html\">3.1.13</a>. </p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>Thanks to ZDI, Western Digital, and Netatalk for researching and coordinating these vulnerabilities. </p>\n<p>This document was written by James Stanley and Art Manion.</p>\n\t  \n\t</div>\n      </div>\n      <div class=\"row\">\n\t<div class=\"large-12 columns\">\n\t  <h3> Vendor Information </h3>\n\t  \n\t  <div id=\"vendorinfo\">\n\t    One or more vendors are listed for this advisory. Please reference the full report for more information.\n\t  </div>\n\t  \n\t</div>\n      </div>\n      <br>\n      \n      \n      <div class=\"row\">\n\t<div class=\"large-12 columns\">\n\t  <h3> References </h3>\n\t  <ul>\n\t    \n\t    \n\t    \n            <li><a href=\"https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html\" class=\"vulreflink safereflink\" rel=\"noopener\">https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html</a></li>\n            \n          \n\t    \n            <li><a href=\"https://www.westerndigital.com/support/product-security/wdc-22005-netatalk-security-vulnerabilities\" class=\"vulreflink safereflink\" rel=\"noopener\">https://www.westerndigital.com/support/product-security/wdc-22005-netatalk-security-vulnerabilities</a></li>\n            \n          \n\t  \n\t  </ul>\n\t</div>\n      </div>\n      \n      <h3>Other Information</h3>\n        <div class=\"vulcontent\">\n          <table class=\"unstriped\">\n            <tbody>\n\t      \n              <tr>\n                <td width=\"200\"><b>CVE IDs:</b></td>\n\t\t<td>\n\t\t\n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-0194\">CVE-2022-0194  </a>\n\t\t\n                \n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-23121\">CVE-2022-23121  </a>\n\t\t\n                \n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-23122\">CVE-2022-23122  </a>\n\t\t\n                \n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-23124\">CVE-2022-23124  </a>\n\t\t\n                \n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-23123\">CVE-2022-23123  </a>\n\t\t\n                \n\t\t\n                <a href=\"http://web.nvd.nist.gov/view/vuln/detail?vulnId=2022-23125\">CVE-2022-23125  </a>\n\t\t\n                \n\t\t</td>\n\t      </tr>\n\t      \n\t      <tr>\n\t\t<td>\n\t\t  <b>Date Public:</b>\n\t\t</td>\n                <td>2022-01-10</td>\n              </tr>\n              <tr>\n                <td><b>Date First Published:</b></td>\n                <td id=\"datefirstpublished\">2022-11-16</td>\n              </tr>\n              <tr>\n                <td><b>Date Last Updated: </b></td>\n                <td>2022-11-16 13:57 UTC</td>\n              </tr>\n              <tr>\n                <td><b>Document Revision: </b></td>\n                <td>2 </td>\n              </tr>\n            </tbody>\n          </table>\n\t</div>\n    </div>\n  </div>\n  <div class=\"large-3 medium-3 columns\">\n  <div class=\"sticky\">\n    <div class=\"sidebar-links\">\n      <ul class=\"menu vertical\">\n\t<li><a href=\"https://vuls.cert.org/confluence/display/VIN/Vulnerability+Note+Help\" rel=\"noopener\">About vulnerability notes</a></li>\n\t<li><a href=\"mailto:cert@cert.org?Subject=VU%23709991 Feedback\">Contact us about this vulnerability</a></li>\n\t<li><a href=\"https://vuls.cert.org/confluence/display/VIN/Case+Handling#CaseHandling-Givingavendorstatusandstatement\">Provide a vendor statement</a></li>\n      </ul>\n    </div>\n  </div>\n</div>\n\n</div>\n\n\n\n"
}