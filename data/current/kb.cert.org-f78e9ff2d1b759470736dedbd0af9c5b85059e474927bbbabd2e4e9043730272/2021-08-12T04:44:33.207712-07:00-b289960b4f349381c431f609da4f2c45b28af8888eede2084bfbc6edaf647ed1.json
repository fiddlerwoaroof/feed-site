{
  "title":"VU#357312: HTTP Request Smuggling in Web Proxies",
  "date":"2021-08-12T04:44:33.207712-07:00",
  "author":null,
  "id":"https://kb.cert.org/vuls/id/357312",
  "link":"https://kb.cert.org/vuls/id/357312",
  "content":"\n\n<div class=\"row\" id=\"content\">\n  <div class=\"large-9 medium-9 columns\">\n    <div class=\"blog-post\">\n      <div class=\"row\">\n        <div class=\"large-12 columns\">\n\t  \n\t  <h3>Overview</h3>\n<p>HTTP web proxies and web accelerators  that support HTTP/2 for an HTTP/1.1 backend webserver are vulnerable to HTTP Request Smuggling. </p>\n<h3>Description</h3>\n<p>The affected systems allow invalid characters such as carriage return and newline characters in HTTP/2 headers. When an attacker passes these invalid contents to a vulnerable system,  the forwarded HTTP/1 request includes the unintended malicious data. This is commonly known as HTTP Request Splitting. In the case of HTTP web proxies, this vulnerability can lead to HTTP Request smuggling, which enables an attacker to access protected internal sites.  </p>\n<h3>Impact</h3>\n<p>An attacker can send a crafted HTTP/2 request with malicious content to bypass network security measures, thereby reaching internal protected servers and accessing sensitive data. </p>\n<h3>Solution</h3>\n<h4>Apply updates</h4>\n<p>Install vendor-provided patches and updates to ensure malicious HTTP/2 content is blocked or rejected as described in <a href=\"https://datatracker.ietf.org/doc/html/rfc7540#section-8.1.2.6\">RFC 7540 (Section 8.1.2.6)</a> and <a href=\"https://datatracker.ietf.org/doc/html/rfc7540#section-10.3\">RFC 7540 (Section 10.3)</a>.  Both &quot;request&quot; and &quot;response&quot; should be  inspected by the web proxy and rejected in accordance with Stream Error Handling as described in  <a href=\"https://datatracker.ietf.org/doc/html/rfc7540#section-5.4.2\">RFC 7450 (Section 5.4.2)</a>. </p>\n<h4>Inspect and block anomalous HTTP/2 traffic</h4>\n<p>If HTTP/2 is not supported, block the protocol on the web proxies to avoid abuse of HTTP/2 protocol.  Where HTTP/2 is supported, enforce strict rules for HTTP header checks to ensure malicious headers are normalized or rejected.<br>\nChecks of this type include:\n* HTTP Headers with invalid Header name or value\n* HTTP Headers with invalid or no content-length\n* Unsupported or invalid HTTP methods</p>\n<h4>Test and verify your web proxy</h4>\n<p>Scan your public web server proxy with OWASP recommended <a href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/15-Testing_for_HTTP_Splitting_Smuggling\">tests</a> to ensure your web servers are not vulnerable to abuse via HTTP response splitting.</p>\n<h3>Acknowledgements</h3>\n<p>Thanks to the reporter James Kettle of <a href=\"https://portswigger.net/research/http2\">PortSwigger</a> for the information about this vulnerability.</p>\n<p>This document was written by Timur Snoke.</p>\n\t  \n\t</div>\n      </div>\n      <div class=\"row\">\n\t<div class=\"large-12 columns\">\n\t  <h3> Vendor Information </h3>\n\t  \n\t  <div id=\"vendorinfo\">\n\t    One or more vendors are listed for this advisory. Please reference the full report for more information.\n\t  </div>\n\t  \n\t</div>\n      </div>\n      <br>\n      \n      \n      <div class=\"row\">\n\t<div class=\"large-12 columns\">\n\t  <h3> References </h3>\n\t  <ul>\n\t    \n\t  \n\t  <li><a href=\"https://portswigger.net/research/request-smuggling\" class=\"vulreflink\" rel=\"noopener\">https://portswigger.net/research/request-smuggling</a></li>\n          \n\t  <li><a href=\"https://datatracker.ietf.org/doc/html/rfc7540\" class=\"vulreflink\" rel=\"noopener\">https://datatracker.ietf.org/doc/html/rfc7540</a></li>\n          \n\t  <li><a href=\"https://portswigger.net/research/http2\" class=\"vulreflink\" rel=\"noopener\">https://portswigger.net/research/http2</a></li>\n          \n\t  <li><a href=\"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/15-Testing_for_HTTP_Splitting_Smuggling\" class=\"vulreflink\" rel=\"noopener\">https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/15-Testing_for_HTTP_Splitting_Smuggling</a></li>\n          \n\t  \n\t  </ul>\n\t</div>\n      </div>\n      \n      <h3>Other Information</h3>\n        <div class=\"vulcontent\">\n          <table class=\"unstriped\">\n            <tbody>\n\t      \n              <tr>\n                <td width=\"200\"><b>CVE IDs:</b></td>\n\t\t<td>\n\t\t\n\t\t\n                \n\t\t</td>\n\t      </tr>\n\t      \n\t      <tr>\n\t\t<td>\n\t\t  <b>Date Public:</b>\n\t\t</td>\n                <td>2021-08-06</td>\n              </tr>\n              <tr>\n                <td><b>Date First Published:</b></td>\n                <td id=\"datefirstpublished\">2021-08-06</td>\n              </tr>\n              <tr>\n                <td><b>Date Last Updated: </b></td>\n                <td>2021-08-12 11:44 UTC</td>\n              </tr>\n              <tr>\n                <td><b>Document Revision: </b></td>\n                <td>3 </td>\n              </tr>\n            </tbody>\n          </table>\n\t</div>\n    </div>\n  </div>\n  <div class=\"large-3 medium-3 columns\">\n  <div class=\"sticky\">\n    <div class=\"sidebar-links\">\n      <ul class=\"menu vertical\">\n\t<li><a href=\"https://vuls.cert.org/confluence/display/VIN/Vulnerability+Note+Help\" rel=\"noopener\">About vulnerability notes</a></li>\n\t<li><a href=\"mailto:cert@cert.org?Subject=VU%23357312 Feedback\">Contact us about this vulnerability</a></li>\n\t<li><a href=\"https://vuls.cert.org/confluence/display/VIN/Case+Handling#CaseHandling-Givingavendorstatusandstatement\">Provide a vendor statement</a></li>\n      </ul>\n    </div>\n  </div>\n</div>\n\n</div>\n\n\n\n"
}